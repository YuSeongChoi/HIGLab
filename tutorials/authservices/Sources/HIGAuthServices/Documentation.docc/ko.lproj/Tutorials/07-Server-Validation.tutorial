@Tutorial(time: 20) {
    @Intro(title: "μ„λ²„ κ²€μ¦") {
        Identity Tokenμ„ μ„λ²„μ—μ„ κ²€μ¦ν•κ³ 
        μ•μ „ν• μ„Έμ…μ„ μƒμ„±ν•λ” λ°©λ²•μ„ κµ¬ν„ν•©λ‹λ‹¤.
        
        @Image(source: "server-validation.png", alt: "μ„λ²„ κ²€μ¦ νλ¦„")
    }
    
    @Section(title: "Identity Token μ΄ν•΄") {
        @ContentAndMedia {
            Identity Tokenμ€ JWT(JSON Web Token) ν•μ‹μ…λ‹λ‹¤.
            
            JWT κµ¬μ΅°:
            - **Header**: μ•κ³ λ¦¬μ¦ μ •λ³΄ (RS256)
            - **Payload**: μ‚¬μ©μ μ •λ³΄, μ•± μ •λ³΄, λ§λ£ μ‹κ°„
            - **Signature**: Apple κ°μΈν‚¤λ΅ μ„λ…λ¨
            
            μ„λ²„μ—μ„ Appleμ κ³µκ°ν‚¤λ΅ μ„λ…μ„ κ²€μ¦ν•©λ‹λ‹¤.
        }
        
        @Steps {
            @Step {
                ν΄λΌμ΄μ–ΈνΈμ—μ„ Identity Tokenμ„ 
                Base64 λ¬Έμμ—΄λ΅ λ³€ν™ν•©λ‹λ‹¤.
                
                @Code(name: "EncodeToken.swift", file: "07-01-encode-token.swift")
            }
            
            @Step {
                μ„λ²„λ΅ ν† ν°μ„ μ „μ†΅ν•©λ‹λ‹¤.
                HTTPSλ¥Ό λ°λ“μ‹ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
                
                @Code(name: "SendToken.swift", file: "07-02-send-token.swift")
            }
        }
    }
    
    @Section(title: "Apple κ³µκ°ν‚¤ κ°€μ Έμ¤κΈ°") {
        @ContentAndMedia {
            Appleμ JWT κ²€μ¦μ© κ³µκ°ν‚¤λ” 
            JWKS(JSON Web Key Set) μ—”λ“ν¬μΈνΈμ—μ„ μ κ³µλ©λ‹λ‹¤.
            
            URL: `https://appleid.apple.com/auth/keys`
            
            ν‚¤λ” μ£ΌκΈ°μ μΌλ΅ λ΅ν…μ΄μ…λλ―€λ΅ 
            μΊμ‹± μ‹ TTLμ„ μ„¤μ •ν•΄μ•Ό ν•©λ‹λ‹¤.
        }
        
        @Steps {
            @Step {
                Apple JWKS μ—”λ“ν¬μΈνΈμ—μ„ κ³µκ°ν‚¤λ¥Ό κ°€μ Έμµλ‹λ‹¤.
                Node.js/Python μ„λ²„ μμ‹μ…λ‹λ‹¤.
                
                @Code(name: "FetchJWKS.swift", file: "07-03-fetch-jwks.swift")
            }
            
            @Step {
                ν† ν° ν—¤λ”μ kid(Key ID)μ™€ μΌμΉν•λ” 
                κ³µκ°ν‚¤λ¥Ό μ„ νƒν•©λ‹λ‹¤.
                
                @Code(name: "SelectKey.swift", file: "07-04-select-key.swift")
            }
        }
    }
    
    @Section(title: "ν† ν° κ²€μ¦ λ‹¨κ³„") {
        @ContentAndMedia {
            Identity Token κ²€μ¦ μ‹ ν™•μΈν•΄μ•Ό ν•  μ‚¬ν•­:
            
            1. **μ„λ… κ²€μ¦**: Apple κ³µκ°ν‚¤λ΅ μ„λ… ν™•μΈ
            2. **iss ν™•μΈ**: "https://appleid.apple.com" μΈμ§€
            3. **aud ν™•μΈ**: μ•±μ Bundle IDμ™€ μΌμΉν•λ”μ§€
            4. **exp ν™•μΈ**: ν† ν°μ΄ λ§λ£λμ§€ μ•μ•λ”μ§€
            5. **nonce ν™•μΈ**: μ”μ²­ μ‹ λ³΄λ‚Έ nonceμ™€ μΌμΉν•λ”μ§€
        }
        
        @Steps {
            @Step {
                JWT λΌμ΄λΈλ¬λ¦¬λ΅ ν† ν°μ„ λ””μ½”λ”©ν•κ³  
                μ„λ…μ„ κ²€μ¦ν•©λ‹λ‹¤.
                
                @Code(name: "VerifySignature.swift", file: "07-05-verify-signature.swift")
            }
            
            @Step {
                issuer(iss) ν΄λ μ„μ„ ν™•μΈν•©λ‹λ‹¤.
                λ°λ“μ‹ Apple λ„λ©”μΈμ΄μ–΄μ•Ό ν•©λ‹λ‹¤.
                
                @Code(name: "VerifyIssuer.swift", file: "07-06-verify-issuer.swift")
            }
            
            @Step {
                audience(aud) ν΄λ μ„μ΄ 
                μ•±μ Bundle IDμ™€ μΌμΉν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
                
                @Code(name: "VerifyAudience.swift", file: "07-07-verify-audience.swift")
            }
            
            @Step {
                nonce ν΄λ μ„μ΄ μ”μ²­ μ‹ μ„¤μ •ν• κ°’κ³Ό 
                μΌμΉν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
                
                @Code(name: "VerifyNonce.swift", file: "07-08-verify-nonce.swift")
            }
        }
    }
    
    @Section(title: "Authorization Codeλ΅ ν† ν° κµν™") {
        @ContentAndMedia {
            Authorization Codeλ¥Ό Apple μ„λ²„μ™€ κµν™ν•μ—¬
            Refresh Tokenκ³Ό Access Tokenμ„ λ°›μ„ μ μμµλ‹λ‹¤.
            
            Token Endpoint: `https://appleid.apple.com/auth/token`
            
            Refresh TokenμΌλ΅ μ„Έμ…μ„ κ°±μ‹ ν•  μ μμµλ‹λ‹¤.
        }
        
        @Steps {
            @Step {
                Client Secret JWTλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
                Apple Developer ν¬ν„Έμ ν‚¤λ΅ μ„λ…ν•©λ‹λ‹¤.
                
                @Code(name: "ClientSecret.swift", file: "07-09-client-secret.swift")
            }
            
            @Step {
                Token μ—”λ“ν¬μΈνΈλ΅ μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
                Authorization Codeμ™€ Client Secretμ„ ν¬ν•¨ν•©λ‹λ‹¤.
                
                @Code(name: "TokenExchange.swift", file: "07-10-token-exchange.swift")
            }
            
            @Step {
                μ‘λ‹µμ—μ„ Refresh Tokenμ„ μ•μ „ν•κ² μ €μ¥ν•©λ‹λ‹¤.
                μ„Έμ… κ°±μ‹ μ— μ‚¬μ©λ©λ‹λ‹¤.
                
                @Code(name: "StoreRefreshToken.swift", file: "07-11-store-refresh.swift")
            }
        }
    }
    
    @Assessments {
        @MultipleChoice {
            Identity Token κ²€μ¦ μ‹ λ°λ“μ‹ ν™•μΈν•΄μ•Ό ν•λ” 
            ν΄λ μ„(claim)μ€?
            
            @Choice(isCorrect: false) {
                nameκ³Ό emailλ§ ν™•μΈν•λ©΄ λλ‹¤.
                
                @Justification(reaction: "λ³΄μ•μ— μ·¨μ•½ν•©λ‹λ‹¤.") {
                    iss, aud, exp, nonce λ“± 
                    λ³΄μ• κ΄€λ ¨ ν΄λ μ„λ„ κ²€μ¦ν•΄μ•Ό ν•©λ‹λ‹¤.
                }
            }
            
            @Choice(isCorrect: true) {
                iss, aud, exp, nonceλ¥Ό λ¨λ‘ κ²€μ¦ν•΄μ•Ό ν•λ‹¤.
                
                @Justification(reaction: "μ •ν™•ν•©λ‹λ‹¤! π―") {
                    λ°κΈ‰μ, λ€μƒ, λ§λ£, nonceλ¥Ό λ¨λ‘ ν™•μΈν•΄μ•Ό
                    μ„μ΅° ν† ν°μ„ λ°©μ§€ν•  μ μμµλ‹λ‹¤.
                }
            }
            
            @Choice(isCorrect: false) {
                sub(μ‚¬μ©μ ID)λ§ ν™•μΈν•λ©΄ λλ‹¤.
                
                @Justification(reaction: "λ¶μ¶©λ¶„ν•©λ‹λ‹¤.") {
                    sub ν™•μΈλ§μΌλ΅λ” ν† ν° μ„μ΅°λ¥Ό 
                    λ°©μ§€ν•  μ μ—†μµλ‹λ‹¤.
                }
            }
        }
        
        @MultipleChoice {
            Appleμ JWT κ²€μ¦μ© κ³µκ°ν‚¤λ” μ–΄λ””μ„ κ°€μ Έμ¤λ‚μ”?
            
            @Choice(isCorrect: true) {
                https://appleid.apple.com/auth/keys (JWKS μ—”λ“ν¬μΈνΈ)
                
                @Justification(reaction: "λ§μµλ‹λ‹¤! β¨") {
                    Appleμ κ³µμ‹ JWKS μ—”λ“ν¬μΈνΈμ—μ„
                    κ³µκ°ν‚¤ μ„ΈνΈλ¥Ό κ°€μ Έμµλ‹λ‹¤.
                }
            }
            
            @Choice(isCorrect: false) {
                Apple Developer ν¬ν„Έμ—μ„ λ‹¤μ΄λ΅λ“.
                
                @Justification(reaction: "ν‹€λ Έμµλ‹λ‹¤.") {
                    ν¬ν„Έμ—μ„λ” Client Secret μƒμ„±μ© ν‚¤λ¥Ό 
                    λ‹¤μ΄λ΅λ“ν•λ©°, κ²€μ¦ κ³µκ°ν‚¤λ” JWKSλ΅ μ κ³µλ©λ‹λ‹¤.
                }
            }
            
            @Choice(isCorrect: false) {
                Identity Token λ‚΄μ— ν¬ν•¨λμ–΄ μλ‹¤.
                
                @Justification(reaction: "λ³΄μ•μƒ λ¶κ°€λ¥ν•©λ‹λ‹¤.") {
                    κ³µκ°ν‚¤λ” μ™Έλ¶€μ—μ„ κ°€μ Έμ™€μ•Ό
                    ν† ν° μ„μ΅°λ¥Ό λ°©μ§€ν•  μ μμµλ‹λ‹¤.
                }
            }
        }
    }
}
