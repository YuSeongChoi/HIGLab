<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ” Local Authentication ì™„ì „ì •ë³µ â€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--surface:#fff;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--green:#34c759;--border:#d2d2d7;--code-bg:#1e1e2e;--radius:16px}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans KR',-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.88);backdrop-filter:blur(20px);border-bottom:.5px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(32px,5vw,44px);font-weight:900;letter-spacing:-1.5px;line-height:1.2;margin-bottom:16px}
h2{font-size:26px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:10px 16px;background:rgba(255,255,255,0.05);border-bottom:1px solid rgba(255,255,255,0.08);display:flex;justify-content:space-between}
.code-filename{font-size:13px;color:#cdd6f4;font-family:'JetBrains Mono',monospace}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.6;color:#cdd6f4;white-space:pre;overflow-x:auto}
.code-body .kw{color:#cba6f7}.code-body .type{color:#89b4fa}.code-body .str{color:#a6e3a1}.code-body .func{color:#89dceb}.code-body .prop{color:#f5c2e7}.code-body .comment{color:#6c7086}.code-body .num{color:#fab387}
</style>
</head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="01-tutorial.en.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">ğŸŒ EN</a></div></div>
<article>
<h1>ğŸ” Local Authentication ì™„ì „ì •ë³µ</h1>
<p>Face IDì™€ Touch IDë¡œ ì•±ì„ ì•ˆì „í•˜ê²Œ! ìƒì²´ ì¸ì¦ë¶€í„° ë¹„ë°€ë²ˆí˜¸ ëŒ€ì²´ê¹Œì§€ ì™„ë²½ ê°€ì´ë“œ.</p>

<h2>âœ¨ Local Authenticationì´ë€?</h2>
<p>Local Authenticationì€ Face ID, Touch ID, ê¸°ê¸° ì•”í˜¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ëŠ” í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. ë¡œê·¸ì¸, ê²°ì œ ìŠ¹ì¸, ë¯¼ê°í•œ ì •ë³´ ì ‘ê·¼ ì‹œ ì•ˆì „í•˜ê³  í¸ë¦¬í•œ ì¸ì¦ì„ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ìƒì²´ ë°ì´í„°ëŠ” ê¸°ê¸° ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë˜ì–´ ì„œë²„ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<h2>ğŸ“¦ ì£¼ìš” ê¸°ëŠ¥</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">ê¸°ëŠ¥ ê°œìš”</span></div>
<pre class="code-body"><span class="comment">âœ… Face ID / Touch ID ì¸ì¦
âœ… ê¸°ê¸° ì•”í˜¸ ì¸ì¦ (ë¹„ë°€ë²ˆí˜¸)
âœ… ìƒì²´ ì¸ì¦ ê°€ìš©ì„± í™•ì¸
âœ… ì¸ì¦ ì‹¤íŒ¨ ì²˜ë¦¬ ë° ì¬ì‹œë„
âœ… ì»¤ìŠ¤í…€ ì¸ì¦ UI
âœ… ë¹„ë°€ë²ˆí˜¸ ëŒ€ì²´ ì¸ì¦</span></pre></div>

<h2>ğŸ” ìƒì²´ ì¸ì¦ ê°€ìš©ì„± í™•ì¸</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">BiometryCheck.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">func</span> <span class="func">checkBiometryAvailability</span>() -> (<span class="type">Bool</span>, <span class="type">String</span>) {
    <span class="kw">let</span> context = <span class="type">LAContext</span>()
    <span class="kw">var</span> error: <span class="type">NSError</span>?

    <span class="comment">// ìƒì²´ ì¸ì¦ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸</span>
    <span class="kw">let</span> canEvaluate = context.<span class="func">canEvaluatePolicy</span>(
        .deviceOwnerAuthenticationWithBiometrics,
        error: &error
    )

    <span class="kw">if</span> canEvaluate {
        <span class="comment">// ìƒì²´ ì¸ì¦ íƒ€ì… í™•ì¸</span>
        <span class="kw">switch</span> context.biometryType {
        <span class="kw">case</span> .faceID:
            <span class="kw">return</span> (<span class="kw">true</span>, <span class="str">"Face ID ì‚¬ìš© ê°€ëŠ¥"</span>)
        <span class="kw">case</span> .touchID:
            <span class="kw">return</span> (<span class="kw">true</span>, <span class="str">"Touch ID ì‚¬ìš© ê°€ëŠ¥"</span>)
        <span class="kw">case</span> .opticID:
            <span class="kw">return</span> (<span class="kw">true</span>, <span class="str">"Optic ID ì‚¬ìš© ê°€ëŠ¥"</span>)
        <span class="kw">case</span> .none:
            <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ìƒì²´ ì¸ì¦ ë¯¸ì§€ì›"</span>)
        @unknown <span class="kw">default</span>:
            <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ì•Œ ìˆ˜ ì—†ëŠ” íƒ€ì…"</span>)
        }
    } <span class="kw">else</span> {
        <span class="comment">// ì˜¤ë¥˜ ì²˜ë¦¬</span>
        <span class="kw">if let</span> error = error {
            <span class="kw">switch</span> <span class="type">LAError</span>.<span class="type">Code</span>(rawValue: error.code) {
            <span class="kw">case</span> .biometryNotEnrolled:
                <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ìƒì²´ ì¸ì¦ ë¯¸ë“±ë¡"</span>)
            <span class="kw">case</span> .biometryNotAvailable:
                <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ìƒì²´ ì¸ì¦ ë¯¸ì§€ì›"</span>)
            <span class="kw">case</span> .passcodeNotSet:
                <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ê¸°ê¸° ì•”í˜¸ ë¯¸ì„¤ì •"</span>)
            <span class="kw">default</span>:
                <span class="kw">return</span> (<span class="kw">false</span>, error.localizedDescription)
            }
        }
        <span class="kw">return</span> (<span class="kw">false</span>, <span class="str">"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"</span>)
    }
}

<span class="comment">// ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="kw">let</span> (available, message) = <span class="func">checkBiometryAvailability</span>()
<span class="func">print</span>(message)  <span class="comment">// "Face ID ì‚¬ìš© ê°€ëŠ¥"</span></pre></div>

<h2>ğŸ” ê¸°ë³¸ ìƒì²´ ì¸ì¦</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">BasicAuth.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">func</span> <span class="func">authenticateUser</span>() <span class="kw">async</span> -> <span class="type">Bool</span> {
    <span class="kw">let</span> context = <span class="type">LAContext</span>()
    <span class="kw">var</span> error: <span class="type">NSError</span>?

    <span class="comment">// ìƒì²´ ì¸ì¦ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸</span>
    <span class="kw">guard</span> context.<span class="func">canEvaluatePolicy</span>(
        .deviceOwnerAuthenticationWithBiometrics,
        error: &error
    ) <span class="kw">else</span> {
        <span class="func">print</span>(<span class="str">"ìƒì²´ ì¸ì¦ ë¶ˆê°€: \(error?.localizedDescription ?? "")"</span>)
        <span class="kw">return false</span>
    }

    <span class="kw">do</span> {
        <span class="comment">// ì¸ì¦ ì‹œë„</span>
        <span class="kw">let</span> success = <span class="kw">try await</span> context.<span class="func">evaluatePolicy</span>(
            .deviceOwnerAuthenticationWithBiometrics,
            localizedReason: <span class="str">"ì•±ì— ë¡œê·¸ì¸í•˜ë ¤ë©´ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤"</span>
        )
        <span class="kw">return</span> success
    } <span class="kw">catch let</span> error {
        <span class="comment">// ì¸ì¦ ì‹¤íŒ¨ ì²˜ë¦¬</span>
        <span class="kw">if let</span> laError = error <span class="kw">as</span>? <span class="type">LAError</span> {
            <span class="kw">switch</span> laError.code {
            <span class="kw">case</span> .authenticationFailed:
                <span class="func">print</span>(<span class="str">"ì¸ì¦ ì‹¤íŒ¨ (ì–¼êµ´/ì§€ë¬¸ ë¶ˆì¼ì¹˜)"</span>)
            <span class="kw">case</span> .userCancel:
                <span class="func">print</span>(<span class="str">"ì‚¬ìš©ìê°€ ì·¨ì†Œí•¨"</span>)
            <span class="kw">case</span> .userFallback:
                <span class="func">print</span>(<span class="str">"ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì„ íƒ"</span>)
            <span class="kw">case</span> .systemCancel:
                <span class="func">print</span>(<span class="str">"ì‹œìŠ¤í…œì´ ì·¨ì†Œ (ì•± ì „í™˜ ë“±)"</span>)
            <span class="kw">case</span> .biometryLockout:
                <span class="func">print</span>(<span class="str">"ë„ˆë¬´ ë§ì€ ì‹œë„ë¡œ ì ê¹€"</span>)
            <span class="kw">default</span>:
                <span class="func">print</span>(<span class="str">"ì¸ì¦ ì˜¤ë¥˜: \(laError.localizedDescription)"</span>)
            }
        }
        <span class="kw">return false</span>
    }
}

<span class="comment">// ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="kw">let</span> authenticated = <span class="kw">await</span> <span class="func">authenticateUser</span>()
<span class="kw">if</span> authenticated {
    <span class="func">print</span>(<span class="str">"ë¡œê·¸ì¸ ì„±ê³µ!"</span>)
}</pre></div>

<h2>ğŸ”‘ ê¸°ê¸° ì•”í˜¸ í¬í•¨ ì¸ì¦</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">PasscodeAuth.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">func</span> <span class="func">authenticateWithPasscode</span>() <span class="kw">async</span> -> <span class="type">Bool</span> {
    <span class="kw">let</span> context = <span class="type">LAContext</span>()

    <span class="comment">// ìƒì²´ ì¸ì¦ ì‹¤íŒ¨ ì‹œ ê¸°ê¸° ì•”í˜¸ ì…ë ¥ í—ˆìš©</span>
    context.localizedFallbackTitle = <span class="str">"ì•”í˜¸ ì…ë ¥"</span>

    <span class="kw">do</span> {
        <span class="kw">let</span> success = <span class="kw">try await</span> context.<span class="func">evaluatePolicy</span>(
            .deviceOwnerAuthentication,  <span class="comment">// ìƒì²´ ì¸ì¦ + ê¸°ê¸° ì•”í˜¸</span>
            localizedReason: <span class="str">"ê³„ì •ì— ì ‘ê·¼í•˜ë ¤ë©´ ì¸ì¦í•˜ì„¸ìš”"</span>
        )
        <span class="kw">return</span> success
    } <span class="kw">catch</span> {
        <span class="func">print</span>(<span class="str">"ì¸ì¦ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        <span class="kw">return false</span>
    }
}

<span class="comment">// ì»¤ìŠ¤í…€ ì·¨ì†Œ ë²„íŠ¼ í…ìŠ¤íŠ¸</span>
<span class="kw">func</span> <span class="func">authenticateWithCustomButton</span>() <span class="kw">async</span> -> <span class="type">Bool</span> {
    <span class="kw">let</span> context = <span class="type">LAContext</span>()
    context.localizedCancelTitle = <span class="str">"ë‚˜ì¤‘ì—"</span>
    context.localizedFallbackTitle = <span class="str">"ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸"</span>

    <span class="kw">do</span> {
        <span class="kw">return try await</span> context.<span class="func">evaluatePolicy</span>(
            .deviceOwnerAuthenticationWithBiometrics,
            localizedReason: <span class="str">"ë¯¼ê°í•œ ì •ë³´ì— ì ‘ê·¼í•©ë‹ˆë‹¤"</span>
        )
    } <span class="kw">catch</span> {
        <span class="kw">return false</span>
    }
}</pre></div>

<h2>ğŸ“± SwiftUI í†µí•©</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">AuthView.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">struct</span> <span class="type">AuthenticationView</span>: <span class="type">View</span> {
    @<span class="type">State</span> <span class="kw">private var</span> isAuthenticated = <span class="kw">false</span>
    @<span class="type">State</span> <span class="kw">private var</span> showError = <span class="kw">false</span>
    @<span class="type">State</span> <span class="kw">private var</span> errorMessage = <span class="str">""</span>

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">VStack</span>(spacing: <span class="num">20</span>) {
            <span class="kw">if</span> isAuthenticated {
                <span class="comment">// ì¸ì¦ í›„ í™”ë©´</span>
                <span class="type">VStack</span>(spacing: <span class="num">16</span>) {
                    <span class="type">Image</span>(systemName: <span class="str">"checkmark.circle.fill"</span>)
                        .font(.system(size: <span class="num">80</span>))
                        .foregroundStyle(.green)

                    <span class="type">Text</span>(<span class="str">"ì¸ì¦ ì„±ê³µ"</span>)
                        .font(.title)
                        .bold()

                    <span class="type">Text</span>(<span class="str">"ì•ˆì „í•˜ê²Œ ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤"</span>)
                        .foregroundStyle(.secondary)

                    <span class="type">Button</span>(<span class="str">"ë¡œê·¸ì•„ì›ƒ"</span>) {
                        isAuthenticated = <span class="kw">false</span>
                    }
                    .buttonStyle(.borderedProminent)
                }
            } <span class="kw">else</span> {
                <span class="comment">// ë¡œê·¸ì¸ í™”ë©´</span>
                <span class="type">VStack</span>(spacing: <span class="num">16</span>) {
                    <span class="type">Image</span>(systemName: <span class="str">"faceid"</span>)
                        .font(.system(size: <span class="num">80</span>))
                        .foregroundStyle(.blue)

                    <span class="type">Text</span>(<span class="str">"ìƒì²´ ì¸ì¦ í•„ìš”"</span>)
                        .font(.title)
                        .bold()

                    <span class="type">Text</span>(<span class="str">"Face IDë¡œ ì•ˆì „í•˜ê²Œ ë¡œê·¸ì¸í•˜ì„¸ìš”"</span>)
                        .foregroundStyle(.secondary)

                    <span class="type">Button</span>(<span class="str">"ì¸ì¦í•˜ê¸°"</span>) {
                        <span class="type">Task</span> {
                            <span class="kw">await</span> <span class="func">authenticate</span>()
                        }
                    }
                    .buttonStyle(.borderedProminent)
                }
            }
        }
        .padding()
        .alert(<span class="str">"ì¸ì¦ ì‹¤íŒ¨"</span>, isPresented: $showError) {
            <span class="type">Button</span>(<span class="str">"í™•ì¸"</span>, role: .cancel) { }
        } message: {
            <span class="type">Text</span>(errorMessage)
        }
        .onAppear {
            <span class="comment">// ì•± ì‹œì‘ ì‹œ ìë™ ì¸ì¦ ì‹œë„</span>
            <span class="type">Task</span> {
                <span class="kw">await</span> <span class="func">authenticate</span>()
            }
        }
    }

    <span class="kw">func</span> <span class="func">authenticate</span>() <span class="kw">async</span> {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()
        <span class="kw">var</span> error: <span class="type">NSError</span>?

        <span class="kw">guard</span> context.<span class="func">canEvaluatePolicy</span>(
            .deviceOwnerAuthentication,
            error: &error
        ) <span class="kw">else</span> {
            errorMessage = error?.localizedDescription ?? <span class="str">"ì¸ì¦ ë¶ˆê°€"</span>
            showError = <span class="kw">true</span>
            <span class="kw">return</span>
        }

        <span class="kw">do</span> {
            <span class="kw">let</span> success = <span class="kw">try await</span> context.<span class="func">evaluatePolicy</span>(
                .deviceOwnerAuthentication,
                localizedReason: <span class="str">"ì•± ì ‘ê·¼ì„ ìœ„í•´ ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤"</span>
            )

            <span class="kw">await</span> <span class="type">MainActor</span>.<span class="func">run</span> {
                isAuthenticated = success
            }
        } <span class="kw">catch let</span> error {
            <span class="kw">await</span> <span class="type">MainActor</span>.<span class="func">run</span> {
                errorMessage = error.localizedDescription
                showError = <span class="kw">true</span>
            }
        }
    }
}</pre></div>

<h2>ğŸ”’ ì‹¤ì „ ì˜ˆì œ: ë¯¼ê° ì •ë³´ ë³´í˜¸</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">SecureDataView.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">struct</span> <span class="type">SecureDataView</span>: <span class="type">View</span> {
    @<span class="type">State</span> <span class="kw">private var</span> isUnlocked = <span class="kw">false</span>
    @<span class="type">State</span> <span class="kw">private var</span> sensitiveData = <span class="str">"****-****-****-1234"</span>

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">List</span> {
            <span class="type">Section</span>(<span class="str">"ê³„ì¢Œ ì •ë³´"</span>) {
                <span class="type">HStack</span> {
                    <span class="type">Text</span>(<span class="str">"ê³„ì¢Œë²ˆí˜¸"</span>)
                    <span class="type">Spacer</span>()
                    <span class="type">Text</span>(isUnlocked ? <span class="str">"1234-5678-9012-3456"</span> : <span class="str">"****-****-****-3456"</span>)
                        .font(.system(.body, design: .monospaced))
                }

                <span class="type">HStack</span> {
                    <span class="type">Text</span>(<span class="str">"ì”ì•¡"</span>)
                    <span class="type">Spacer</span>()
                    <span class="type">Text</span>(isUnlocked ? <span class="str">"1,234,567ì›"</span> : <span class="str">"*******ì›"</span>)
                }
            }

            <span class="type">Section</span> {
                <span class="type">Button</span>(isUnlocked ? <span class="str">"ì •ë³´ ìˆ¨ê¸°ê¸°"</span> : <span class="str">"ì •ë³´ ë³´ê¸°"</span>) {
                    <span class="kw">if</span> isUnlocked {
                        isUnlocked = <span class="kw">false</span>
                    } <span class="kw">else</span> {
                        <span class="type">Task</span> {
                            <span class="kw">await</span> <span class="func">authenticate</span>()
                        }
                    }
                }
            }
        }
        .navigationTitle(<span class="str">"ë‚´ ê³„ì¢Œ"</span>)
    }

    <span class="kw">func</span> <span class="func">authenticate</span>() <span class="kw">async</span> {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()

        <span class="kw">do</span> {
            <span class="kw">let</span> success = <span class="kw">try await</span> context.<span class="func">evaluatePolicy</span>(
                .deviceOwnerAuthentication,
                localizedReason: <span class="str">"ë¯¼ê°í•œ ê³„ì¢Œ ì •ë³´ë¥¼ ë³´ë ¤ë©´ ì¸ì¦í•˜ì„¸ìš”"</span>
            )

            <span class="kw">if</span> success {
                <span class="kw">await</span> <span class="type">MainActor</span>.<span class="func">run</span> {
                    <span class="func">withAnimation</span> {
                        isUnlocked = <span class="kw">true</span>
                    }
                }
            }
        } <span class="kw">catch</span> {
            <span class="func">print</span>(<span class="str">"ì¸ì¦ ì‹¤íŒ¨"</span>)
        }
    }
}</pre></div>

<h2>â±ï¸ ì¸ì¦ ì»¨í…ìŠ¤íŠ¸ ì¬ì‚¬ìš©</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">ContextReuse.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">class</span> <span class="type">AuthenticationManager</span> {
    <span class="kw">private let</span> <span class="prop">context</span> = <span class="type">LAContext</span>()

    <span class="kw">init</span>() {
        <span class="comment">// ì¸ì¦ ìœ íš¨ ì‹œê°„ ì„¤ì • (ê¸°ë³¸ 10ì´ˆ)</span>
        context.touchIDAuthenticationAllowableReuseDuration = <span class="num">30</span>  <span class="comment">// 30ì´ˆ</span>
    }

    <span class="kw">func</span> <span class="func">authenticate</span>(reason: <span class="type">String</span>) <span class="kw">async</span> -> <span class="type">Bool</span> {
        <span class="kw">do</span> {
            <span class="comment">// 30ì´ˆ ë‚´ ì¬ì¸ì¦ ì‹œ ìƒì²´ ì¸ì¦ ìƒëµ</span>
            <span class="kw">return try await</span> context.<span class="func">evaluatePolicy</span>(
                .deviceOwnerAuthenticationWithBiometrics,
                localizedReason: reason
            )
        } <span class="kw">catch</span> {
            <span class="kw">return false</span>
        }
    }

    <span class="kw">func</span> <span class="func">invalidate</span>() {
        <span class="comment">// ì»¨í…ìŠ¤íŠ¸ ë¬´íš¨í™” (ì¦‰ì‹œ ì¬ì¸ì¦ í•„ìš”)</span>
        context.<span class="func">invalidate</span>()
    }
}

<span class="comment">// ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="kw">let</span> authManager = <span class="type">AuthenticationManager</span>()

<span class="comment">// ì²« ì¸ì¦ (ìƒì²´ ì¸ì¦ í•„ìš”)</span>
<span class="kw">let</span> success1 = <span class="kw">await</span> authManager.<span class="func">authenticate</span>(reason: <span class="str">"ê²°ì œ ìŠ¹ì¸"</span>)

<span class="comment">// 30ì´ˆ ë‚´ ì¬ì¸ì¦ (ìƒì²´ ì¸ì¦ ìƒëµ)</span>
<span class="kw">let</span> success2 = <span class="kw">await</span> authManager.<span class="func">authenticate</span>(reason: <span class="str">"ì¶”ê°€ ê²°ì œ"</span>)

<span class="comment">// ë¡œê·¸ì•„ì›ƒ ì‹œ ì»¨í…ìŠ¤íŠ¸ ë¬´íš¨í™”</span>
authManager.<span class="func">invalidate</span>()</pre></div>

<h2>ğŸ¯ ê³ ê¸‰ ê¸°ëŠ¥: ë„ë©”ì¸ ìƒíƒœ</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">DomainState.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="kw">class</span> <span class="type">BiometricStateMonitor</span> {
    <span class="kw">private var</span> domainState: <span class="type">Data</span>?

    <span class="kw">func</span> <span class="func">saveBiometricState</span>() {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()
        <span class="kw">var</span> error: <span class="type">NSError</span>?

        <span class="kw">guard</span> context.<span class="func">canEvaluatePolicy</span>(
            .deviceOwnerAuthenticationWithBiometrics,
            error: &error
        ) <span class="kw">else</span> {
            <span class="kw">return</span>
        }

        <span class="comment">// í˜„ì¬ ìƒì²´ ì¸ì¦ ìƒíƒœ ì €ì¥</span>
        domainState = context.evaluatedPolicyDomainState
        <span class="type">UserDefaults</span>.standard.set(domainState, forKey: <span class="str">"BiometricState"</span>)
    }

    <span class="kw">func</span> <span class="func">hasBiometricChanged</span>() -> <span class="type">Bool</span> {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()
        <span class="kw">var</span> error: <span class="type">NSError</span>?

        <span class="kw">guard</span> context.<span class="func">canEvaluatePolicy</span>(
            .deviceOwnerAuthenticationWithBiometrics,
            error: &error
        ) <span class="kw">else</span> {
            <span class="kw">return true</span>
        }

        <span class="comment">// ì €ì¥ëœ ìƒíƒœì™€ ë¹„êµ</span>
        <span class="kw">guard let</span> savedState = <span class="type">UserDefaults</span>.standard.data(forKey: <span class="str">"BiometricState"</span>) <span class="kw">else</span> {
            <span class="kw">return true</span>
        }

        <span class="kw">let</span> currentState = context.evaluatedPolicyDomainState
        <span class="kw">return</span> savedState != currentState
    }

    <span class="kw">func</span> <span class="func">handleBiometricChange</span>() {
        <span class="kw">if</span> <span class="func">hasBiometricChanged</span>() {
            <span class="func">print</span>(<span class="str">"âš ï¸ ìƒì²´ ì¸ì¦ ì •ë³´ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!"</span>)
            <span class="func">print</span>(<span class="str">"ë³´ì•ˆì„ ìœ„í•´ ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ì„¸ìš”."</span>)

            <span class="comment">// ì•± ë°ì´í„° ì´ˆê¸°í™” ë˜ëŠ” ì¬ë¡œê·¸ì¸ ìš”êµ¬</span>
            <span class="func">logoutUser</span>()
            <span class="func">saveBiometricState</span>()
        }
    }

    <span class="kw">func</span> <span class="func">logoutUser</span>() {
        <span class="comment">// ë¡œê·¸ì•„ì›ƒ ë¡œì§</span>
        <span class="type">UserDefaults</span>.standard.set(<span class="kw">false</span>, forKey: <span class="str">"IsLoggedIn"</span>)
    }
}

<span class="comment">// ì‚¬ìš© ì˜ˆì‹œ</span>
<span class="kw">let</span> monitor = <span class="type">BiometricStateMonitor</span>()
monitor.<span class="func">saveBiometricState</span>()  <span class="comment">// ë¡œê·¸ì¸ ì‹œ</span>

<span class="comment">// ì•± ì‹œì‘ ì‹œ í™•ì¸</span>
monitor.<span class="func">handleBiometricChange</span>()</pre></div>

<h2>ğŸ’¡ HIG ê°€ì´ë“œë¼ì¸</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">HIG ê¶Œì¥ì‚¬í•­</span></div>
<pre class="code-body"><span class="comment">âœ… DO
1. ëª…í™•í•œ ì´ìœ  ì œê³µ
   - "ê²°ì œë¥¼ ìŠ¹ì¸í•˜ë ¤ë©´ Face IDê°€ í•„ìš”í•©ë‹ˆë‹¤"
   - ì‚¬ìš©ìì—ê²Œ ì™œ ì¸ì¦ì´ í•„ìš”í•œì§€ ëª…í™•íˆ ì„¤ëª…

2. ëŒ€ì²´ ìˆ˜ë‹¨ ì œê³µ
   - ìƒì²´ ì¸ì¦ ì‹¤íŒ¨ ì‹œ ê¸°ê¸° ì•”í˜¸ í—ˆìš©
   - .deviceOwnerAuthentication ì •ì±… ì‚¬ìš©

3. ì ì ˆí•œ íƒ€ì´ë°
   - ë¯¼ê°í•œ ì‘ì—… ì§ì „ì—ë§Œ ìš”ì²­
   - ë„ˆë¬´ ìì£¼ ìš”ì²­í•˜ì§€ ì•Šê¸°

4. ì˜¤ë¥˜ ì²˜ë¦¬
   - ì¸ì¦ ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ í”¼ë“œë°±
   - ì¬ì‹œë„ ì˜µì…˜ ì œê³µ

âŒ DON'T
1. ì•± ì‹œì‘ë§ˆë‹¤ ì¸ì¦ ìš”êµ¬ (ë¶ˆí•„ìš”í•œ ê²½ìš°)
2. ìƒì²´ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡
3. ì¸ì¦ ì—†ì´ë„ ê¸°ë³¸ ê¸°ëŠ¥ì€ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ
4. "Touch ID"ë¼ê³  ëª…ì‹œ (ê¸°ê¸°ë³„ë¡œ ë‹¤ë¦„)</span></pre></div>

<h2>ğŸ”§ ì‹¤ë¬´ í™œìš© íŒ</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">ì‹¤ì „ íŒ¨í„´</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">LocalAuthentication</span>

<span class="comment">// 1. ì¸ì¦ í—¬í¼ í´ë˜ìŠ¤</span>
<span class="kw">class</span> <span class="type">BiometricAuth</span> {
    <span class="kw">static let</span> <span class="prop">shared</span> = <span class="type">BiometricAuth</span>()
    <span class="kw">private</span> <span class="kw">init</span>() {}

    <span class="kw">var</span> <span class="prop">biometricType</span>: <span class="type">LABiometryType</span> {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()
        _ = context.<span class="func">canEvaluatePolicy</span>(.deviceOwnerAuthenticationWithBiometrics, error: <span class="kw">nil</span>)
        <span class="kw">return</span> context.biometryType
    }

    <span class="kw">var</span> <span class="prop">biometricName</span>: <span class="type">String</span> {
        <span class="kw">switch</span> biometricType {
        <span class="kw">case</span> .faceID: <span class="kw">return</span> <span class="str">"Face ID"</span>
        <span class="kw">case</span> .touchID: <span class="kw">return</span> <span class="str">"Touch ID"</span>
        <span class="kw">case</span> .opticID: <span class="kw">return</span> <span class="str">"Optic ID"</span>
        <span class="kw">case</span> .none: <span class="kw">return</span> <span class="str">"ìƒì²´ ì¸ì¦"</span>
        @unknown <span class="kw">default</span>: <span class="kw">return</span> <span class="str">"ìƒì²´ ì¸ì¦"</span>
        }
    }

    <span class="kw">func</span> <span class="func">authenticate</span>(reason: <span class="type">String</span>) <span class="kw">async throws</span> -> <span class="type">Bool</span> {
        <span class="kw">let</span> context = <span class="type">LAContext</span>()
        <span class="kw">return try await</span> context.<span class="func">evaluatePolicy</span>(
            .deviceOwnerAuthentication,
            localizedReason: reason
        )
    }
}

<span class="comment">// 2. SwiftUIì—ì„œ ì‚¬ìš©</span>
<span class="kw">struct</span> <span class="type">SettingsView</span>: <span class="type">View</span> {
    @<span class="type">AppStorage</span>(<span class="str">"useBiometric"</span>) <span class="kw">private var</span> useBiometric = <span class="kw">false</span>

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">Form</span> {
            <span class="type">Section</span>(<span class="str">"ë³´ì•ˆ"</span>) {
                <span class="type">Toggle</span>(<span class="str">"\(<span class="type">BiometricAuth</span>.<span class="prop">shared</span>.<span class="prop">biometricName</span>) ì‚¬ìš©"</span>, isOn: $useBiometric)
            }
        }
    }
}

<span class="comment">// 3. ê²°ì œ ìŠ¹ì¸ ì˜ˆì‹œ</span>
<span class="kw">func</span> <span class="func">processPayment</span>(amount: <span class="type">Int</span>) <span class="kw">async</span> -> <span class="type">Bool</span> {
    <span class="kw">do</span> {
        <span class="kw">let</span> authenticated = <span class="kw">try await</span> <span class="type">BiometricAuth</span>.shared.<span class="func">authenticate</span>(
            reason: <span class="str">"\(amount)ì› ê²°ì œë¥¼ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"</span>
        )

        <span class="kw">if</span> authenticated {
            <span class="comment">// ê²°ì œ ì²˜ë¦¬</span>
            <span class="kw">await</span> <span class="func">performPaymentTransaction</span>(amount)
            <span class="kw">return true</span>
        }
    } <span class="kw">catch</span> {
        <span class="func">print</span>(<span class="str">"ê²°ì œ ì·¨ì†Œë¨"</span>)
    }
    <span class="kw">return false</span>
}

<span class="kw">func</span> <span class="func">performPaymentTransaction</span>(_ amount: <span class="type">Int</span>) <span class="kw">async</span> {
    <span class="comment">// ì‹¤ì œ ê²°ì œ API í˜¸ì¶œ</span>
}</pre></div>

<h2>ğŸ” Info.plist ì„¤ì •</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">Info.plist</span></div>
<pre class="code-body"><span class="comment">&lt;!-- Face ID ì‚¬ìš© ì‹œ í•„ìˆ˜ --&gt;</span>
<span class="kw">&lt;key&gt;</span>NSFaceIDUsageDescription<span class="kw">&lt;/key&gt;</span>
<span class="kw">&lt;string&gt;</span>ì•ˆì „í•œ ë¡œê·¸ì¸ì„ ìœ„í•´ Face IDë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤<span class="kw">&lt;/string&gt;</span>

<span class="comment">&lt;!-- ë˜ëŠ” í•œêµ­ì–´ë¡œ --&gt;</span>
<span class="kw">&lt;key&gt;</span>NSFaceIDUsageDescription<span class="kw">&lt;/key&gt;</span>
<span class="kw">&lt;string&gt;</span>ê³„ì • ë³´ì•ˆì„ ìœ„í•´ Face ID ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤<span class="kw">&lt;/string&gt;</span></pre></div>

<p style="background:#34c75910;border:1px solid #34c75940;border-radius:12px;padding:16px 20px;margin:24px 0"><strong style="color:#34c759">ğŸ’¡ Local Authentication í•µì‹¬</strong><br>
âœ… ëª¨ë“  ìƒì²´ ë°ì´í„°ëŠ” ê¸°ê¸° ë‚´ì—ì„œë§Œ ì²˜ë¦¬<br>
âœ… Secure Enclaveì— ì•ˆì „í•˜ê²Œ ì €ì¥<br>
âœ… ìƒì²´ ì¸ì¦ ì‹¤íŒ¨ ì‹œ ê¸°ê¸° ì•”í˜¸ ëŒ€ì²´ ìˆ˜ë‹¨ ì œê³µ<br>
âœ… ì•±ì€ ì¸ì¦ ì„±ê³µ/ì‹¤íŒ¨ë§Œ í™•ì¸ ê°€ëŠ¥<br>
âœ… ì‹¤ì œ ìƒì²´ ë°ì´í„°ëŠ” ì•±ì—ì„œ ì ‘ê·¼ ë¶ˆê°€</p>

<h2>ğŸ“¦ í•™ìŠµ ìë£Œ</h2>
<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:24px 0">
<a href="https://github.com/M1zz/HIGLab" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">ğŸ’»</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">GitHub í”„ë¡œì íŠ¸</div>
</a>
<a href="https://developer.apple.com/documentation/localauthentication" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">ğŸ“–</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">Apple ê³µì‹ ë¬¸ì„œ</div>
</a>
<a href="https://developer.apple.com/design/human-interface-guidelines/authentication" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">ğŸ¨</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">HIG ì¸ì¦ ê°€ì´ë“œ</div>
</a>
</div>

</article>
</body>
</html>
