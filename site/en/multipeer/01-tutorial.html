<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ”— MultipeerConnectivity â€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--code-bg:#1e1e2e;--border:#d2d2d7}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(28px,5vw,40px);font-weight:900;margin-bottom:16px;letter-spacing:-1px}
h2{font-size:24px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.subtitle{font-size:18px;color:var(--text-2);margin-bottom:32px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:12px;color:#6e6e73;font-weight:600}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;color:#cdd6f4;white-space:pre;overflow-x:auto}
.kw{color:#cba6f7}.type{color:#89b4fa}.str{color:#a6e3a1}.comment{color:#6c7086}
.badge{display:inline-block;padding:4px 12px;border-radius:16px;font-size:13px;font-weight:600;margin:0 4px 8px 0}
.badge.ios{background:#0071e3;color:#fff}.badge.new{background:#34c759;color:#fff}
ul{margin:16px 0 16px 24px}li{margin:8px 0}
.info-box{background:#f5f5f7;border-left:4px solid var(--accent);padding:16px;margin:24px 0;border-radius:8px}
</style></head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="01-tutorial.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">ğŸŒ KO</a></div></div>
<article>
<h1>ğŸ”— MultipeerConnectivity</h1>
<!-- higlab-metadata -->
<div style="display:flex;gap:16px;align-items:center;margin:12px 0 24px;padding:12px 16px;background:var(--tag-bg,#f5f5f7);border-radius:10px;font-size:13px;color:var(--text-2,#6e6e73);flex-wrap:wrap;">
  <span>â­ Difficulty: â­â­â­</span>
  <span>â±ï¸ Est. Time: 2-3h</span>
  <span>ğŸ“‚ System & Network</span>
</div>
<p class="subtitle">ê·¼ê±°ë¦¬ P2P í†µì‹  ë° ë°ì´í„° ê³µìœ  í”„ë ˆì„ì›Œí¬</p>

<div><span class="badge ios">iOS 7+</span><span class="badge new">Wi-Fi/BLE ìë™ ì „í™˜</span></div>

<h2>âœ¨ MultipeerConnectivity?</h2>
<p>MultipeerConnectivity is a framework for exchanging data between nearby devices using Wi-Fi, Bluetooth, and P2P Wi-Fi. Up to 8 devices can form an ad-hoc network without internet, reliably transferring text, files, and stream data. You can implement AirDrop-like functionality directly in your app.</p>

<div class="info-box">
<strong>ğŸ’¡ Key Features:</strong> Peer-to-Peer Communication Â· Auto Device Discovery Â· Wi-Fi/BLE Auto Switch Â· File Transfer Â· Stream Data Â· Up to 8 Connections Â· Encrypted Communication
</div>

<h2>ğŸ“¡ 1. MCSession ì´ˆê¸°í™”</h2>
<p>Peer-to-Peer ì„¸ì…˜ì„ ìƒì„±í•˜ê³  ê´€ë¦¬.</p>

<div class="code-block">
<div class="code-header">MultipeerManager.swift â€” Session Initialization</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">MultipeerConnectivity</span>
<span class="kw">import</span> <span class="type">SwiftUI</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">MultipeerManager</span>: <span class="type">NSObject</span> {
    <span class="kw">private</span> <span class="kw">let</span> serviceType = <span class="str">"hig-lab-chat"</span> <span class="comment">// 15ì ì´í•˜, ì†Œë¬¸ì/ìˆ«ì/í•˜ì´í”ˆë§Œ</span>
    <span class="kw">private</span> <span class="kw">var</span> myPeerID: <span class="type">MCPeerID</span>
    <span class="kw">private</span> <span class="kw">var</span> session: <span class="type">MCSession</span>
    <span class="kw">private</span> <span class="kw">var</span> advertiser: <span class="type">MCNearbyServiceAdvertiser</span>?
    <span class="kw">private</span> <span class="kw">var</span> browser: <span class="type">MCNearbyServiceBrowser</span>?

    <span class="kw">var</span> connectedPeers: [<span class="type">MCPeerID</span>] = []
    <span class="kw">var</span> availablePeers: [<span class="type">MCPeerID</span>] = []
    <span class="kw">var</span> receivedMessages: [<span class="type">String</span>] = []
    <span class="kw">var</span> isAdvertising = <span class="kw">false</span>
    <span class="kw">var</span> isBrowsing = <span class="kw">false</span>

    <span class="kw">override</span> <span class="kw">init</span>() {
        <span class="comment">// Peer ID ìƒì„± (ê¸°ê¸° ì´ë¦„ ì‚¬ìš©)</span>
        myPeerID = <span class="type">MCPeerID</span>(displayName: <span class="type">UIDevice</span>.current.name)

        <span class="comment">// ì„¸ì…˜ ìƒì„±</span>
        session = <span class="type">MCSession</span>(
            peer: myPeerID,
            securityIdentity: <span class="kw">nil</span>,
            encryptionPreference: .required
        )

        <span class="kw">super</span>.<span class="kw">init</span>()

        session.delegate = <span class="kw">self</span>

        print(<span class="str">"ğŸ“± Peer ID: \(myPeerID.displayName)"</span>)
    }

    <span class="comment">// Advertiser ì‹œì‘ (ë‹¤ë¥¸ ê¸°ê¸°ê°€ ë‚˜ë¥¼ ë°œê²¬í•  ìˆ˜ ìˆê²Œ)</span>
    <span class="kw">func</span> startAdvertising() {
        advertiser = <span class="type">MCNearbyServiceAdvertiser</span>(
            peer: myPeerID,
            discoveryInfo: [<span class="str">"status"</span>: <span class="str">"available"</span>],
            serviceType: serviceType
        )
        advertiser?.delegate = <span class="kw">self</span>
        advertiser?.startAdvertisingPeer()

        isAdvertising = <span class="kw">true</span>
        print(<span class="str">"ğŸ“¢ Advertising ì‹œì‘"</span>)
    }

    <span class="comment">// Advertiser ì¤‘ì§€</span>
    <span class="kw">func</span> stopAdvertising() {
        advertiser?.stopAdvertisingPeer()
        advertiser = <span class="kw">nil</span>
        isAdvertising = <span class="kw">false</span>
        print(<span class="str">"â¹ï¸ Advertising ì¤‘ì§€"</span>)
    }

    <span class="comment">// Browser ì‹œì‘ (ë‹¤ë¥¸ ê¸°ê¸° ê²€ìƒ‰)</span>
    <span class="kw">func</span> startBrowsing() {
        browser = <span class="type">MCNearbyServiceBrowser</span>(peer: myPeerID, serviceType: serviceType)
        browser?.delegate = <span class="kw">self</span>
        browser?.startBrowsingForPeers()

        isBrowsing = <span class="kw">true</span>
        print(<span class="str">"ğŸ” Browsing ì‹œì‘"</span>)
    }

    <span class="comment">// Browser ì¤‘ì§€</span>
    <span class="kw">func</span> stopBrowsing() {
        browser?.stopBrowsingForPeers()
        browser = <span class="kw">nil</span>
        isBrowsing = <span class="kw">false</span>
        print(<span class="str">"â¹ï¸ Browsing ì¤‘ì§€"</span>)
    }

    <span class="comment">// Peerì—ê²Œ ì´ˆëŒ€ ë³´ë‚´ê¸°</span>
    <span class="kw">func</span> invitePeer(<span class="kw">_</span> peerID: <span class="type">MCPeerID</span>) {
        <span class="kw">guard</span> <span class="kw">let</span> browser = browser <span class="kw">else</span> { <span class="kw">return</span> }

        browser.invitePeer(
            peerID,
            to: session,
            withContext: <span class="kw">nil</span>,
            timeout: <span class="str">30</span>
        )

        print(<span class="str">"âœ‰ï¸ ì´ˆëŒ€ ì „ì†¡: \(peerID.displayName)"</span>)
    }

    <span class="comment">// ì—°ê²° í•´ì œ</span>
    <span class="kw">func</span> disconnect() {
        session.disconnect()
        connectedPeers.removeAll()
        print(<span class="str">"âŒ ì—°ê²° í•´ì œ"</span>)
    }
}</pre>
</div>

<h2>ğŸ’¬ 2. ë©”ì‹œì§€ ì „ì†¡</h2>
<p>ì—°ê²°ëœ Peerë“¤ì—ê²Œ ë°ì´í„°ë¥¼ ì „ì†¡.</p>

<div class="code-block">
<div class="code-header">MultipeerManager+Send.swift â€” Data Transfer</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">MultipeerConnectivity</span>

<span class="kw">extension</span> <span class="type">MultipeerManager</span> {
    <span class="comment">// í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡</span>
    <span class="kw">func</span> sendMessage(<span class="kw">_</span> message: <span class="type">String</span>) {
        <span class="kw">guard</span> !connectedPeers.isEmpty <span class="kw">else</span> {
            print(<span class="str">"âš ï¸ ì—°ê²°ëœ Peerê°€ ì—†ìŠµë‹ˆë‹¤"</span>)
            <span class="kw">return</span>
        }

        <span class="kw">guard</span> <span class="kw">let</span> data = message.data(using: .utf8) <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="comment">// ëª¨ë“  ì—°ê²°ëœ Peerì—ê²Œ ì „ì†¡</span>
            <span class="kw">try</span> session.send(
                data,
                toPeers: connectedPeers,
                with: .reliable
            )

            print(<span class="str">"ğŸ“¤ ë©”ì‹œì§€ ì „ì†¡: \(message)"</span>)
        } <span class="kw">catch</span> {
            print(<span class="str">"âŒ ì „ì†¡ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        }
    }

    <span class="comment">// íŠ¹ì • Peerì—ê²Œë§Œ ì „ì†¡</span>
    <span class="kw">func</span> sendMessage(<span class="kw">_</span> message: <span class="type">String</span>, to peer: <span class="type">MCPeerID</span>) {
        <span class="kw">guard</span> <span class="kw">let</span> data = message.data(using: .utf8) <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="kw">try</span> session.send(data, toPeers: [peer], with: .reliable)
            print(<span class="str">"ğŸ“¤ ë©”ì‹œì§€ ì „ì†¡ (\(peer.displayName)): \(message)"</span>)
        } <span class="kw">catch</span> {
            print(<span class="str">"âŒ ì „ì†¡ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        }
    }

    <span class="comment">// íŒŒì¼ ì „ì†¡</span>
    <span class="kw">func</span> sendFile(at url: <span class="type">URL</span>, to peer: <span class="type">MCPeerID</span>, withName name: <span class="type">String</span>) {
        session.sendResource(
            at: url,
            withName: name,
            toPeer: peer,
            withCompletionHandler: { error <span class="kw">in</span>
                <span class="kw">if</span> <span class="kw">let</span> error = error {
                    print(<span class="str">"âŒ íŒŒì¼ ì „ì†¡ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                } <span class="kw">else</span> {
                    print(<span class="str">"âœ… íŒŒì¼ ì „ì†¡ ì™„ë£Œ: \(name)"</span>)
                }
            }
        )

        print(<span class="str">"ğŸ“ íŒŒì¼ ì „ì†¡ ì‹œì‘: \(name)"</span>)
    }

    <span class="comment">// ì´ë¯¸ì§€ ì „ì†¡</span>
    <span class="kw">func</span> sendImage(<span class="kw">_</span> image: <span class="type">UIImage</span>) {
        <span class="kw">guard</span> !connectedPeers.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }
        <span class="kw">guard</span> <span class="kw">let</span> imageData = image.jpegData(compressionQuality: <span class="str">0.8</span>) <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="kw">try</span> session.send(imageData, toPeers: connectedPeers, with: .reliable)
            print(<span class="str">"ğŸ–¼ï¸ ì´ë¯¸ì§€ ì „ì†¡ ì™„ë£Œ"</span>)
        } <span class="kw">catch</span> {
            print(<span class="str">"âŒ ì´ë¯¸ì§€ ì „ì†¡ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        }
    }

    <span class="comment">// JSON ë°ì´í„° ì „ì†¡</span>
    <span class="kw">func</span> sendJSON<<span class="type">T</span>: <span class="type">Encodable</span>>(<span class="kw">_</span> object: <span class="type">T</span>) {
        <span class="kw">guard</span> !connectedPeers.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="kw">let</span> encoder = <span class="type">JSONEncoder</span>()
            <span class="kw">let</span> data = <span class="kw">try</span> encoder.encode(object)

            <span class="kw">try</span> session.send(data, toPeers: connectedPeers, with: .reliable)
            print(<span class="str">"ğŸ“¦ JSON ì „ì†¡ ì™„ë£Œ"</span>)
        } <span class="kw">catch</span> {
            print(<span class="str">"âŒ JSON ì „ì†¡ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        }
    }
}</pre>
</div>

<h2>ğŸ“¥ 3. Session ë¸ë¦¬ê²Œì´íŠ¸</h2>
<p>ì—°ê²° ìƒíƒœ ë³€í™”ì™€ ë°ì´í„° ìˆ˜ì‹  handling.</p>

<div class="code-block">
<div class="code-header">MultipeerManager+SessionDelegate.swift â€” Session Delegate</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">MultipeerConnectivity</span>

<span class="kw">extension</span> <span class="type">MultipeerManager</span>: <span class="type">MCSessionDelegate</span> {
    <span class="comment">// Peer ìƒíƒœ ë³€ê²½</span>
    <span class="kw">func</span> session(<span class="kw">_</span> session: <span class="type">MCSession</span>, peer peerID: <span class="type">MCPeerID</span>, didChange state: <span class="type">MCSessionState</span>) {
        <span class="kw">switch</span> state {
        <span class="kw">case</span> .connected:
            print(<span class="str">"âœ… ì—°ê²°ë¨: \(peerID.displayName)"</span>)
            <span class="kw">if</span> !connectedPeers.contains(peerID) {
                connectedPeers.append(peerID)
            }

        <span class="kw">case</span> .connecting:
            print(<span class="str">"ğŸ”— ì—°ê²° ì¤‘: \(peerID.displayName)"</span>)

        <span class="kw">case</span> .notConnected:
            print(<span class="str">"âŒ ì—°ê²° í•´ì œ: \(peerID.displayName)"</span>)
            connectedPeers.removeAll { $0 == peerID }

        <span class="kw">@unknown</span> <span class="kw">default</span>:
            <span class="kw">break</span>
        }
    }

    <span class="comment">// ë°ì´í„° ìˆ˜ì‹ </span>
    <span class="kw">func</span> session(<span class="kw">_</span> session: <span class="type">MCSession</span>, didReceive data: <span class="type">Data</span>, fromPeer peerID: <span class="type">MCPeerID</span>) {
        print(<span class="str">"ğŸ“¥ ë°ì´í„° ìˆ˜ì‹  from \(peerID.displayName): \(data.count) bytes"</span>)

        <span class="comment">// í…ìŠ¤íŠ¸ ë©”ì‹œì§€ ì‹œë„</span>
        <span class="kw">if</span> <span class="kw">let</span> message = <span class="type">String</span>(data: data, encoding: .utf8) {
            <span class="kw">let</span> formattedMessage = <span class="str">"\(peerID.displayName): \(message)"</span>
            receivedMessages.append(formattedMessage)
            print(<span class="str">"  ğŸ’¬ ë©”ì‹œì§€: \(message)"</span>)
        }
        <span class="comment">// ì´ë¯¸ì§€ ì‹œë„</span>
        <span class="kw">else</span> <span class="kw">if</span> <span class="kw">let</span> image = <span class="type">UIImage</span>(data: data) {
            print(<span class="str">"  ğŸ–¼ï¸ ì´ë¯¸ì§€ ìˆ˜ì‹ : \(image.size)"</span>)
            receivedMessages.append(<span class="str">"\(peerID.displayName): [ì´ë¯¸ì§€]"</span>)
        }
        <span class="comment">// ê¸°íƒ€ ë°”ì´ë„ˆë¦¬ ë°ì´í„°</span>
        <span class="kw">else</span> {
            print(<span class="str">"  ğŸ“¦ ë°”ì´ë„ˆë¦¬ ë°ì´í„°"</span>)
            receivedMessages.append(<span class="str">"\(peerID.displayName): [ë°ì´í„°]"</span>)
        }
    }

    <span class="comment">// íŒŒì¼ ìˆ˜ì‹  ì‹œì‘</span>
    <span class="kw">func</span> session(
        <span class="kw">_</span> session: <span class="type">MCSession</span>,
        didStartReceivingResourceWithName resourceName: <span class="type">String</span>,
        fromPeer peerID: <span class="type">MCPeerID</span>,
        with progress: <span class="type">Progress</span>
    ) {
        print(<span class="str">"ğŸ“¥ íŒŒì¼ ìˆ˜ì‹  ì‹œì‘: \(resourceName) from \(peerID.displayName)"</span>)
        print(<span class="str">"  ì§„í–‰ë¥ : \(progress.fractionCompleted * 100)%"</span>)
    }

    <span class="comment">// íŒŒì¼ ìˆ˜ì‹  ì™„ë£Œ</span>
    <span class="kw">func</span> session(
        <span class="kw">_</span> session: <span class="type">MCSession</span>,
        didFinishReceivingResourceWithName resourceName: <span class="type">String</span>,
        fromPeer peerID: <span class="type">MCPeerID</span>,
        at localURL: <span class="type">URL</span>?,
        withError error: <span class="type">Error</span>?
    ) {
        <span class="kw">if</span> <span class="kw">let</span> error = error {
            print(<span class="str">"âŒ íŒŒì¼ ìˆ˜ì‹  ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
            <span class="kw">return</span>
        }

        <span class="kw">guard</span> <span class="kw">let</span> localURL = localURL <span class="kw">else</span> { <span class="kw">return</span> }

        print(<span class="str">"âœ… íŒŒì¼ ìˆ˜ì‹  ì™„ë£Œ: \(resourceName)"</span>)
        print(<span class="str">"  ê²½ë¡œ: \(localURL.path)"</span>)

        receivedMessages.append(<span class="str">"\(peerID.displayName): [íŒŒì¼] \(resourceName)"</span>)

        <span class="comment">// íŒŒì¼ì„ Documents í´ë”ë¡œ ë³µì‚¬</span>
        <span class="kw">do</span> {
            <span class="kw">let</span> documentsURL = <span class="type">FileManager</span>.default
                .urls(for: .documentDirectory, in: .userDomainMask)[<span class="str">0</span>]
            <span class="kw">let</span> destinationURL = documentsURL.appendingPathComponent(resourceName)

            <span class="comment">// ê¸°ì¡´ íŒŒì¼ ì‚­ì œ</span>
            <span class="kw">if</span> <span class="type">FileManager</span>.default.fileExists(atPath: destinationURL.path) {
                <span class="kw">try</span> <span class="type">FileManager</span>.default.removeItem(at: destinationURL)
            }

            <span class="kw">try</span> <span class="type">FileManager</span>.default.copyItem(at: localURL, to: destinationURL)
            print(<span class="str">"  ğŸ“ íŒŒì¼ ì €ì¥: \(destinationURL.path)"</span>)
        } <span class="kw">catch</span> {
            print(<span class="str">"âŒ íŒŒì¼ ì €ì¥ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
        }
    }

    <span class="comment">// ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ </span>
    <span class="kw">func</span> session(
        <span class="kw">_</span> session: <span class="type">MCSession</span>,
        didReceive stream: <span class="type">InputStream</span>,
        withName streamName: <span class="type">String</span>,
        fromPeer peerID: <span class="type">MCPeerID</span>
    ) {
        print(<span class="str">"ğŸ“¡ ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ : \(streamName) from \(peerID.displayName)"</span>)
        <span class="comment">// ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ë¡œì§ êµ¬í˜„</span>
    }
}</pre>
</div>

<h2>ğŸ” 4. Browser & Advertiser Delegates</h2>
<p>Peer ê²€ìƒ‰ê³¼ ì´ˆëŒ€ ìˆ˜ë½ handling.</p>

<div class="code-block">
<div class="code-header">MultipeerManager+ServiceDelegate.swift â€” Service Delegate</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">MultipeerConnectivity</span>

<span class="comment">// Browser Delegate</span>
<span class="kw">extension</span> <span class="type">MultipeerManager</span>: <span class="type">MCNearbyServiceBrowserDelegate</span> {
    <span class="comment">// Peer ë°œê²¬</span>
    <span class="kw">func</span> browser(
        <span class="kw">_</span> browser: <span class="type">MCNearbyServiceBrowser</span>,
        foundPeer peerID: <span class="type">MCPeerID</span>,
        withDiscoveryInfo info: [<span class="type">String</span>: <span class="type">String</span>]?
    ) {
        print(<span class="str">"ğŸ” Peer ë°œê²¬: \(peerID.displayName)"</span>)

        <span class="kw">if</span> <span class="kw">let</span> info = info {
            print(<span class="str">"  Discovery Info: \(info)"</span>)
        }

        <span class="kw">if</span> !availablePeers.contains(peerID) {
            availablePeers.append(peerID)
        }
    }

    <span class="comment">// Peer ì‚¬ë¼ì§</span>
    <span class="kw">func</span> browser(<span class="kw">_</span> browser: <span class="type">MCNearbyServiceBrowser</span>, lostPeer peerID: <span class="type">MCPeerID</span>) {
        print(<span class="str">"âŒ Peer ì‚¬ë¼ì§: \(peerID.displayName)"</span>)
        availablePeers.removeAll { $0 == peerID }
    }

    <span class="comment">// Browser ì—ëŸ¬</span>
    <span class="kw">func</span> browser(<span class="kw">_</span> browser: <span class="type">MCNearbyServiceBrowser</span>, didNotStartBrowsingForPeers error: <span class="type">Error</span>) {
        print(<span class="str">"âŒ Browsing ì‹œì‘ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
    }
}

<span class="comment">// Advertiser Delegate</span>
<span class="kw">extension</span> <span class="type">MultipeerManager</span>: <span class="type">MCNearbyServiceAdvertiserDelegate</span> {
    <span class="comment">// ì´ˆëŒ€ ìˆ˜ì‹ </span>
    <span class="kw">func</span> advertiser(
        <span class="kw">_</span> advertiser: <span class="type">MCNearbyServiceAdvertiser</span>,
        didReceiveInvitationFromPeer peerID: <span class="type">MCPeerID</span>,
        withContext context: <span class="type">Data</span>?,
        invitationHandler: <span class="kw">@escaping</span> (<span class="type">Bool</span>, <span class="type">MCSession</span>?) -> <span class="type">Void</span>
    ) {
        print(<span class="str">"âœ‰ï¸ ì´ˆëŒ€ ìˆ˜ì‹ : \(peerID.displayName)"</span>)

        <span class="comment">// ìë™ ìˆ˜ë½</span>
        invitationHandler(<span class="kw">true</span>, session)

        <span class="comment">// ë˜ëŠ” ì‚¬ìš©ìì—ê²Œ í™•ì¸ (ì‹¤ì œ ì•±ì—ì„œëŠ” UIë¡œ ì²˜ë¦¬)</span>
        <span class="comment">// invitationHandler(false, nil) // ê±°ì ˆ</span>
    }

    <span class="comment">// Advertiser ì—ëŸ¬</span>
    <span class="kw">func</span> advertiser(<span class="kw">_</span> advertiser: <span class="type">MCNearbyServiceAdvertiser</span>, didNotStartAdvertisingPeer error: <span class="type">Error</span>) {
        print(<span class="str">"âŒ Advertising ì‹œì‘ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
    }
}</pre>
</div>

<h2>ğŸ“± 5. SwiftUI Integration</h2>
<p>P2P ì±„íŒ… ì•± UI implementation.</p>

<div class="code-block">
<div class="code-header">MultipeerChatView.swift â€” P2P Chat UI</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>

<span class="kw">struct</span> <span class="type">MultipeerChatView</span>: <span class="type">View</span> {
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> multipeerManager = <span class="type">MultipeerManager</span>()
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> messageText = <span class="str">""</span>
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> showingPeerList = <span class="kw">false</span>

    <span class="kw">var</span> body: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">NavigationStack</span> {
            <span class="type">VStack</span>(spacing: <span class="str">0</span>) {
                <span class="comment">// ì—°ê²° ìƒíƒœ</span>
                connectionStatus

                <span class="comment">// ë©”ì‹œì§€ ëª©ë¡</span>
                messageList

                <span class="comment">// ì…ë ¥ ì°½</span>
                messageInput
            }
            .navigationTitle(<span class="str">"P2P ì±„íŒ…"</span>)
            .toolbar {
                <span class="type">ToolbarItem</span>(placement: .topBarTrailing) {
                    <span class="type">Button</span> {
                        showingPeerList = <span class="kw">true</span>
                    } label: {
                        <span class="type">Image</span>(systemName: <span class="str">"person.2"</span>)
                    }
                }
            }
            .sheet(isPresented: $showingPeerList) {
                peerListSheet
            }
            .onAppear {
                multipeerManager.startAdvertising()
                multipeerManager.startBrowsing()
            }
            .onDisappear {
                multipeerManager.stopAdvertising()
                multipeerManager.stopBrowsing()
            }
        }
    }

    <span class="comment">// ì—°ê²° ìƒíƒœ í—¤ë”</span>
    <span class="kw">private</span> <span class="kw">var</span> connectionStatus: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">HStack</span> {
            <span class="type">Circle</span>()
                .fill(multipeerManager.connectedPeers.isEmpty ? <span class="type">Color</span>.red : <span class="type">Color</span>.green)
                .frame(width: <span class="str">12</span>, height: <span class="str">12</span>)

            <span class="kw">if</span> multipeerManager.connectedPeers.isEmpty {
                <span class="type">Text</span>(<span class="str">"ì—°ê²°ëœ ê¸°ê¸° ì—†ìŒ"</span>)
                    .font(.subheadline)
                    .foregroundStyle(.secondary)
            } <span class="kw">else</span> {
                <span class="type">Text</span>(<span class="str">"\(multipeerManager.connectedPeers.count)ê°œ ê¸°ê¸° ì—°ê²°ë¨"</span>)
                    .font(.subheadline)
                    .foregroundStyle(.secondary)
            }

            <span class="type">Spacer</span>()
        }
        .padding()
        .background(<span class="type">Color</span>(.systemGroupedBackground))
    }

    <span class="comment">// ë©”ì‹œì§€ ëª©ë¡</span>
    <span class="kw">private</span> <span class="kw">var</span> messageList: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">ScrollView</span> {
            <span class="type">LazyVStack</span>(alignment: .leading, spacing: <span class="str">12</span>) {
                <span class="type">ForEach</span>(multipeerManager.receivedMessages, id: \.self) { message <span class="kw">in</span>
                    <span class="type">Text</span>(message)
                        .padding(<span class="str">12</span>)
                        .background(<span class="type">Color</span>(.systemGray6))
                        .cornerRadius(<span class="str">12</span>)
                }
            }
            .padding()
        }
    }

    <span class="comment">// ë©”ì‹œì§€ ì…ë ¥</span>
    <span class="kw">private</span> <span class="kw">var</span> messageInput: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">HStack</span> {
            <span class="type">TextField</span>(<span class="str">"ë©”ì‹œì§€ ì…ë ¥..."</span>, text: $messageText)
                .textFieldStyle(.roundedBorder)
                .onSubmit {
                    sendMessage()
                }

            <span class="type">Button</span> {
                sendMessage()
            } label: {
                <span class="type">Image</span>(systemName: <span class="str">"paperplane.fill"</span>)
                    .font(.title3)
            }
            .disabled(messageText.isEmpty || multipeerManager.connectedPeers.isEmpty)
        }
        .padding()
        .background(<span class="type">Color</span>(.systemBackground))
    }

    <span class="comment">// Peer ëª©ë¡ ì‹œíŠ¸</span>
    <span class="kw">private</span> <span class="kw">var</span> peerListSheet: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">NavigationStack</span> {
            <span class="type">List</span> {
                <span class="type">Section</span>(<span class="str">"ì—°ê²°ëœ ê¸°ê¸°"</span>) {
                    <span class="kw">if</span> multipeerManager.connectedPeers.isEmpty {
                        <span class="type">Text</span>(<span class="str">"ì—°ê²°ëœ ê¸°ê¸° ì—†ìŒ"</span>)
                            .foregroundStyle(.secondary)
                    } <span class="kw">else</span> {
                        <span class="type">ForEach</span>(multipeerManager.connectedPeers, id: \.self) { peer <span class="kw">in</span>
                            <span class="type">HStack</span> {
                                <span class="type">Image</span>(systemName: <span class="str">"checkmark.circle.fill"</span>)
                                    .foregroundStyle(.green)
                                <span class="type">Text</span>(peer.displayName)
                            }
                        }
                    }
                }

                <span class="type">Section</span>(<span class="str">"ê·¼ì²˜ ê¸°ê¸°"</span>) {
                    <span class="kw">if</span> multipeerManager.availablePeers.isEmpty {
                        <span class="type">Text</span>(<span class="str">"ê²€ìƒ‰ëœ ê¸°ê¸° ì—†ìŒ"</span>)
                            .foregroundStyle(.secondary)
                    } <span class="kw">else</span> {
                        <span class="type">ForEach</span>(multipeerManager.availablePeers, id: \.self) { peer <span class="kw">in</span>
                            <span class="type">Button</span> {
                                multipeerManager.invitePeer(peer)
                            } label: {
                                <span class="type">HStack</span> {
                                    <span class="type">Image</span>(systemName: <span class="str">"iphone"</span>)
                                    <span class="type">Text</span>(peer.displayName)
                                    <span class="type">Spacer</span>()
                                    <span class="type">Image</span>(systemName: <span class="str">"plus.circle"</span>)
                                }
                            }
                        }
                    }
                }
            }
            .navigationTitle(<span class="str">"ê¸°ê¸° ëª©ë¡"</span>)
            .navigationBarTitleDisplayMode(.inline)
            .toolbar {
                <span class="type">ToolbarItem</span>(placement: .topBarTrailing) {
                    <span class="type">Button</span>(<span class="str">"ë‹«ê¸°"</span>) {
                        showingPeerList = <span class="kw">false</span>
                    }
                }
            }
        }
    }

    <span class="kw">private</span> <span class="kw">func</span> sendMessage() {
        multipeerManager.sendMessage(messageText)
        multipeerManager.receivedMessages.append(<span class="str">"ë‚˜: \(messageText)"</span>)
        messageText = <span class="str">""</span>
    }
}</pre>
</div>

<h2>ğŸ’¡ HIG Guidelines</h2>

<ul>
<li><strong>Permission Settings:</strong> Add NSLocalNetworkUsageDescription, NSBonjourServices to Info.plist</li>
<li><strong>ì„œë¹„ìŠ¤ íƒ€ì…:</strong> 15ì ì´í•˜, ì†Œë¬¸ì/ìˆ«ì/í•˜ì´í”ˆë§Œ ì‚¬ìš©</li>
<li><strong>ì•”í˜¸í™”:</strong> Set encryptionPreference to .required</li>
<li><strong>Battery Efficiency:</strong> Stop advertiser/browser when not in use</li>
<li><strong>ì—°ê²° ì œí•œ:</strong> ìµœëŒ€ 8ëŒ€ê¹Œì§€ë§Œ ì—°ê²° ê°€ëŠ¥</li>
</ul>

<h2>ğŸ¯ Practical Usage</h2>

<ul>
<li><strong>Multiplayer Games:</strong> ë¡œì»¬ ëŒ€ì „ ê²Œì„</li>
<li><strong>File Sharing:</strong> AirDrop ìŠ¤íƒ€ì¼ íŒŒì¼ ì „ì†¡</li>
<li><strong>í˜‘ì—… ì•±:</strong> í™”ì´íŠ¸ë³´ë“œ, ê³µë™ í¸ì§‘</li>
<li><strong>ê·¼ê±°ë¦¬ ì±„íŒ…:</strong> ì¸í„°ë„· ì—†ì´ ì±„íŒ…</li>
<li><strong>IoT Control:</strong> ê·¼ì²˜ Smart home device control</li>
</ul>

<h2>ğŸ“š Learn More</h2>

<ul>
<li><a href="https://developer.apple.com/documentation/multipeerconnectivity">MultipeerConnectivity ê³µì‹ ë¬¸ì„œ</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2013/708/">WWDC: MultipeerConnectivity Session</a></li>
<li><a href="https://developer.apple.com/design/human-interface-guidelines/multipeer-connectivity">HIG: Multipeer Connectivity</a></li>
</ul>

<div class="info-box">
<strong>âš¡ï¸ Performance Tips:</strong> <code>MCSessionSendDataMode.reliable</code> uses packet retransmission for reliability but is slower. For real-time games, <code>.unreliable</code>. Wi-Fi and BLE are automatically selected for optimal transfer.
</div>

<div style="margin-top:48px;padding:24px;background:linear-gradient(135deg,#f5f5f7,#e8e8ed);border-radius:16px;">
  <h2 style="font-size:20px;margin-bottom:12px;">ğŸ“ Apple Official Resources</h2>
  <div style="display:flex;flex-wrap:wrap;gap:12px;">
    <a href="https://developer.apple.com/documentation/multipeerconnectivity" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ“˜ Documentation</a>
    <a href="https://developer.apple.com/videos/all-videos/?q=MultipeerConnectivity" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ¬ WWDC Sessions</a>
  </div>
</div>
</article>
</body></html>
