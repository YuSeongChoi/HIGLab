{"variants":[{"paths":["\/tutorials\/higaccessorysetupkit\/08-firmware-updates"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates","interfaceLanguage":"swift"},"metadata":{"title":"Firmware Updates","role":"project","categoryPathComponent":"Table-of-Contents","category":"Accessory Pairing"},"hierarchy":{"modules":[{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/01-Basics#Getting-Started","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/01-Basics"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Basics"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/02-Core#Implementation","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/02-Core"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Core-Features"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/03-Practice#Completion","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/03-Practice"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Practical-Application"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI#Setting-Up-Discovery-Descriptor","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI#Configuring-Picker-Display-Item","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Discovery-UI"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow#Handling-Session-Events","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow#Pairing-State-Machine","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Pairing-Flow"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State#Real-time-Connection-Monitoring","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State#Reconnection-Logic","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Connection-State-Management"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories#Accessory-Collection-Management","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories#Handling-Concurrent-Connections","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Multiple-Accessories"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates#Version-Check-and-Download","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates#OTA-Update-Transfer","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Firmware-Updates"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling#Error-Type-Classification","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling#User-Friendly-Error-Messages","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Error-Handling"},{"projects":[{"sections":[{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist#Permissions-and-Privacy","kind":"task"},{"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist#Testing-and-Verification","kind":"task"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Production-Checklist"}],"reference":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents","paths":[["doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents","doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/$volume","doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Firmware-Updates"]]},"kind":"project","sections":[{"estimatedTimeInMinutes":35,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Implement secure firmware updates for accessories."},{"type":"text","text":" "},{"type":"text","text":"Learn the process of version checking, downloading, transfer, and verification."}]}],"kind":"hero","chapter":"Firmware Updates","title":"Firmware Updates"},{"kind":"tasks","tasks":[{"title":"Version Check and Download","anchor":"Version-Check-and-Download","stepsSection":[{"caption":[],"code":"08-version-check.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Compare firmware versions and check if an update is needed."}]}],"runtimePreview":null,"media":null},{"caption":[],"code":"08-firmware-download.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Download the firmware file and verify its integrity."}]}],"runtimePreview":null,"media":null}],"contentSection":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Check the current firmware version of the accessory"},{"type":"text","text":" "},{"type":"text","text":"and download the latest version from the server."}]}],"kind":"contentAndMedia","mediaPosition":"trailing"}]},{"title":"OTA Update Transfer","anchor":"OTA-Update-Transfer","stepsSection":[{"caption":[],"code":"08-ota-transfer.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Split firmware data into chunks and transfer."}]}],"runtimePreview":null,"media":null},{"caption":[],"code":"08-update-progress.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Display update progress in the UI."}]}],"runtimePreview":null,"media":null},{"caption":[],"code":"08-post-update.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Handle accessory reboot after update completion."}]}],"runtimePreview":null,"media":null}],"contentSection":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Transfer firmware to the accessory via Bluetooth LE."},{"type":"text","text":" "},{"type":"text","text":"Implement chunk-based transfer and progress display."}]}],"kind":"contentAndMedia","mediaPosition":"trailing"}]}]},{"action":{"overridingTitleInlineContent":[{"type":"text","text":"Get started"}],"type":"reference","overridingTitle":"Get started","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling","isActive":true},"kind":"callToAction","abstract":[{"type":"text","text":"Properly handle various errors that can occur in AccessorySetupKit"},{"type":"text","text":" "},{"type":"text","text":"and guide users appropriately."}],"featuredEyebrow":"Tutorial","title":"Error Handling"}],"schemaVersion":{"major":0,"minor":3,"patch":0},"references":{"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Core-Features":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Core-Features","type":"topic","kind":"article","url":"\/tutorials\/table-of-contents\/core-features","abstract":[],"role":"article","title":"Core Features"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/10-Production-Checklist#Permissions-and-Privacy":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist#Permissions-and-Privacy","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/10-production-checklist#Permissions-and-Privacy","abstract":[{"text":"Verify items that need to be checked before app release.","type":"text"},{"text":" ","type":"text"},{"text":"Review permissions, privacy, performance, and App Store requirements.","type":"text"}],"role":"pseudoSymbol","title":"Permissions and Privacy"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/09-Error-Handling#User-Friendly-Error-Messages":{"url":"\/tutorials\/higaccessorysetupkit\/09-error-handling#User-Friendly-Error-Messages","abstract":[{"text":"Properly handle various errors that can occur in AccessorySetupKit","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"and guide users appropriately."}],"type":"section","kind":"section","title":"User-Friendly Error Messages","role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling#User-Friendly-Error-Messages"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Pairing-Flow":{"kind":"article","title":"Pairing Flow","url":"\/tutorials\/table-of-contents\/pairing-flow","type":"topic","role":"article","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Pairing-Flow","abstract":[]},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/05-Pairing-Flow#Pairing-State-Machine":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow#Pairing-State-Machine","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/05-pairing-flow#Pairing-State-Machine","abstract":[{"type":"text","text":"Implement the complete flow from accessory discovery to pairing completion."},{"type":"text","text":" "},{"type":"text","text":"Learn state management using ASAccessorySession events."}],"role":"pseudoSymbol","title":"Pairing State Machine"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/03-Practice":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/03-Practice","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/03-practice","abstract":[{"type":"text","text":"Apply to a real app."}],"estimatedTime":"20min","title":"Practical Application"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/05-Pairing-Flow":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/05-pairing-flow","abstract":[{"type":"text","text":"Implement the complete flow from accessory discovery to pairing completion."},{"type":"text","text":" "},{"type":"text","text":"Learn state management using ASAccessorySession events."}],"estimatedTime":"30min","title":"Implementing Pairing Flow"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/08-Firmware-Updates#OTA-Update-Transfer":{"url":"\/tutorials\/higaccessorysetupkit\/08-firmware-updates#OTA-Update-Transfer","abstract":[{"text":"Implement secure firmware updates for accessories.","type":"text"},{"text":" ","type":"text"},{"text":"Learn the process of version checking, downloading, transfer, and verification.","type":"text"}],"type":"section","kind":"section","title":"OTA Update Transfer","role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates#OTA-Update-Transfer"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Firmware-Updates":{"role":"article","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Firmware-Updates","url":"\/tutorials\/table-of-contents\/firmware-updates","kind":"article","type":"topic","title":"Firmware Updates","abstract":[]},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/06-Connection-State":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/06-connection-state","abstract":[{"type":"text","text":"Track and manage the connection state of paired accessories in real-time."},{"type":"text","text":" "},{"text":"Implement disconnection, reconnection, and background handling.","type":"text"}],"estimatedTime":"25min","title":"Connection State Management"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents":{"role":"overview","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents","url":"\/tutorials\/table-of-contents","kind":"overview","type":"topic","abstract":[{"type":"text","text":"Learn how to securely connect Bluetooth and Wi-Fi accessories"},{"type":"text","text":" "},{"type":"text","text":"using AccessorySetupKit with the system standard UI."}],"title":"Accessory Pairing"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/08-Firmware-Updates#Version-Check-and-Download":{"role":"pseudoSymbol","type":"section","abstract":[{"type":"text","text":"Implement secure firmware updates for accessories."},{"type":"text","text":" "},{"type":"text","text":"Learn the process of version checking, downloading, transfer, and verification."}],"url":"\/tutorials\/higaccessorysetupkit\/08-firmware-updates#Version-Check-and-Download","title":"Version Check and Download","kind":"section","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates#Version-Check-and-Download"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/09-Error-Handling#Error-Type-Classification":{"role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling#Error-Type-Classification","url":"\/tutorials\/higaccessorysetupkit\/09-error-handling#Error-Type-Classification","kind":"section","type":"section","abstract":[{"type":"text","text":"Properly handle various errors that can occur in AccessorySetupKit"},{"type":"text","text":" "},{"type":"text","text":"and guide users appropriately."}],"title":"Error Type Classification"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Multiple-Accessories":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Multiple-Accessories","type":"topic","kind":"article","url":"\/tutorials\/table-of-contents\/multiple-accessories","abstract":[],"role":"article","title":"Multiple Accessories"},"08-post-update.swift":{"content":["import CoreBluetooth","import os.log","","class PostUpdateHandler {","    private let logger = Logger(subsystem: \"com.app\", category: \"PostUpdate\")","    private var reconnectTimer: Timer?","    private let maxWaitTime: TimeInterval = 60","    ","    \/\/ 업데이트 후 재부팅 처리","    func handleReboot(peripheral: CBPeripheral,","                      centralManager: CBCentralManager) async throws -> CBPeripheral {","        logger.info(\"기기 재부팅 대기 중...\")","        ","        \/\/ 재부팅 명령 전송","        sendRebootCommand(to: peripheral)","        ","        \/\/ 연결 해제 대기","        try await Task.sleep(for: .seconds(2))","        ","        \/\/ 재연결 시도","        return try await waitForReconnection(","            identifier: peripheral.identifier,","            centralManager: centralManager","        )","    }","    ","    private func sendRebootCommand(to peripheral: CBPeripheral) {","        \/\/ 재부팅 명령 전송","    }","    ","    private func waitForReconnection(identifier: UUID,","                                      centralManager: CBCentralManager) async throws -> CBPeripheral {","        try await withCheckedThrowingContinuation { continuation in","            var elapsedTime: TimeInterval = 0","            let checkInterval: TimeInterval = 2","            ","            reconnectTimer = Timer.scheduledTimer(withTimeInterval: checkInterval, repeats: true) { [weak self] timer in","                elapsedTime += checkInterval","                ","                \/\/ 기기 검색","                let peripherals = centralManager.retrievePeripherals(withIdentifiers: [identifier])","                if let peripheral = peripherals.first {","                    timer.invalidate()","                    centralManager.connect(peripheral)","                    continuation.resume(returning: peripheral)","                    return","                }","                ","                \/\/ 타임아웃","                if elapsedTime >= self?.maxWaitTime ?? 60 {","                    timer.invalidate()","                    continuation.resume(throwing: UpdateError.reconnectTimeout)","                }","            }","        }","    }","    ","    \/\/ 버전 확인","    func verifyUpdate(peripheral: CBPeripheral,","                      expectedVersion: FirmwareVersion) async throws {","        \/\/ 기기에서 버전 읽기","        let currentVersion = try await readFirmwareVersion(from: peripheral)","        ","        guard currentVersion >= expectedVersion else {","            throw UpdateError.versionMismatch","        }","        ","        logger.info(\"업데이트 확인 완료: \\(currentVersion)\")","    }","    ","    private func readFirmwareVersion(from peripheral: CBPeripheral) async throws -> FirmwareVersion {","        \/\/ 버전 특성에서 읽기","        FirmwareVersion(1, 2, 0) \/\/ 예시","    }","}","","enum UpdateError: LocalizedError {","    case reconnectTimeout","    case versionMismatch","    ","    var errorDescription: String? {","        switch self {","        case .reconnectTimeout: return \"기기 재연결 시간 초과\"","        case .versionMismatch: return \"펌웨어 버전이 일치하지 않습니다\"","        }","    }","}"],"type":"file","fileName":"PostUpdate.swift","identifier":"08-post-update.swift","syntax":"swift","highlights":[],"fileType":"swift"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Connection-State-Management":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Connection-State-Management","type":"topic","kind":"article","url":"\/tutorials\/table-of-contents\/connection-state-management","abstract":[],"role":"article","title":"Connection State Management"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/03-Practice#Completion":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/03-Practice#Completion","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/03-practice#Completion","abstract":[{"text":"Apply to a real app.","type":"text"}],"role":"pseudoSymbol","title":"Completion"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/08-Firmware-Updates":{"role":"project","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/08-Firmware-Updates","url":"\/tutorials\/higaccessorysetupkit\/08-firmware-updates","kind":"project","estimatedTime":"35min","type":"topic","abstract":[{"text":"Implement secure firmware updates for accessories.","type":"text"},{"text":" ","type":"text"},{"text":"Learn the process of version checking, downloading, transfer, and verification.","type":"text"}],"title":"Firmware Updates"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/07-Multiple-Accessories#Handling-Concurrent-Connections":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories#Handling-Concurrent-Connections","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/07-multiple-accessories#Handling-Concurrent-Connections","abstract":[{"text":"Learn how to manage multiple accessories simultaneously.","type":"text"},{"text":" ","type":"text"},{"text":"Implement accessory list management, grouping, and priority settings.","type":"text"}],"role":"pseudoSymbol","title":"Handling Concurrent Connections"},"08-firmware-download.swift":{"content":["import Foundation","import CryptoKit","","class FirmwareDownloader {","    enum DownloadError: Error {","        case checksumMismatch","        case downloadFailed","        case invalidData","    }","    ","    \/\/ 펌웨어 다운로드 및 검증","    func download(from url: URL, expectedChecksum: String,","                  progress: @escaping (Double) -> Void) async throws -> Data {","        ","        let (asyncBytes, response) = try await URLSession.shared.bytes(from: url)","        ","        guard let httpResponse = response as? HTTPURLResponse,","              httpResponse.statusCode == 200 else {","            throw DownloadError.downloadFailed","        }","        ","        let totalSize = response.expectedContentLength","        var downloadedData = Data()","        var downloadedBytes: Int64 = 0","        ","        for try await byte in asyncBytes {","            downloadedData.append(byte)","            downloadedBytes += 1","            ","            if totalSize > 0 {","                let currentProgress = Double(downloadedBytes) \/ Double(totalSize)","                progress(currentProgress)","            }","        }","        ","        \/\/ SHA256 체크섬 검증","        let checksum = SHA256.hash(data: downloadedData)","            .compactMap { String(format: \"%02x\", $0) }","            .joined()","        ","        guard checksum == expectedChecksum else {","            throw DownloadError.checksumMismatch","        }","        ","        return downloadedData","    }","    ","    \/\/ 로컬 캐시 저장","    func cacheFirmware(_ data: Data, version: FirmwareVersion) throws -> URL {","        let cacheDir = FileManager.default.urls(for: .cachesDirectory, in: .userDomainMask)[0]","        let fileURL = cacheDir.appending(path: \"firmware_\\(version).bin\")","        try data.write(to: fileURL)","        return fileURL","    }","}"],"type":"file","fileName":"FirmwareDownload.swift","identifier":"08-firmware-download.swift","syntax":"swift","highlights":[],"fileType":"swift"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/02-Core":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/02-Core","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/02-core","abstract":[{"text":"Learn the main APIs.","type":"text"}],"estimatedTime":"20min","title":"Core Features"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/02-Core#Implementation":{"role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/02-Core#Implementation","url":"\/tutorials\/higaccessorysetupkit\/02-core#Implementation","kind":"section","type":"section","abstract":[{"type":"text","text":"Learn the main APIs."}],"title":"Implementation"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/01-Basics":{"url":"\/tutorials\/higaccessorysetupkit\/01-basics","abstract":[{"text":"Connect with AccessorySetupKit.","type":"text"}],"type":"topic","kind":"project","title":"AccessorySetupKit Basics","role":"project","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/01-Basics","estimatedTime":"15min"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Error-Handling":{"kind":"article","title":"Error Handling","url":"\/tutorials\/table-of-contents\/error-handling","type":"topic","role":"article","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Error-Handling","abstract":[]},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/04-Discovery-UI":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/04-discovery-ui","abstract":[{"text":"Implement a user-friendly accessory discovery screen using","type":"text"},{"text":" ","type":"text"},{"text":"ASDiscoveryDescriptor and ASPickerDisplayItem.","type":"text"}],"estimatedTime":"25min","title":"Implementing Discovery UI"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Practical-Application":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Practical-Application","type":"topic","role":"article","kind":"article","url":"\/tutorials\/table-of-contents\/practical-application","abstract":[],"title":"Practical Application"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/01-Basics#Getting-Started":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/01-Basics#Getting-Started","type":"section","role":"pseudoSymbol","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/01-basics#Getting-Started","abstract":[{"text":"Connect with AccessorySetupKit.","type":"text"}],"title":"Getting Started"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/07-Multiple-Accessories#Accessory-Collection-Management":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories#Accessory-Collection-Management","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/07-multiple-accessories#Accessory-Collection-Management","abstract":[{"type":"text","text":"Learn how to manage multiple accessories simultaneously."},{"text":" ","type":"text"},{"text":"Implement accessory list management, grouping, and priority settings.","type":"text"}],"role":"pseudoSymbol","title":"Accessory Collection Management"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/10-Production-Checklist":{"url":"\/tutorials\/higaccessorysetupkit\/10-production-checklist","abstract":[{"type":"text","text":"Verify items that need to be checked before app release."},{"text":" ","type":"text"},{"type":"text","text":"Review permissions, privacy, performance, and App Store requirements."}],"type":"topic","kind":"project","title":"Production Checklist","role":"project","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist","estimatedTime":"20min"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/04-Discovery-UI#Configuring-Picker-Display-Item":{"kind":"section","title":"Configuring Picker Display Item","url":"\/tutorials\/higaccessorysetupkit\/04-discovery-ui#Configuring-Picker-Display-Item","type":"section","role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI#Configuring-Picker-Display-Item","abstract":[{"type":"text","text":"Implement a user-friendly accessory discovery screen using"},{"type":"text","text":" "},{"type":"text","text":"ASDiscoveryDescriptor and ASPickerDisplayItem."}]},"08-ota-transfer.swift":{"content":["import CoreBluetooth","import os.log","","class OTAUpdateManager {","    private let peripheral: CBPeripheral","    private let otaCharacteristic: CBCharacteristic","    private let chunkSize = 20 \/\/ BLE MTU 기반","    private let logger = Logger(subsystem: \"com.app\", category: \"OTA\")","    ","    var onProgress: ((Double) -> Void)?","    var onComplete: ((Result<Void, Error>) -> Void)?","    ","    init(peripheral: CBPeripheral, characteristic: CBCharacteristic) {","        self.peripheral = peripheral","        self.otaCharacteristic = characteristic","    }","    ","    \/\/ 펌웨어 전송 시작","    func startUpdate(with firmwareData: Data) async throws {","        logger.info(\"OTA 업데이트 시작: \\(firmwareData.count) bytes\")","        ","        \/\/ 업데이트 시작 명령 전송","        try await sendCommand(.startUpdate(size: firmwareData.count))","        ","        \/\/ 청크 단위로 분할","        let chunks = firmwareData.chunked(into: chunkSize)","        let totalChunks = chunks.count","        ","        for (index, chunk) in chunks.enumerated() {","            try await sendChunk(chunk, index: index)","            ","            let progress = Double(index + 1) \/ Double(totalChunks)","            onProgress?(progress)","            ","            \/\/ 전송 속도 조절","            try await Task.sleep(for: .milliseconds(50))","        }","        ","        \/\/ 전송 완료 명령","        try await sendCommand(.finishUpdate)","        logger.info(\"OTA 전송 완료\")","    }","    ","    private func sendChunk(_ data: Data, index: Int) async throws {","        var packet = Data()","        packet.append(UInt8(index & 0xFF))","        packet.append(UInt8((index >> 8) & 0xFF))","        packet.append(data)","        ","        peripheral.writeValue(packet, for: otaCharacteristic, type: .withResponse)","        \/\/ 응답 대기는 delegate에서 처리","    }","    ","    private func sendCommand(_ command: OTACommand) async throws {","        peripheral.writeValue(command.data, for: otaCharacteristic, type: .withResponse)","    }","}","","enum OTACommand {","    case startUpdate(size: Int)","    case finishUpdate","    case reboot","    ","    var data: Data {","        switch self {","        case .startUpdate(let size):","            var d = Data([0x01])","            d.append(contentsOf: withUnsafeBytes(of: UInt32(size)) { Array($0) })","            return d","        case .finishUpdate:","            return Data([0x02])","        case .reboot:","            return Data([0x03])","        }","    }","}","","extension Data {","    func chunked(into size: Int) -> [Data] {","        stride(from: 0, to: count, by: size).map {","            self[$0 ..< Swift.min($0 + size, count)]","        }","    }","}"],"type":"file","fileName":"OTATransfer.swift","identifier":"08-ota-transfer.swift","syntax":"swift","highlights":[],"fileType":"swift"},"08-version-check.swift":{"content":["import Foundation","","struct FirmwareVersion: Comparable, CustomStringConvertible {","    let major: Int","    let minor: Int","    let patch: Int","    ","    var description: String {","        \"\\(major).\\(minor).\\(patch)\"","    }","    ","    static func < (lhs: FirmwareVersion, rhs: FirmwareVersion) -> Bool {","        if lhs.major != rhs.major { return lhs.major < rhs.major }","        if lhs.minor != rhs.minor { return lhs.minor < rhs.minor }","        return lhs.patch < rhs.patch","    }","    ","    init(_ major: Int, _ minor: Int, _ patch: Int) {","        self.major = major","        self.minor = minor","        self.patch = patch","    }","    ","    init?(string: String) {","        let parts = string.split(separator: \".\").compactMap { Int($0) }","        guard parts.count == 3 else { return nil }","        self.major = parts[0]","        self.minor = parts[1]","        self.patch = parts[2]","    }","}","","class FirmwareChecker {","    private let serverURL: URL","    ","    init(serverURL: URL) {","        self.serverURL = serverURL","    }","    ","    \/\/ 서버에서 최신 버전 확인","    func checkLatestVersion(for deviceModel: String) async throws -> FirmwareInfo {","        let url = serverURL.appending(path: \"firmware\/\\(deviceModel)\/latest\")","        let (data, _) = try await URLSession.shared.data(from: url)","        return try JSONDecoder().decode(FirmwareInfo.self, from: data)","    }","    ","    \/\/ 업데이트 필요 여부 확인","    func needsUpdate(current: FirmwareVersion, latest: FirmwareVersion) -> Bool {","        current < latest","    }","}","","struct FirmwareInfo: Codable {","    let version: String","    let downloadURL: URL","    let checksum: String","    let releaseNotes: String","    let minOSVersion: String","}"],"type":"file","fileName":"VersionCheck.swift","identifier":"08-version-check.swift","syntax":"swift","highlights":[],"fileType":"swift"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Discovery-UI":{"url":"\/tutorials\/table-of-contents\/discovery-ui","abstract":[],"type":"topic","kind":"article","title":"Discovery UI","role":"article","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Discovery-UI"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/09-Error-Handling":{"url":"\/tutorials\/higaccessorysetupkit\/09-error-handling","abstract":[{"type":"text","text":"Properly handle various errors that can occur in AccessorySetupKit"},{"type":"text","text":" "},{"type":"text","text":"and guide users appropriately."}],"type":"topic","kind":"project","title":"Error Handling","role":"project","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/09-Error-Handling","estimatedTime":"25min"},"08-update-progress.swift":{"content":["import SwiftUI","","struct FirmwareUpdateView: View {","    @State private var updateState: UpdateState = .idle","    @State private var progress: Double = 0","    let firmwareInfo: FirmwareInfo","    ","    enum UpdateState {","        case idle","        case downloading","        case transferring","        case rebooting","        case complete","        case failed(String)","    }","    ","    var body: some View {","        VStack(spacing: 24) {","            \/\/ 상태 아이콘","            stateIcon","                .font(.system(size: 60))","                .foregroundStyle(stateColor)","            ","            \/\/ 상태 텍스트","            Text(stateTitle)","                .font(.title2.bold())","            ","            Text(stateDescription)","                .font(.subheadline)","                .foregroundStyle(.secondary)","                .multilineTextAlignment(.center)","            ","            \/\/ 진행률 바","            if showProgress {","                VStack(spacing: 8) {","                    ProgressView(value: progress)","                        .progressViewStyle(.linear)","                    ","                    Text(\"\\(Int(progress * 100))%\")","                        .font(.caption)","                        .monospacedDigit()","                }","                .padding(.horizontal)","            }","            ","            \/\/ 액션 버튼","            if case .idle = updateState {","                Button(\"업데이트 시작\") {","                    startUpdate()","                }","                .buttonStyle(.borderedProminent)","            }","        }","        .padding()","    }","    ","    private var stateIcon: Image {","        switch updateState {","        case .idle: return Image(systemName: \"arrow.down.circle\")","        case .downloading, .transferring: return Image(systemName: \"arrow.triangle.2.circlepath\")","        case .rebooting: return Image(systemName: \"restart.circle\")","        case .complete: return Image(systemName: \"checkmark.circle.fill\")","        case .failed: return Image(systemName: \"exclamationmark.triangle.fill\")","        }","    }","    ","    private var stateColor: Color {","        switch updateState {","        case .complete: return .green","        case .failed: return .red","        default: return .blue","        }","    }","    ","    private var stateTitle: String {","        switch updateState {","        case .idle: return \"업데이트 준비됨\"","        case .downloading: return \"다운로드 중...\"","        case .transferring: return \"전송 중...\"","        case .rebooting: return \"재시작 중...\"","        case .complete: return \"업데이트 완료\"","        case .failed(let error): return \"업데이트 실패\"","        }","    }","    ","    private var stateDescription: String {","        switch updateState {","        case .idle: return \"버전 \\(firmwareInfo.version)으로 업데이트합니다.\"","        case .downloading: return \"펌웨어를 다운로드하고 있습니다.\"","        case .transferring: return \"기기로 전송 중입니다. 전원을 끄지 마세요.\"","        case .rebooting: return \"기기가 재시작됩니다.\"","        case .complete: return \"기기가 최신 상태입니다.\"","        case .failed(let error): return error","        }","    }","    ","    private var showProgress: Bool {","        switch updateState {","        case .downloading, .transferring: return true","        default: return false","        }","    }","    ","    private func startUpdate() {","        \/\/ 업데이트 로직 시작","    }","}"],"type":"file","fileName":"UpdateProgress.swift","identifier":"08-update-progress.swift","syntax":"swift","highlights":[],"fileType":"swift"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/06-Connection-State#Real-time-Connection-Monitoring":{"role":"pseudoSymbol","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State#Real-time-Connection-Monitoring","url":"\/tutorials\/higaccessorysetupkit\/06-connection-state#Real-time-Connection-Monitoring","kind":"section","type":"section","abstract":[{"type":"text","text":"Track and manage the connection state of paired accessories in real-time."},{"type":"text","text":" "},{"type":"text","text":"Implement disconnection, reconnection, and background handling."}],"title":"Real-time Connection Monitoring"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/06-Connection-State#Reconnection-Logic":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/06-Connection-State#Reconnection-Logic","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/06-connection-state#Reconnection-Logic","abstract":[{"type":"text","text":"Track and manage the connection state of paired accessories in real-time."},{"type":"text","text":" "},{"type":"text","text":"Implement disconnection, reconnection, and background handling."}],"role":"pseudoSymbol","title":"Reconnection Logic"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/07-Multiple-Accessories":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/07-Multiple-Accessories","type":"topic","role":"project","kind":"project","url":"\/tutorials\/higaccessorysetupkit\/07-multiple-accessories","abstract":[{"text":"Learn how to manage multiple accessories simultaneously.","type":"text"},{"type":"text","text":" "},{"type":"text","text":"Implement accessory list management, grouping, and priority settings."}],"estimatedTime":"30min","title":"Managing Multiple Accessories"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Basics":{"url":"\/tutorials\/table-of-contents\/basics","abstract":[],"type":"topic","kind":"article","title":"Basics","role":"article","identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Basics"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/04-Discovery-UI#Setting-Up-Discovery-Descriptor":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/04-Discovery-UI#Setting-Up-Discovery-Descriptor","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/04-discovery-ui#Setting-Up-Discovery-Descriptor","abstract":[{"type":"text","text":"Implement a user-friendly accessory discovery screen using"},{"type":"text","text":" "},{"type":"text","text":"ASDiscoveryDescriptor and ASPickerDisplayItem."}],"role":"pseudoSymbol","title":"Setting Up Discovery Descriptor"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/Table-of-Contents/Production-Checklist":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/Table-of-Contents\/Production-Checklist","type":"topic","kind":"article","url":"\/tutorials\/table-of-contents\/production-checklist","abstract":[],"role":"article","title":"Production Checklist"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/05-Pairing-Flow#Handling-Session-Events":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/05-Pairing-Flow#Handling-Session-Events","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/05-pairing-flow#Handling-Session-Events","abstract":[{"type":"text","text":"Implement the complete flow from accessory discovery to pairing completion."},{"type":"text","text":" "},{"type":"text","text":"Learn state management using ASAccessorySession events."}],"role":"pseudoSymbol","title":"Handling Session Events"},"doc://accessorysetupkit.HIGAccessorySetupKit/tutorials/HIGAccessorySetupKit/10-Production-Checklist#Testing-and-Verification":{"identifier":"doc:\/\/accessorysetupkit.HIGAccessorySetupKit\/tutorials\/HIGAccessorySetupKit\/10-Production-Checklist#Testing-and-Verification","type":"section","kind":"section","url":"\/tutorials\/higaccessorysetupkit\/10-production-checklist#Testing-and-Verification","abstract":[{"text":"Verify items that need to be checked before app release.","type":"text"},{"text":" ","type":"text"},{"text":"Review permissions, privacy, performance, and App Store requirements.","type":"text"}],"role":"pseudoSymbol","title":"Testing and Verification"}}}