{"kind":"project","schemaVersion":{"minor":3,"major":0,"patch":0},"sections":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Implement all subscription management features needed for a real service,","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"including subscription renewal, upgrades\/downgrades, cancellation, and restoration."}]}],"kind":"hero","title":"Advanced Subscription Management","chapter":"Ring 7: Advanced Subscription Management","estimatedTimeInMinutes":25},{"tasks":[{"stepsSection":[{"code":"07-subscription-manager.swift","type":"step","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Implement a SubscriptionManager that defines and manages subscription groups."}]}],"media":null,"runtimePreview":null,"caption":[]},{"code":"07-subscription-info.swift","runtimePreview":null,"content":[{"inlineContent":[{"type":"text","text":"Check current active subscription and expiration information."}],"type":"paragraph"}],"caption":[],"type":"step","media":null}],"anchor":"Subscription-Groups-and-Levels","title":"Subscription Groups and Levels","contentSection":[{"kind":"contentAndMedia","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Learn how to effectively manage subscription groups and service levels"},{"type":"text","text":" "},{"type":"text","text":"configured in App Store Connect from your code."}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Subscription Group: A collection of mutually exclusive subscription options","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Service Level: Priority for upgrades\/downgrades","type":"text"}],"type":"paragraph"}]}]}],"mediaPosition":"trailing"}]},{"stepsSection":[{"runtimePreview":null,"type":"step","content":[{"inlineContent":[{"type":"text","text":"Implement the subscription change UI."}],"type":"paragraph"}],"media":null,"caption":[],"code":"07-subscription-change.swift"},{"runtimePreview":null,"type":"step","content":[{"inlineContent":[{"text":"Add an upgrade confirmation dialog.","type":"text"}],"type":"paragraph"}],"media":null,"caption":[],"code":"07-upgrade-confirm.swift"}],"anchor":"Subscription-Upgrades-Downgrades","title":"Subscription Upgrades & Downgrades","contentSection":[{"content":[{"inlineContent":[{"type":"text","text":"When users change plans, StoreKit 2 automatically"},{"type":"text","text":" "},{"type":"text","text":"handles proration."}],"type":"paragraph"},{"inlineContent":[{"text":"HIG Guidelines:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Provide clear cost information when changing","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Offer options for immediate vs. next renewal application"}],"type":"paragraph"}]}]}],"kind":"contentAndMedia","mediaPosition":"trailing"}]},{"stepsSection":[{"caption":[],"content":[{"inlineContent":[{"type":"text","text":"Implement a view that displays renewal status and expiration information."}],"type":"paragraph"}],"type":"step","runtimePreview":null,"media":null,"code":"07-renewal-status.swift"}],"anchor":"Subscription-Renewal-Status","title":"Subscription Renewal Status","contentSection":[{"kind":"contentAndMedia","content":[{"inlineContent":[{"text":"Track subscription auto-renewal status and expiration timing","type":"text"},{"type":"text","text":" "},{"type":"text","text":"to display appropriate retention messages to users."}],"type":"paragraph"}],"mediaPosition":"trailing"}]}],"kind":"tasks"},{"anchor":"Check-Your-Understanding","assessments":[{"choices":[{"isCorrect":false,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Both subscriptions become active simultaneously."}]}],"justification":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Plans within the same subscription group are mutually exclusive."}]}]},{"isCorrect":true,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The existing subscription is replaced with the new subscription."}]}],"justification":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Only one subscription can be active within a subscription group."},{"type":"text","text":" "},{"type":"text","text":"Upgrades apply immediately, while downgrades apply at the next renewal."}]}]},{"isCorrect":false,"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The change is rejected."}]}],"justification":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Users can change to a different plan within a subscription group at any time."}]}]}],"title":[{"inlineContent":[{"type":"text","text":"What happens when a user changes to a different plan within a subscription group?"}],"type":"paragraph"}],"type":"multiple-choice","content":[]},{"choices":[{"content":[{"inlineContent":[{"type":"text","text":"Check Transaction.currentEntitlements"}],"type":"paragraph"}],"isCorrect":false,"justification":[{"inlineContent":[{"type":"text","text":"currentEntitlements shows current entitlements but not renewal intent."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Check Product.SubscriptionInfo.RenewalState","type":"text"}]}],"isCorrect":true,"justification":[{"type":"paragraph","inlineContent":[{"type":"text","text":"RenewalState lets you check states like .willRenew, .expired, .revoked, etc."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Can only be checked in App Store Connect"}],"type":"paragraph"}],"isCorrect":false,"justification":[{"type":"paragraph","inlineContent":[{"type":"text","text":"StoreKit 2 API allows you to check renewal status directly within the app."}]}]}],"title":[{"inlineContent":[{"type":"text","text":"How do you check if subscription auto-renewal has been turned off?"}],"type":"paragraph"}],"type":"multiple-choice","content":[]}],"kind":"assessments"},{"title":"Supporting Family Sharing","abstract":[{"type":"text","text":"Enable up to 6 family members to use the app"},{"type":"text","text":" "},{"type":"text","text":"with a single subscription through Family Sharing."}],"action":{"type":"reference","overridingTitle":"Get started","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing","overridingTitleInlineContent":[{"type":"text","text":"Get started"}],"isActive":true},"featuredEyebrow":"Tutorial","kind":"callToAction"}],"hierarchy":{"modules":[{"projects":[{"sections":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/01-Understanding-StoreKit#What-is-StoreKit-2","kind":"task"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/01-Understanding-StoreKit"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-1:-Understanding-StoreKit-2"},{"projects":[{"sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/02-Loading-Products#Loading-Products"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/02-Loading-Products"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-2:-Loading-Products"},{"projects":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/03-Purchase-Flow","sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/03-Purchase-Flow#Purchase-Handling"}]}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-3:-Purchase-Flow"},{"projects":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/04-Subscription-Status","sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/04-Subscription-Status#Checking-Subscription-Status"}]}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-4:-Subscription-Management"},{"projects":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/05-Paywall-UI","sections":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/05-Paywall-UI#Paywall-Design","kind":"task"}]}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-5:-Paywall-UI"},{"projects":[{"sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Groups-and-Levels"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Upgrades-Downgrades","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Renewal-Status","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Check-Your-Understanding","kind":"assessment"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-7:-Advanced-Subscription-Management"},{"projects":[{"sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Understanding-Family-Sharing"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#UI-Branching-by-Ownership-Type","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Handling-Family-Sharing-Cancellation","kind":"task"},{"kind":"assessment","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Check-Your-Understanding"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-8:-Family-Sharing"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-9:-App-Store-Server-API","projects":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore","sections":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Server-API-Overview","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Server-Notifications-V2","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#JWS-Verification","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Check-Your-Understanding","kind":"assessment"}]}]},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-10:-Subscription-Discount-Offers","projects":[{"sections":[{"kind":"task","reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Introductory-Offers"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Promotional-Offers","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Offer-Codes","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Offer-Strategy-HIG-Guidelines","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Check-Your-Understanding","kind":"assessment"}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers"}]},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-11:-StoreKit-Testing","projects":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing","sections":[{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#StoreKit-Configuration-File","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Writing-Unit-Tests","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Sandbox-Testing","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Error-Scenario-Testing","kind":"task"},{"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Check-Your-Understanding","kind":"assessment"}]}]}],"reference":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents","paths":[["doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents","doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/$volume","doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-7:-Advanced-Subscription-Management"]]},"identifier":{"url":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions","interfaceLanguage":"swift"},"metadata":{"categoryPathComponent":"Table-of-Contents","category":"Building a Subscription App","role":"project","title":"Advanced Subscription Management"},"variants":[{"paths":["\/tutorials\/higstorekit\/07-subscriptions"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/08-FamilySharing#UI-Branching-by-Ownership-Type":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#UI-Branching-by-Ownership-Type","title":"UI Branching by Ownership Type","kind":"section","abstract":[{"text":"Enable up to 6 family members to use the app","type":"text"},{"type":"text","text":" "},{"type":"text","text":"with a single subscription through Family Sharing."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/08-familysharing#UI-Branching-by-Ownership-Type","type":"section"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-8:-Family-Sharing":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-8:-Family-Sharing","title":"Ring 8: Family Sharing","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-8:-family-sharing","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/07-Subscriptions#Subscription-Upgrades-Downgrades":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Upgrades-Downgrades","title":"Subscription Upgrades & Downgrades","kind":"section","abstract":[{"type":"text","text":"Implement all subscription management features needed for a real service,"},{"type":"text","text":" "},{"type":"text","text":"including subscription renewal, upgrades\/downgrades, cancellation, and restoration."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/07-subscriptions#Subscription-Upgrades-Downgrades","type":"section"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-3:-Purchase-Flow":{"type":"topic","kind":"article","title":"Ring 3: Purchase Flow","role":"article","url":"\/tutorials\/table-of-contents\/ring-3:-purchase-flow","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-3:-Purchase-Flow","abstract":[]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/01-Understanding-StoreKit#What-is-StoreKit-2":{"type":"section","kind":"section","title":"What is StoreKit 2?","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/01-understanding-storekit#What-is-StoreKit-2","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/01-Understanding-StoreKit#What-is-StoreKit-2","abstract":[{"type":"text","text":"Learn the core concepts of StoreKit 2 and HIG in-app purchase guidelines."}]},"07-subscription-info.swift":{"fileName":"SubscriptionManager.swift","fileType":"swift","identifier":"07-subscription-info.swift","content":["import StoreKit","","extension SubscriptionManager {","    ","    \/\/\/ 현재 활성 구독 정보 로드","    func loadActiveSubscription() async {","        \/\/ 현재 유효한 권한 확인","        for await result in Transaction.currentEntitlements {","            guard case .verified(let transaction) = result else { continue }","            ","            \/\/ 구독 상품인 경우만 처리","            if transaction.productType == .autoRenewable {","                self.activeTransaction = transaction","                await loadSubscriptionInfo(for: transaction.productID)","                return","            }","        }","        ","        \/\/ 활성 구독 없음","        self.activeTransaction = nil","        self.currentSubscription = nil","    }","    ","    \/\/\/ 구독 상세 정보 로드","    private func loadSubscriptionInfo(for productID: String) async {","        guard let product = try? await Product.products(for: [productID]).first,","              let subscriptionInfo = product.subscription else {","            return","        }","        ","        self.currentSubscription = subscriptionInfo","    }","    ","    \/\/\/ 구독 만료 예정일","    var expirationDate: Date? {","        activeTransaction?.expirationDate","    }","    ","    \/\/\/ 다음 갱신까지 남은 일수","    var daysUntilRenewal: Int? {","        guard let expiration = expirationDate else { return nil }","        let days = Calendar.current.dateComponents([.day], from: Date(), to: expiration).day","        return max(0, days ?? 0)","    }","}"],"syntax":"swift","highlights":[{"line":3},{"line":5},{"line":6},{"line":7},{"line":8},{"line":9},{"line":10},{"line":11},{"line":12},{"line":13},{"line":14},{"line":15},{"line":16},{"line":18},{"line":19},{"line":20},{"line":21},{"line":24},{"line":25},{"line":26},{"line":27},{"line":28},{"line":30},{"line":31},{"line":34},{"line":35},{"line":36},{"line":38},{"line":39},{"line":40},{"line":41},{"line":42},{"line":43},{"line":44}],"type":"file"},"07-subscription-change.swift":{"fileName":"SubscriptionChangeView.swift","fileType":"swift","identifier":"07-subscription-change.swift","content":["import SwiftUI","import StoreKit","","\/\/\/ 구독 변경 UI","struct SubscriptionChangeView: View {","    @EnvironmentObject var subscriptionManager: SubscriptionManager","    @State private var availablePlans: [Product] = []","    @State private var selectedProduct: Product?","    @State private var showUpgradeConfirm = false","    ","    var body: some View {","        List {","            Section(\"현재 플랜\") {","                if let transaction = subscriptionManager.activeTransaction {","                    CurrentPlanRow(transaction: transaction)","                }","            }","            ","            Section(\"다른 플랜으로 변경\") {","                ForEach(availablePlans, id: \\.id) { product in","                    PlanRow(","                        product: product,","                        isCurrentPlan: isCurrentPlan(product),","                        onSelect: { selectPlan(product) }","                    )","                }","            }","        }","        .navigationTitle(\"플랜 변경\")","        .sheet(isPresented: $showUpgradeConfirm) {","            if let product = selectedProduct {","                UpgradeConfirmView(product: product)","            }","        }","        .task {","            await loadAvailablePlans()","        }","    }","    ","    private func isCurrentPlan(_ product: Product) -> Bool {","        subscriptionManager.activeTransaction?.productID == product.id","    }","    ","    private func selectPlan(_ product: Product) {","        selectedProduct = product","        showUpgradeConfirm = true","    }","    ","    private func loadAvailablePlans() async {","        let productIDs = [","            \"com.example.basic.monthly\",","            \"com.example.premium.monthly\",","            \"com.example.ultimate.monthly\"","        ]","        availablePlans = (try? await Product.products(for: productIDs)) ?? []","    }","}"],"syntax":"swift","highlights":[],"type":"file"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/09-AppStore#Check-Your-Understanding":{"titleInlineContent":[{"type":"text","text":"Check Your Understanding"}],"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Check-Your-Understanding","type":"link","title":"Check Your Understanding","url":"\/tutorials\/higstorekit\/09-appstore#Check-Your-Understanding"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/08-FamilySharing#Check-Your-Understanding":{"type":"link","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Check-Your-Understanding","url":"\/tutorials\/higstorekit\/08-familysharing#Check-Your-Understanding","title":"Check Your Understanding","titleInlineContent":[{"text":"Check Your Understanding","type":"text"}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/08-FamilySharing#Handling-Family-Sharing-Cancellation":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Handling-Family-Sharing-Cancellation","title":"Handling Family Sharing Cancellation","kind":"section","abstract":[{"text":"Enable up to 6 family members to use the app","type":"text"},{"type":"text","text":" "},{"type":"text","text":"with a single subscription through Family Sharing."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/08-familysharing#Handling-Family-Sharing-Cancellation","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers#Promotional-Offers":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Promotional-Offers","title":"Promotional Offers","kind":"section","abstract":[{"type":"text","text":"Implement new user acquisition and churn prevention strategies"},{"type":"text","text":" "},{"type":"text","text":"using Introductory Offers, Promotional Offers, and Offer Codes."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/10-subscription-offers#Promotional-Offers","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/05-Paywall-UI":{"type":"topic","kind":"project","title":"HIG-Compliant Paywall UI","role":"project","estimatedTime":"20min","url":"\/tutorials\/higstorekit\/05-paywall-ui","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/05-Paywall-UI","abstract":[{"type":"text","text":"Design a paywall screen that follows Apple HIG guidelines."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing":{"type":"topic","kind":"project","title":"StoreKit Testing","role":"project","estimatedTime":"25min","url":"\/tutorials\/higstorekit\/11-testing","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing","abstract":[{"text":"Thoroughly test in-app purchase functionality using","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"Xcode’s StoreKit Testing and Sandbox environment."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers","title":"Subscription Discount Offers","kind":"project","abstract":[{"text":"Implement new user acquisition and churn prevention strategies","type":"text"},{"type":"text","text":" "},{"text":"using Introductory Offers, Promotional Offers, and Offer Codes.","type":"text"}],"role":"project","url":"\/tutorials\/higstorekit\/10-subscription-offers","estimatedTime":"30min","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing#Error-Scenario-Testing":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Error-Scenario-Testing","title":"Error Scenario Testing","kind":"section","abstract":[{"text":"Thoroughly test in-app purchase functionality using","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"Xcode’s StoreKit Testing and Sandbox environment."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/11-testing#Error-Scenario-Testing","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/08-FamilySharing":{"type":"topic","kind":"project","title":"Supporting Family Sharing","role":"project","estimatedTime":"20min","url":"\/tutorials\/higstorekit\/08-familysharing","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing","abstract":[{"type":"text","text":"Enable up to 6 family members to use the app"},{"type":"text","text":" "},{"type":"text","text":"with a single subscription through Family Sharing."}]},"07-renewal-status.swift":{"fileName":"RenewalStatusView.swift","fileType":"swift","identifier":"07-renewal-status.swift","content":["import SwiftUI","import StoreKit","","\/\/\/ 구독 갱신 상태 뷰","struct RenewalStatusView: View {","    @EnvironmentObject var subscriptionManager: SubscriptionManager","    @State private var renewalState: Product.SubscriptionInfo.RenewalState?","    @State private var renewalInfo: Product.SubscriptionInfo.RenewalInfo?","    ","    var body: some View {","        VStack(alignment: .leading, spacing: 16) {","            \/\/ 갱신 상태","            HStack {","                statusIcon","                VStack(alignment: .leading) {","                    Text(statusTitle)","                        .font(.headline)","                    Text(statusDescription)","                        .font(.subheadline)","                        .foregroundStyle(.secondary)","                }","            }","            ","            \/\/ 만료일 정보","            if let expirationDate = subscriptionManager.expirationDate {","                HStack {","                    Image(systemName: \"calendar\")","                    Text(renewalState == .willRenew ? \"다음 갱신일\" : \"만료일\")","                    Spacer()","                    Text(expirationDate, style: .date)","                        .foregroundStyle(.secondary)","                }","            }","            ","            \/\/ 갱신 해제 시 안내","            if renewalState == .expired || renewalState == .revoked {","                Button(\"다시 구독하기\") {","                    \/\/ 재구독 플로우","                }","                .buttonStyle(.borderedProminent)","            }","        }","        .padding()","        .background(.regularMaterial)","        .clipShape(RoundedRectangle(cornerRadius: 12))","        .task {","            await loadRenewalStatus()","        }","    }","    ","    private var statusIcon: some View {","        Group {","            switch renewalState {","            case .willRenew:","                Image(systemName: \"checkmark.circle.fill\")","                    .foregroundStyle(.green)","            case .expired:","                Image(systemName: \"xmark.circle.fill\")","                    .foregroundStyle(.red)","            case .inBillingRetry:","                Image(systemName: \"exclamationmark.triangle.fill\")","                    .foregroundStyle(.orange)","            default:","                Image(systemName: \"questionmark.circle.fill\")","                    .foregroundStyle(.secondary)","            }","        }","        .font(.title)","    }","    ","    private var statusTitle: String {","        switch renewalState {","        case .willRenew: return \"활성 구독\"","        case .expired: return \"만료됨\"","        case .inBillingRetry: return \"결제 재시도 중\"","        case .inGracePeriod: return \"유예 기간\"","        case .revoked: return \"취소됨\"","        default: return \"알 수 없음\"","        }","    }","    ","    private var statusDescription: String {","        switch renewalState {","        case .willRenew: return \"자동으로 갱신됩니다\"","        case .expired: return \"구독이 만료되었습니다\"","        case .inBillingRetry: return \"결제 정보를 확인해주세요\"","        case .inGracePeriod: return \"서비스가 곧 중단됩니다\"","        case .revoked: return \"환불 처리되었습니다\"","        default: return \"\"","        }","    }","    ","    private func loadRenewalStatus() async {","        guard let productID = subscriptionManager.activeTransaction?.productID,","              let product = try? await Product.products(for: [productID]).first,","              let subscription = product.subscription else {","            return","        }","        ","        let statuses = try? await subscription.status","        if let status = statuses?.first {","            self.renewalState = status.state","        }","    }","}"],"syntax":"swift","highlights":[],"type":"file"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/09-AppStore#JWS-Verification":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#JWS-Verification","title":"JWS Verification","kind":"section","abstract":[{"type":"text","text":"Validate subscription status from the server side"},{"text":" ","type":"text"},{"type":"text","text":"and handle real-time events with App Store Server Notifications."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/09-appstore#JWS-Verification","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/08-FamilySharing#Understanding-Family-Sharing":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/08-FamilySharing#Understanding-Family-Sharing","title":"Understanding Family Sharing","kind":"section","abstract":[{"text":"Enable up to 6 family members to use the app","type":"text"},{"type":"text","text":" "},{"text":"with a single subscription through Family Sharing.","type":"text"}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/08-familysharing#Understanding-Family-Sharing","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/03-Purchase-Flow#Purchase-Handling":{"type":"section","kind":"section","title":"Purchase Handling","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/03-purchase-flow#Purchase-Handling","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/03-Purchase-Flow#Purchase-Handling","abstract":[{"type":"text","text":"Implement the complete flow for users to purchase products."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/02-Loading-Products#Loading-Products":{"type":"section","kind":"section","title":"Loading Products","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/02-loading-products#Loading-Products","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/02-Loading-Products#Loading-Products","abstract":[{"type":"text","text":"Load product information configured in App Store Connect."}]},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-10:-Subscription-Discount-Offers":{"type":"topic","kind":"article","title":"Ring 10: Subscription Discount Offers","role":"article","url":"\/tutorials\/table-of-contents\/ring-10:-subscription-discount-offers","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-10:-Subscription-Discount-Offers","abstract":[]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/04-Subscription-Status#Checking-Subscription-Status":{"type":"section","kind":"section","title":"Checking Subscription Status","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/04-subscription-status#Checking-Subscription-Status","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/04-Subscription-Status#Checking-Subscription-Status","abstract":[{"type":"text","text":"Check subscription status and handle renewals."}]},"07-upgrade-confirm.swift":{"fileName":"UpgradeConfirmView.swift","fileType":"swift","identifier":"07-upgrade-confirm.swift","content":["import SwiftUI","import StoreKit","","\/\/\/ 업그레이드 확인 다이얼로그","struct UpgradeConfirmView: View {","    let product: Product","    @Environment(\\.dismiss) private var dismiss","    @EnvironmentObject var subscriptionManager: SubscriptionManager","    @State private var isPurchasing = false","    ","    var body: some View {","        NavigationStack {","            VStack(spacing: 24) {","                \/\/ 플랜 정보","                VStack(spacing: 8) {","                    Text(product.displayName)","                        .font(.title2.bold())","                    Text(product.displayPrice)","                        .font(.title3)","                        .foregroundStyle(.secondary)","                }","                ","                \/\/ 변경 타입 안내","                changeTypeInfo","                ","                \/\/ 구매 버튼","                Button {","                    Task { await purchase() }","                } label: {","                    if isPurchasing {","                        ProgressView()","                    } else {","                        Text(isUpgrade ? \"업그레이드\" : \"변경\")","                    }","                }","                .buttonStyle(.borderedProminent)","                .disabled(isPurchasing)","                ","                \/\/ 안내 문구","                Text(\"변경 시 Apple ID 결제가 진행됩니다.\")","                    .font(.caption)","                    .foregroundStyle(.secondary)","            }","            .padding()","            .navigationTitle(\"플랜 변경\")","            .navigationBarTitleDisplayMode(.inline)","            .toolbar {","                ToolbarItem(placement: .cancellationAction) {","                    Button(\"취소\") { dismiss() }","                }","            }","        }","    }","    ","    private var isUpgrade: Bool {","        guard let currentLevel = subscriptionManager.currentServiceLevel else { return true }","        let newLevel = subscriptionManager.serviceLevel(for: product.id)","        return newLevel > currentLevel","    }","    ","    private var changeTypeInfo: some View {","        Group {","            if isUpgrade {","                Label(\"업그레이드는 즉시 적용됩니다\", systemImage: \"arrow.up.circle.fill\")","                    .foregroundStyle(.green)","            } else {","                Label(\"다운그레이드는 다음 갱신일에 적용됩니다\", systemImage: \"calendar\")","                    .foregroundStyle(.orange)","            }","        }","        .font(.subheadline)","    }","    ","    private func purchase() async {","        isPurchasing = true","        defer { isPurchasing = false }","        ","        do {","            let result = try await product.purchase()","            switch result {","            case .success(let verification):","                if case .verified(let transaction) = verification {","                    await transaction.finish()","                    dismiss()","                }","            case .pending, .userCancelled:","                break","            @unknown default:","                break","            }","        } catch {","            print(\"Purchase error: \\(error)\")","        }","    }","}"],"syntax":"swift","highlights":[],"type":"file"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/04-Subscription-Status":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/04-Subscription-Status","title":"Managing Subscription Status","kind":"project","abstract":[{"type":"text","text":"Check subscription status and handle renewals."}],"role":"project","url":"\/tutorials\/higstorekit\/04-subscription-status","estimatedTime":"15min","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing#Writing-Unit-Tests":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Writing-Unit-Tests","title":"Writing Unit Tests","kind":"section","abstract":[{"type":"text","text":"Thoroughly test in-app purchase functionality using"},{"type":"text","text":" "},{"type":"text","text":"Xcode’s StoreKit Testing and Sandbox environment."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/11-testing#Writing-Unit-Tests","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers#Offer-Codes":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Offer-Codes","title":"Offer Codes","kind":"section","abstract":[{"type":"text","text":"Implement new user acquisition and churn prevention strategies"},{"type":"text","text":" "},{"text":"using Introductory Offers, Promotional Offers, and Offer Codes.","type":"text"}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/10-subscription-offers#Offer-Codes","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing#Check-Your-Understanding":{"titleInlineContent":[{"type":"text","text":"Check Your Understanding"}],"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Check-Your-Understanding","type":"link","title":"Check Your Understanding","url":"\/tutorials\/higstorekit\/11-testing#Check-Your-Understanding"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers#Offer-Strategy-HIG-Guidelines":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Offer-Strategy-HIG-Guidelines","title":"Offer Strategy & HIG Guidelines","kind":"section","abstract":[{"type":"text","text":"Implement new user acquisition and churn prevention strategies"},{"text":" ","type":"text"},{"text":"using Introductory Offers, Promotional Offers, and Offer Codes.","type":"text"}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/10-subscription-offers#Offer-Strategy-HIG-Guidelines","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers#Introductory-Offers":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Introductory-Offers","title":"Introductory Offers","kind":"section","abstract":[{"type":"text","text":"Implement new user acquisition and churn prevention strategies"},{"text":" ","type":"text"},{"type":"text","text":"using Introductory Offers, Promotional Offers, and Offer Codes."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/10-subscription-offers#Introductory-Offers","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/10-Subscription-Offers#Check-Your-Understanding":{"type":"link","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/10-Subscription-Offers#Check-Your-Understanding","url":"\/tutorials\/higstorekit\/10-subscription-offers#Check-Your-Understanding","title":"Check Your Understanding","titleInlineContent":[{"text":"Check Your Understanding","type":"text"}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/09-AppStore#Server-Notifications-V2":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Server-Notifications-V2","title":"Server Notifications V2","kind":"section","abstract":[{"type":"text","text":"Validate subscription status from the server side"},{"type":"text","text":" "},{"text":"and handle real-time events with App Store Server Notifications.","type":"text"}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/09-appstore#Server-Notifications-V2","type":"section"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-5:-Paywall-UI":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-5:-Paywall-UI","title":"Ring 5: Paywall UI","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-5:-paywall-ui","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-11:-StoreKit-Testing":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-11:-StoreKit-Testing","title":"Ring 11: StoreKit Testing","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-11:-storekit-testing","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-4:-Subscription-Management":{"type":"topic","kind":"article","title":"Ring 4: Subscription Management","role":"article","url":"\/tutorials\/table-of-contents\/ring-4:-subscription-management","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-4:-Subscription-Management","abstract":[]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/02-Loading-Products":{"type":"topic","kind":"project","title":"Loading Products","role":"project","estimatedTime":"15min","url":"\/tutorials\/higstorekit\/02-loading-products","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/02-Loading-Products","abstract":[{"text":"Load product information configured in App Store Connect.","type":"text"}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/07-Subscriptions#Subscription-Groups-and-Levels":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Groups-and-Levels","title":"Subscription Groups and Levels","kind":"section","abstract":[{"type":"text","text":"Implement all subscription management features needed for a real service,"},{"text":" ","type":"text"},{"text":"including subscription renewal, upgrades\/downgrades, cancellation, and restoration.","type":"text"}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/07-subscriptions#Subscription-Groups-and-Levels","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/07-Subscriptions#Subscription-Renewal-Status":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Subscription-Renewal-Status","title":"Subscription Renewal Status","kind":"section","abstract":[{"text":"Implement all subscription management features needed for a real service,","type":"text"},{"type":"text","text":" "},{"type":"text","text":"including subscription renewal, upgrades\/downgrades, cancellation, and restoration."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/07-subscriptions#Subscription-Renewal-Status","type":"section"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents","title":"Building a Subscription App with StoreKit 2","kind":"overview","abstract":[{"type":"text","text":"Implement a subscription payment system using"},{"type":"text","text":" "},{"text":"StoreKit 2’s modern async\/await APIs.","type":"text"}],"role":"overview","url":"\/tutorials\/table-of-contents","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-1:-Understanding-StoreKit-2":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-1:-Understanding-StoreKit-2","title":"Ring 1: Understanding StoreKit 2","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-1:-understanding-storekit-2","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing#StoreKit-Configuration-File":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#StoreKit-Configuration-File","title":"StoreKit Configuration File","kind":"section","abstract":[{"type":"text","text":"Thoroughly test in-app purchase functionality using"},{"text":" ","type":"text"},{"type":"text","text":"Xcode’s StoreKit Testing and Sandbox environment."}],"role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/11-testing#StoreKit-Configuration-File","type":"section"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/05-Paywall-UI#Paywall-Design":{"type":"section","kind":"section","title":"Paywall Design","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/05-paywall-ui#Paywall-Design","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/05-Paywall-UI#Paywall-Design","abstract":[{"type":"text","text":"Design a paywall screen that follows Apple HIG guidelines."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/11-Testing#Sandbox-Testing":{"type":"section","kind":"section","title":"Sandbox Testing","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/11-testing#Sandbox-Testing","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/11-Testing#Sandbox-Testing","abstract":[{"type":"text","text":"Thoroughly test in-app purchase functionality using"},{"type":"text","text":" "},{"type":"text","text":"Xcode’s StoreKit Testing and Sandbox environment."}]},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-9:-App-Store-Server-API":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-9:-App-Store-Server-API","title":"Ring 9: App Store Server API","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-9:-app-store-server-api","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-2:-Loading-Products":{"type":"topic","kind":"article","title":"Ring 2: Loading Products","role":"article","url":"\/tutorials\/table-of-contents\/ring-2:-loading-products","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-2:-Loading-Products","abstract":[]},"doc://storekit.HIGStoreKit/tutorials/Table-of-Contents/Ring-7:-Advanced-Subscription-Management":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/Table-of-Contents\/Ring-7:-Advanced-Subscription-Management","title":"Ring 7: Advanced Subscription Management","kind":"article","abstract":[],"role":"article","url":"\/tutorials\/table-of-contents\/ring-7:-advanced-subscription-management","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/09-AppStore#Server-API-Overview":{"type":"section","kind":"section","title":"Server API Overview","role":"pseudoSymbol","url":"\/tutorials\/higstorekit\/09-appstore#Server-API-Overview","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore#Server-API-Overview","abstract":[{"type":"text","text":"Validate subscription status from the server side"},{"type":"text","text":" "},{"type":"text","text":"and handle real-time events with App Store Server Notifications."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/09-AppStore":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/09-AppStore","title":"App Store Server API","kind":"project","abstract":[{"type":"text","text":"Validate subscription status from the server side"},{"type":"text","text":" "},{"text":"and handle real-time events with App Store Server Notifications.","type":"text"}],"role":"project","url":"\/tutorials\/higstorekit\/09-appstore","estimatedTime":"30min","type":"topic"},"07-subscription-manager.swift":{"fileName":"SubscriptionManager.swift","fileType":"swift","identifier":"07-subscription-manager.swift","content":["import StoreKit","","\/\/\/ 구독 그룹과 레벨을 관리하는 매니저","@MainActor","class SubscriptionManager: ObservableObject {","    ","    \/\/\/ 구독 그룹 식별자","    static let subscriptionGroupID = \"com.example.subscription.group\"","    ","    \/\/\/ 서비스 레벨 정의 (높을수록 상위 플랜)","    enum ServiceLevel: Int, Comparable {","        case basic = 1","        case premium = 2","        case ultimate = 3","        ","        static func < (lhs: ServiceLevel, rhs: ServiceLevel) -> Bool {","            lhs.rawValue < rhs.rawValue","        }","    }","    ","    @Published var currentSubscription: Product.SubscriptionInfo?","    @Published var activeTransaction: Transaction?","    ","    \/\/\/ 상품 ID를 서비스 레벨로 매핑","    func serviceLevel(for productID: String) -> ServiceLevel {","        switch productID {","        case \"com.example.basic.monthly\", \"com.example.basic.yearly\":","            return .basic","        case \"com.example.premium.monthly\", \"com.example.premium.yearly\":","            return .premium","        case \"com.example.ultimate.monthly\", \"com.example.ultimate.yearly\":","            return .ultimate","        default:","            return .basic","        }","    }","    ","    \/\/\/ 현재 구독의 서비스 레벨 확인","    var currentServiceLevel: ServiceLevel? {","        guard let transaction = activeTransaction else { return nil }","        return serviceLevel(for: transaction.productID)","    }","}"],"syntax":"swift","highlights":[],"type":"file"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/07-Subscriptions":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions","title":"Advanced Subscription Management","kind":"project","abstract":[{"type":"text","text":"Implement all subscription management features needed for a real service,"},{"type":"text","text":" "},{"text":"including subscription renewal, upgrades\/downgrades, cancellation, and restoration.","type":"text"}],"role":"project","url":"\/tutorials\/higstorekit\/07-subscriptions","estimatedTime":"25min","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/03-Purchase-Flow":{"type":"topic","kind":"project","title":"Implementing Purchase Flow","role":"project","estimatedTime":"15min","url":"\/tutorials\/higstorekit\/03-purchase-flow","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/03-Purchase-Flow","abstract":[{"type":"text","text":"Implement the complete flow for users to purchase products."}]},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/01-Understanding-StoreKit":{"identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/01-Understanding-StoreKit","title":"Understanding StoreKit 2","kind":"project","abstract":[{"text":"Learn the core concepts of StoreKit 2 and HIG in-app purchase guidelines.","type":"text"}],"role":"project","url":"\/tutorials\/higstorekit\/01-understanding-storekit","estimatedTime":"10min","type":"topic"},"doc://storekit.HIGStoreKit/tutorials/HIGStoreKit/07-Subscriptions#Check-Your-Understanding":{"title":"Check Your Understanding","url":"\/tutorials\/higstorekit\/07-subscriptions#Check-Your-Understanding","identifier":"doc:\/\/storekit.HIGStoreKit\/tutorials\/HIGStoreKit\/07-Subscriptions#Check-Your-Understanding","titleInlineContent":[{"text":"Check Your Understanding","type":"text"}],"type":"link"}}}