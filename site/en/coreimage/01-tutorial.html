<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ¨ Core Image â€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--code-bg:#1e1e2e;--border:#d2d2d7}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(28px,5vw,40px);font-weight:900;margin-bottom:16px;letter-spacing:-1px}
h2{font-size:24px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.subtitle{font-size:18px;color:var(--text-2);margin-bottom:32px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:12px;color:#6e6e73;font-weight:600}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;color:#cdd6f4;white-space:pre;overflow-x:auto}
.kw{color:#cba6f7}.type{color:#89b4fa}.str{color:#a6e3a1}.comment{color:#6c7086}
.badge{display:inline-block;padding:4px 12px;border-radius:16px;font-size:13px;font-weight:600;margin:0 4px 8px 0}
.badge.ios{background:#0071e3;color:#fff}.badge.new{background:#34c759;color:#fff}
ul{margin:16px 0 16px 24px}li{margin:8px 0}
.info-box{background:#f5f5f7;border-left:4px solid var(--accent);padding:16px;margin:24px 0;border-radius:8px}
</style></head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="../../coreimage/01-tutorial.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">ğŸ‡°ğŸ‡· KO</a></div></div>
<article>
<h1>ğŸ¨ Core Image</h1>
<!-- higlab-metadata -->
<div style="display:flex;gap:16px;align-items:center;margin:12px 0 24px;padding:12px 16px;background:var(--tag-bg,#f5f5f7);border-radius:10px;font-size:13px;color:var(--text-2,#6e6e73);flex-wrap:wrap;">
  <span>â­ Difficulty: â­â­â­</span>
  <span>â±ï¸ Est. Time: 2h</span>
  <span>ğŸ“‚ Graphics & Media</span>
</div>
<p class="subtitle">ê°•ë ¥í•œ ì´ë¯¸ì§€ í•„í„°ì™€ ì²˜ë¦¬</p>

<div><span class="badge ios">iOS 5+</span><span class="badge new">Metal ê°€ì†</span></div>

<h2>âœ¨ Core Image?</h2>
<p>Core Image is Apple's high-performance image processing framework that provides real-time image/video processing through GPU-accelerated filters. It supports 200+ built-in filters and custom filter creation.</p>

<div class="info-box">
<strong>ğŸ’¡ Key Features:</strong> 200+ Built-in Filters Â· GPU Acceleration Â· Real-Time Processing Â· Filter Chaining Â· Face Detection Â· Custom Filters Â· Core ML Integration Â· Metal Optimization
</div>

<h2>ğŸ¯ 1. ê¸°ë³¸ í•„í„° ì ìš©</h2>
<p>ì´ë¯¸ì§€ì— í•„í„°ë¥¼ ì ìš©í•˜ëŠ” ê¸°ë³¸ ë°©ë²•.</p>

<div class="code-block">
<div class="code-header">ImageFilterManager.swift â€” Basic Filters</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreImage</span>
<span class="kw">import</span> <span class="type">UIKit</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">ImageFilterManager</span> {
    <span class="kw">private</span> <span class="kw">let</span> context = <span class="type">CIContext</span>()

    <span class="comment">// 1. ì„¸í”¼ì•„ í•„í„°</span>
    <span class="kw">func</span> applySepia(to image: <span class="type">UIImage</span>, intensity: <span class="type">Double</span> = <span class="str">0.8</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// í•„í„° ìƒì„±</span>
        <span class="kw">guard</span> <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CISepiaTone"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// ì…ë ¥ ì´ë¯¸ì§€ ì„¤ì •</span>
        filter.setValue(ciImage, forKey: kCIInputImageKey)

        <span class="comment">// í•„í„° íŒŒë¼ë¯¸í„° ì„¤ì •</span>
        filter.setValue(intensity, forKey: kCIInputIntensityKey)

        <span class="comment">// ê²°ê³¼ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°</span>
        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// CIImage â†’ CGImage â†’ UIImage</span>
        <span class="kw">guard</span> <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: outputImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 2. ë¸”ëŸ¬ í•„í„°</span>
    <span class="kw">func</span> applyBlur(to image: <span class="type">UIImage</span>, radius: <span class="type">Double</span> = <span class="str">10.0</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIGaussianBlur"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(radius, forKey: kCIInputRadiusKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 3. ë°ê¸°/ëŒ€ë¹„ ì¡°ì •</span>
    <span class="kw">func</span> adjustBrightnessContrast(
        image: <span class="type">UIImage</span>,
        brightness: <span class="type">Double</span> = <span class="str">0.0</span>,
        contrast: <span class="type">Double</span> = <span class="str">1.0</span>
    ) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIColorControls"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(brightness, forKey: kCIInputBrightnessKey)
        filter.setValue(contrast, forKey: kCIInputContrastKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 4. ë¹„ë„¤íŒ… íš¨ê³¼</span>
    <span class="kw">func</span> applyVignette(to image: <span class="type">UIImage</span>, intensity: <span class="type">Double</span> = <span class="str">1.0</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIVignetteEffect"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(intensity, forKey: kCIInputIntensityKey)
        filter.setValue(<span class="str">2.0</span>, forKey: <span class="str">"inputRadius"</span>)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }
}</pre>
</div>

<h2>ğŸ¨ 2. ì¸ê¸° í•„í„° ëª¨ìŒ</h2>
<p>ìì£¼ ì‚¬ìš©ë˜ëŠ” í•„í„°ë“¤ì„ ëª¨ì•˜.</p>

<div class="code-block">
<div class="code-header">PopularFilters.swift â€” ì¸ê¸° í•„í„°</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreImage</span>

<span class="kw">extension</span> <span class="type">ImageFilterManager</span> {
    <span class="comment">// 1. í‘ë°± í•„í„°</span>
    <span class="kw">func</span> applyMonochrome(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIPhotoEffectNoir"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 2. ë¹„ë¹„ë“œ í•„í„° (ì±„ë„ ì¦ê°€)</span>
    <span class="kw">func</span> applyVivid(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIColorControls"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(<span class="str">1.5</span>, forKey: kCIInputSaturationKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 3. í”½ì…€í™”</span>
    <span class="kw">func</span> applyPixelate(to image: <span class="type">UIImage</span>, scale: <span class="type">Double</span> = <span class="str">8.0</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIPixellate"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(scale, forKey: kCIInputScaleKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 4. ì—£ì§€ ê°ì§€</span>
    <span class="kw">func</span> applyEdgeDetection(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIEdges"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)
        filter.setValue(<span class="str">1.0</span>, forKey: kCIInputIntensityKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// 5. ë§Œí™” íš¨ê³¼</span>
    <span class="kw">func</span> applyComicEffect(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image),
              <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIComicEffect"</span>) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        filter.setValue(ciImage, forKey: kCIInputImageKey)

        <span class="kw">guard</span> <span class="kw">let</span> outputImage = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }
}</pre>
</div>

<h2>ğŸ”— 3. í•„í„° ì²´ì´ë‹</h2>
<p>ì—¬ëŸ¬ í•„í„°ë¥¼ ì—°ê²°í•˜ì—¬ ë³µì¡í•œ íš¨ê³¼ë¥¼ ë§Œë“­.</p>

<div class="code-block">
<div class="code-header">FilterChaining.swift â€” Filter Chaining</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreImage</span>

<span class="kw">extension</span> <span class="type">ImageFilterManager</span> {
    <span class="comment">// ì—¬ëŸ¬ í•„í„°ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì ìš©</span>
    <span class="kw">func</span> applyFilterChain(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">var</span> ciImage = <span class="type">CIImage</span>(image: image) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// 1. ë°ê¸° ì¦ê°€</span>
        <span class="kw">if</span> <span class="kw">let</span> brightnessFilter = <span class="type">CIFilter</span>(name: <span class="str">"CIColorControls"</span>) {
            brightnessFilter.setValue(ciImage, forKey: kCIInputImageKey)
            brightnessFilter.setValue(<span class="str">0.2</span>, forKey: kCIInputBrightnessKey)
            <span class="kw">if</span> <span class="kw">let</span> output = brightnessFilter.outputImage {
                ciImage = output
            }
        }

        <span class="comment">// 2. ì±„ë„ ì¦ê°€</span>
        <span class="kw">if</span> <span class="kw">let</span> saturationFilter = <span class="type">CIFilter</span>(name: <span class="str">"CIColorControls"</span>) {
            saturationFilter.setValue(ciImage, forKey: kCIInputImageKey)
            saturationFilter.setValue(<span class="str">1.3</span>, forKey: kCIInputSaturationKey)
            <span class="kw">if</span> <span class="kw">let</span> output = saturationFilter.outputImage {
                ciImage = output
            }
        }

        <span class="comment">// 3. ë¹„ë„¤íŒ… ì¶”ê°€</span>
        <span class="kw">if</span> <span class="kw">let</span> vignetteFilter = <span class="type">CIFilter</span>(name: <span class="str">"CIVignetteEffect"</span>) {
            vignetteFilter.setValue(ciImage, forKey: kCIInputImageKey)
            vignetteFilter.setValue(<span class="str">1.5</span>, forKey: kCIInputIntensityKey)
            <span class="kw">if</span> <span class="kw">let</span> output = vignetteFilter.outputImage {
                ciImage = output
            }
        }

        <span class="comment">// ìµœì¢… ì´ë¯¸ì§€ ë°˜í™˜</span>
        <span class="kw">guard</span> <span class="kw">let</span> cgImage = context.createCGImage(ciImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// ì¸ìŠ¤íƒ€ê·¸ë¨ ìŠ¤íƒ€ì¼ í•„í„°</span>
    <span class="kw">func</span> applyInstagramStyle(to image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">var</span> ciImage = <span class="type">CIImage</span>(image: image) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// ë°ê¸° ì¡°ì •</span>
        <span class="kw">if</span> <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CIColorControls"</span>) {
            filter.setValue(ciImage, forKey: kCIInputImageKey)
            filter.setValue(<span class="str">0.1</span>, forKey: kCIInputBrightnessKey)
            filter.setValue(<span class="str">1.1</span>, forKey: kCIInputContrastKey)
            filter.setValue(<span class="str">1.2</span>, forKey: kCIInputSaturationKey)
            <span class="kw">if</span> <span class="kw">let</span> output = filter.outputImage {
                ciImage = output
            }
        }

        <span class="comment">// ì˜¨ë„ ì¡°ì • (ë”°ëœ»í•œ í†¤)</span>
        <span class="kw">if</span> <span class="kw">let</span> filter = <span class="type">CIFilter</span>(name: <span class="str">"CITemperatureAndTint"</span>) {
            filter.setValue(ciImage, forKey: kCIInputImageKey)
            filter.setValue(<span class="type">CIVector</span>(x: <span class="str">6500</span>, y: <span class="str">0</span>), forKey: <span class="str">"inputNeutral"</span>)
            filter.setValue(<span class="type">CIVector</span>(x: <span class="str">6800</span>, y: <span class="str">100</span>), forKey: <span class="str">"inputTargetNeutral"</span>)
            <span class="kw">if</span> <span class="kw">let</span> output = filter.outputImage {
                ciImage = output
            }
        }

        <span class="kw">guard</span> <span class="kw">let</span> cgImage = context.createCGImage(ciImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }
}</pre>
</div>

<h2>ğŸ˜Š 4. ì–¼êµ´ ê°ì§€</h2>
<p>Core Imageë¡œ ì´ë¯¸ì§€ ì† ì–¼êµ´ì„ ê°ì§€.</p>

<div class="code-block">
<div class="code-header">FaceDetection.swift â€” ì–¼êµ´ ê°ì§€</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreImage</span>

<span class="kw">extension</span> <span class="type">ImageFilterManager</span> {
    <span class="comment">// ì–¼êµ´ ê°ì§€</span>
    <span class="kw">func</span> detectFaces(in image: <span class="type">UIImage</span>) -> [<span class="type">CIFeature</span>] {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image) <span class="kw">else</span> { <span class="kw">return</span> [] }

        <span class="comment">// ì–¼êµ´ ê°ì§€ê¸° ìƒì„±</span>
        <span class="kw">let</span> detector = <span class="type">CIDetector</span>(
            ofType: <span class="type">CIDetectorTypeFace</span>,
            context: context,
            options: [
                <span class="type">CIDetectorAccuracy</span>: <span class="type">CIDetectorAccuracyHigh</span>,
                <span class="type">CIDetectorSmile</span>: <span class="kw">true</span>,
                <span class="type">CIDetectorEyeBlink</span>: <span class="kw">true</span>
            ]
        )

        <span class="comment">// ì–¼êµ´ ê°ì§€</span>
        <span class="kw">let</span> features = detector?.features(in: ciImage) ?? []

        <span class="comment">// ì–¼êµ´ ì •ë³´ ì¶œë ¥</span>
        <span class="kw">for</span> feature <span class="kw">in</span> features {
            <span class="kw">if</span> <span class="kw">let</span> faceFeature = feature <span class="kw">as</span>? <span class="type">CIFaceFeature</span> {
                print(<span class="str">"ì–¼êµ´ ìœ„ì¹˜: \(faceFeature.bounds)"</span>)

                <span class="kw">if</span> faceFeature.hasSmile {
                    print(<span class="str">"ì›ƒê³  ìˆìŒ"</span>)
                }

                <span class="kw">if</span> faceFeature.leftEyeClosed {
                    print(<span class="str">"ì™¼ìª½ ëˆˆ ê°ìŒ"</span>)
                }

                <span class="kw">if</span> faceFeature.rightEyeClosed {
                    print(<span class="str">"ì˜¤ë¥¸ìª½ ëˆˆ ê°ìŒ"</span>)
                }
            }
        }

        <span class="kw">return</span> features
    }

    <span class="comment">// ì–¼êµ´ì— ë¸”ëŸ¬ ì²˜ë¦¬</span>
    <span class="kw">func</span> blurFaces(in image: <span class="type">UIImage</span>) -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(image: image) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="kw">let</span> faces = detectFaces(in: image)
        <span class="kw">var</span> outputImage = ciImage

        <span class="kw">for</span> feature <span class="kw">in</span> faces {
            <span class="kw">guard</span> <span class="kw">let</span> faceFeature = feature <span class="kw">as</span>? <span class="type">CIFaceFeature</span> <span class="kw">else</span> { <span class="kw">continue</span> }

            <span class="comment">// ì–¼êµ´ ì˜ì—­ ì¶”ì¶œ</span>
            <span class="kw">let</span> faceBounds = faceFeature.bounds
            <span class="kw">let</span> faceImage = ciImage.cropped(to: faceBounds)

            <span class="comment">// ë¸”ëŸ¬ ì ìš©</span>
            <span class="kw">if</span> <span class="kw">let</span> blurFilter = <span class="type">CIFilter</span>(name: <span class="str">"CIGaussianBlur"</span>) {
                blurFilter.setValue(faceImage, forKey: kCIInputImageKey)
                blurFilter.setValue(<span class="str">20.0</span>, forKey: kCIInputRadiusKey)

                <span class="kw">if</span> <span class="kw">let</span> blurredFace = blurFilter.outputImage {
                    <span class="comment">// ë¸”ëŸ¬ëœ ì–¼êµ´ì„ ì›ë³¸ì— í•©ì„±</span>
                    outputImage = blurredFace.composited(over: outputImage)
                }
            }
        }

        <span class="kw">guard</span> <span class="kw">let</span> cgImage = context.createCGImage(outputImage, from: ciImage.extent) <span class="kw">else</span> {
            <span class="kw">return</span> <span class="kw">nil</span>
        }

        <span class="kw">return</span> <span class="type">UIImage</span>(cgImage: cgImage)
    }
}</pre>
</div>

<h2>ğŸ“± SwiftUI Integration</h2>

<div class="code-block">
<div class="code-header">FilterDemoView.swift â€” SwiftUI Integration</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">PhotosUI</span>

<span class="kw">struct</span> <span class="type">FilterDemoView</span>: <span class="type">View</span> {
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> selectedImage: <span class="type">UIImage</span>?
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> filteredImage: <span class="type">UIImage</span>?
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> selectedFilter: <span class="type">FilterType</span> = .original
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> isProcessing = <span class="kw">false</span>

    <span class="kw">let</span> filterManager = <span class="type">ImageFilterManager</span>()

    <span class="kw">enum</span> <span class="type">FilterType</span>: <span class="type">String</span>, <span class="type">CaseIterable</span> {
        <span class="kw">case</span> original = <span class="str">"ì›ë³¸"</span>
        <span class="kw">case</span> sepia = <span class="str">"ì„¸í”¼ì•„"</span>
        <span class="kw">case</span> monochrome = <span class="str">"í‘ë°±"</span>
        <span class="kw">case</span> blur = <span class="str">"ë¸”ëŸ¬"</span>
        <span class="kw">case</span> vivid = <span class="str">"ë¹„ë¹„ë“œ"</span>
        <span class="kw">case</span> vignette = <span class="str">"ë¹„ë„¤íŒ…"</span>
    }

    <span class="kw">var</span> body: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">VStack</span> {
            <span class="comment">// ì´ë¯¸ì§€ í‘œì‹œ</span>
            <span class="kw">if</span> <span class="kw">let</span> displayImage = filteredImage ?? selectedImage {
                <span class="type">Image</span>(uiImage: displayImage)
                    .resizable()
                    .scaledToFit()
                    .frame(maxHeight: <span class="str">400</span>)
            } <span class="kw">else</span> {
                <span class="type">ContentUnavailableView</span>(
                    <span class="str">"ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”"</span>,
                    systemImage: <span class="str">"photo"</span>
                )
            }

            <span class="comment">// í•„í„° ì„ íƒ</span>
            <span class="type">ScrollView</span>(.horizontal) {
                <span class="type">HStack</span>(spacing: <span class="str">15</span>) {
                    <span class="type">ForEach</span>(<span class="type">FilterType</span>.allCases, id: \.<span class="kw">self</span>) { filter <span class="kw">in</span>
                        <span class="type">Button</span> {
                            selectedFilter = filter
                            applyFilter(filter)
                        } label: {
                            <span class="type">Text</span>(filter.rawValue)
                                .padding(<span class="str">8</span>)
                                .background(
                                    selectedFilter == filter ? <span class="type">Color</span>.blue : <span class="type">Color</span>.gray.opacity(<span class="str">0.2</span>)
                                )
                                .foregroundStyle(selectedFilter == filter ? .white : .primary)
                                .cornerRadius(<span class="str">8</span>)
                        }
                    }
                }
                .padding()
            }

            <span class="comment">// ì‚¬ì§„ ì„ íƒ</span>
            <span class="type">PhotosPicker</span>(selection: .<span class="kw">constant</span>(<span class="kw">nil</span>),
                         matching: .images) {
                <span class="type">Label</span>(<span class="str">"ì‚¬ì§„ ì„ íƒ"</span>, systemImage: <span class="str">"photo.on.rectangle"</span>)
            }
            .buttonStyle(.borderedProminent)
            .padding()

            <span class="kw">if</span> isProcessing {
                <span class="type">ProgressView</span>(<span class="str">"í•„í„° ì ìš© ì¤‘..."</span>)
            }
        }
    }

    <span class="kw">func</span> applyFilter(<span class="kw">_</span> filter: <span class="type">FilterType</span>) {
        <span class="kw">guard</span> <span class="kw">let</span> image = selectedImage <span class="kw">else</span> { <span class="kw">return</span> }

        isProcessing = <span class="kw">true</span>

        <span class="type">Task</span> {
            <span class="kw">let</span> result: <span class="type">UIImage</span>?

            <span class="kw">switch</span> filter {
            <span class="kw">case</span> .original:
                result = image
            <span class="kw">case</span> .sepia:
                result = filterManager.applySepia(to: image)
            <span class="kw">case</span> .monochrome:
                result = filterManager.applyMonochrome(to: image)
            <span class="kw">case</span> .blur:
                result = filterManager.applyBlur(to: image)
            <span class="kw">case</span> .vivid:
                result = filterManager.applyVivid(to: image)
            <span class="kw">case</span> .vignette:
                result = filterManager.applyVignette(to: image)
            }

            <span class="kw">await</span> <span class="type">MainActor</span>.run {
                filteredImage = result
                isProcessing = <span class="kw">false</span>
            }
        }
    }
}</pre>
</div>

<h2>ğŸ’¡ HIG Guidelines</h2>

<ul>
<li><strong>ì„±ëŠ¥:</strong> ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œì—ì„œ í•„í„° ì²˜ë¦¬</li>
<li><strong>ì»¨í…ìŠ¤íŠ¸:</strong> CIContextë¥¼ ì¬ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ</li>
<li><strong>í”„ë¦¬ë·°:</strong> ë‚®ì€ í•´ìƒë„ë¡œ ì‹¤ì‹œê°„ í”„ë¦¬ë·° ì œê³µ</li>
<li><strong>ë©”ëª¨ë¦¬:</strong> í° ì´ë¯¸ì§€ëŠ” ë‹¤ìš´ìƒ˜í”Œë§</li>
<li><strong>Metal:</strong> Using Metal-based CIContext is recommended</li>
</ul>

<h2>ğŸ¯ Practical Usage</h2>

<ul>
<li><strong>Photo Editing Apps:</strong> í•„í„°, ë³´ì •, íš¨ê³¼</li>
<li><strong>Camera Apps:</strong> ì‹¤ì‹œê°„ í•„í„° ë¯¸ë¦¬ë³´ê¸°</li>
<li><strong>Social Media:</strong> ì¸ìŠ¤íƒ€ê·¸ë¨ ìŠ¤íƒ€ì¼ í•„í„°</li>
<li><strong>ì–¼êµ´ ì¸ì‹:</strong> ìë™ ì–¼êµ´ ë¸”ëŸ¬/ëª¨ìì´í¬</li>
<li><strong>AR Filters:</strong> ì‹¤ì‹œê°„ ë¹„ë””ì˜¤ í•„í„°</li>
</ul>

<h2>ğŸ“š Learn More</h2>

<ul>
<li><a href="https://developer.apple.com/documentation/coreimage">Core Image ê³µì‹ ë¬¸ì„œ</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/GraphicsImaging/Reference/CoreImageFilterReference/">Core Image Filter Reference</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2023/">WWDC: Core Image ì„¸ì…˜</a></li>
</ul>

<div class="info-box">
<strong>âš¡ï¸ Performance Tips:</strong> Using a Metal-based CIContext significantly improves filter processing speed with GPU acceleration. <code>CIContext(mtlDevice: MTLCreateSystemDefaultDevice()!)</code>ë¡œ ìƒì„±í•˜.
</div>

<div style="margin-top:48px;padding:24px;background:linear-gradient(135deg,#f5f5f7,#e8e8ed);border-radius:16px;">
  <h2 style="font-size:20px;margin-bottom:12px;">ğŸ“ Apple Official Resources</h2>
  <div style="display:flex;flex-wrap:wrap;gap:12px;">
    <a href="https://developer.apple.com/documentation/coreimage" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ“˜ Documentation</a>
    <a href="https://developer.apple.com/videos/all-videos/?q=Core+Image" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ¬ WWDC Sessions</a>
  </div>
</div>
</article>
</body></html>