<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>π”’ CryptoKit μ™„μ „μ •λ³µ β€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--surface:#fff;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--green:#34c759;--border:#d2d2d7;--code-bg:#1e1e2e;--radius:16px}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans KR',-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.88);backdrop-filter:blur(20px);border-bottom:.5px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(32px,5vw,44px);font-weight:900;letter-spacing:-1.5px;line-height:1.2;margin-bottom:16px}
h2{font-size:26px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:10px 16px;background:rgba(255,255,255,0.05);border-bottom:1px solid rgba(255,255,255,0.08);display:flex;justify-content:space-between}
.code-filename{font-size:13px;color:#cdd6f4;font-family:'JetBrains Mono',monospace}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.6;color:#cdd6f4;white-space:pre;overflow-x:auto}
.code-body .kw{color:#cba6f7}.code-body .type{color:#89b4fa}.code-body .str{color:#a6e3a1}.code-body .func{color:#89dceb}.code-body .prop{color:#f5c2e7}.code-body .comment{color:#6c7086}.code-body .num{color:#fab387}
</style>
</head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="01-tutorial.en.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">π EN</a></div></div>
<article>
<h1>π”’ CryptoKit μ™„μ „μ •λ³µ</h1>
<p>μ•”νΈν™”λ¶€ν„° μ„λ…κΉμ§€! Appleμ ν„λ€μ  μ•”νΈν™” ν”„λ μ„μ›ν¬λ΅ λ°μ΄ν„°λ¥Ό μ™„λ²½ν•κ² λ³΄νΈν•μ„Έμ”.</p>

<h2>β¨ CryptoKitμ΄λ€?</h2>
<p>CryptoKitμ€ Appleμ΄ μ κ³µν•λ” Swift λ„¤μ΄ν‹°λΈ μ•”νΈν™” ν”„λ μ„μ›ν¬μ…λ‹λ‹¤. ν•΄μ‹±, λ€μΉ­ν‚¤ μ•”νΈν™”, κ³µκ°ν‚¤ μ•”νΈν™”, λ””μ§€ν„Έ μ„λ…μ„ κ°„κ²°ν•κ³  μ•μ „ν•κ² κµ¬ν„ν•  μ μμµλ‹λ‹¤. iOS 13+μ—μ„ μ‚¬μ© κ°€λ¥ν•λ©° λ¨λ“  μ•”νΈν™” μ‘μ—…μ΄ Secure Enclaveμ—μ„ μ²λ¦¬λ©λ‹λ‹¤.</p>

<h2>π“¦ μ£Όμ” κΈ°λ¥</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">κΈ°λ¥ κ°μ”</span></div>
<pre class="code-body"><span class="comment">β… ν•΄μ‹± (SHA-256, SHA-384, SHA-512)
β… λ€μΉ­ν‚¤ μ•”νΈν™” (AES-GCM, ChaCha20-Poly1305)
β… κ³µκ°ν‚¤ μ•”νΈν™” (Curve25519, P-256, P-384, P-521)
β… λ””μ§€ν„Έ μ„λ… (ECDSA, EdDSA)
β… ν‚¤ κµν™ (ECDH)
β… HKDF (ν‚¤ μ λ„)
β… HMAC (λ©”μ‹μ§€ μΈμ¦ μ½”λ“)</span></pre></div>

<h2>π”‘ ν•΄μ‹± (Hashing)</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">Hashing.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>
<span class="kw">import</span> <span class="type">Foundation</span>

<span class="comment">// SHA-256 ν•΄μ‹±</span>
<span class="kw">func</span> <span class="func">hashData</span>(_ input: <span class="type">String</span>) -> <span class="type">String</span> {
    <span class="kw">let</span> data = <span class="type">Data</span>(input.utf8)
    <span class="kw">let</span> hash = <span class="type">SHA256</span>.<span class="func">hash</span>(data: data)

    <span class="comment">// Hex λ¬Έμμ—΄λ΅ λ³€ν™</span>
    <span class="kw">return</span> hash.<span class="func">compactMap</span> { <span class="type">String</span>(format: <span class="str">"%02x"</span>, $0) }.joined()
}

<span class="comment">// μ‚¬μ© μμ‹</span>
<span class="kw">let</span> password = <span class="str">"mySecurePassword123"</span>
<span class="kw">let</span> hashed = <span class="func">hashData</span>(password)
<span class="func">print</span>(hashed)
<span class="comment">// "b3d2f8c5..." (64μ hex λ¬Έμμ—΄)</span>

<span class="comment">// SHA-512 ν•΄μ‹±</span>
<span class="kw">func</span> <span class="func">hashSHA512</span>(_ input: <span class="type">String</span>) -> <span class="type">String</span> {
    <span class="kw">let</span> data = <span class="type">Data</span>(input.utf8)
    <span class="kw">let</span> hash = <span class="type">SHA512</span>.<span class="func">hash</span>(data: data)
    <span class="kw">return</span> hash.description  <span class="comment">// λλ” hex λ³€ν™</span>
}

<span class="comment">// νμΌ ν•΄μ‹±</span>
<span class="kw">func</span> <span class="func">hashFile</span>(at url: <span class="type">URL</span>) <span class="kw">throws</span> -> <span class="type">String</span> {
    <span class="kw">let</span> data = <span class="kw">try</span> <span class="type">Data</span>(contentsOf: url)
    <span class="kw">let</span> hash = <span class="type">SHA256</span>.<span class="func">hash</span>(data: data)
    <span class="kw">return</span> hash.<span class="func">compactMap</span> { <span class="type">String</span>(format: <span class="str">"%02x"</span>, $0) }.joined()
}</pre></div>

<h2>π” λ€μΉ­ν‚¤ μ•”νΈν™” (AES-GCM)</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">SymmetricEncryption.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// AES-GCM μ•”νΈν™”</span>
<span class="kw">func</span> <span class="func">encryptData</span>(_ plaintext: <span class="type">String</span>, key: <span class="type">SymmetricKey</span>) <span class="kw">throws</span> -> <span class="type">Data</span> {
    <span class="kw">let</span> data = <span class="type">Data</span>(plaintext.utf8)

    <span class="comment">// AES-GCM μ•”νΈν™” (μΈμ¦ νƒκ·Έ ν¬ν•¨)</span>
    <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">seal</span>(data, using: key)

    <span class="comment">// combined: nonce + ciphertext + tag</span>
    <span class="kw">return</span> sealedBox.combined!
}

<span class="kw">func</span> <span class="func">decryptData</span>(_ encrypted: <span class="type">Data</span>, key: <span class="type">SymmetricKey</span>) <span class="kw">throws</span> -> <span class="type">String</span> {
    <span class="comment">// SealedBox λ³µμ›</span>
    <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="type">SealedBox</span>(combined: encrypted)

    <span class="comment">// λ³µνΈν™”</span>
    <span class="kw">let</span> decryptedData = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">open</span>(sealedBox, using: key)

    <span class="kw">return</span> <span class="type">String</span>(data: decryptedData, encoding: .utf8)!
}

<span class="comment">// μ‚¬μ© μμ‹</span>
<span class="kw">let</span> key = <span class="type">SymmetricKey</span>(size: .bits256)  <span class="comment">// λλ¤ ν‚¤ μƒμ„±</span>
<span class="kw">let</span> message = <span class="str">"λΉ„λ°€ λ©”μ‹μ§€"</span>

<span class="kw">let</span> encrypted = <span class="kw">try</span> <span class="func">encryptData</span>(message, key: key)
<span class="kw">let</span> decrypted = <span class="kw">try</span> <span class="func">decryptData</span>(encrypted, key: key)

<span class="func">print</span>(decrypted)  <span class="comment">// "λΉ„λ°€ λ©”μ‹μ§€"</span></pre></div>

<h2>π”‘ λ€μΉ­ν‚¤ μ €μ¥ λ° κ΄€λ¦¬</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">KeyManagement.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>
<span class="kw">import</span> <span class="type">Foundation</span>

<span class="comment">// ν‚¤λ¥Ό Keychainμ— μ €μ¥</span>
<span class="kw">func</span> <span class="func">saveKey</span>(_ key: <span class="type">SymmetricKey</span>, tag: <span class="type">String</span>) <span class="kw">throws</span> {
    <span class="kw">let</span> keyData = key.withUnsafeBytes { <span class="type">Data</span>($0) }

    <span class="kw">let</span> query: [<span class="type">String</span>: <span class="type">Any</span>] = [
        kSecClass <span class="kw">as</span> <span class="type">String</span>: kSecClassGenericPassword,
        kSecAttrAccount <span class="kw">as</span> <span class="type">String</span>: tag,
        kSecValueData <span class="kw">as</span> <span class="type">String</span>: keyData
    ]

    <span class="kw">let</span> status = <span class="type">SecItemAdd</span>(query <span class="kw">as</span> <span class="type">CFDictionary</span>, <span class="kw">nil</span>)

    <span class="kw">guard</span> status == errSecSuccess <span class="kw">else</span> {
        <span class="kw">throw</span> <span class="type">NSError</span>(domain: <span class="str">"KeychainError"</span>, code: <span class="type">Int</span>(status))
    }
}

<span class="kw">func</span> <span class="func">loadKey</span>(tag: <span class="type">String</span>) <span class="kw">throws</span> -> <span class="type">SymmetricKey</span> {
    <span class="kw">let</span> query: [<span class="type">String</span>: <span class="type">Any</span>] = [
        kSecClass <span class="kw">as</span> <span class="type">String</span>: kSecClassGenericPassword,
        kSecAttrAccount <span class="kw">as</span> <span class="type">String</span>: tag,
        kSecReturnData <span class="kw">as</span> <span class="type">String</span>: <span class="kw">true</span>
    ]

    <span class="kw">var</span> item: <span class="type">CFTypeRef</span>?
    <span class="kw">let</span> status = <span class="type">SecItemCopyMatching</span>(query <span class="kw">as</span> <span class="type">CFDictionary</span>, &item)

    <span class="kw">guard</span> status == errSecSuccess,
          <span class="kw">let</span> keyData = item <span class="kw">as</span>? <span class="type">Data</span> <span class="kw">else</span> {
        <span class="kw">throw</span> <span class="type">NSError</span>(domain: <span class="str">"KeychainError"</span>, code: <span class="type">Int</span>(status))
    }

    <span class="kw">return</span> <span class="type">SymmetricKey</span>(data: keyData)
}

<span class="comment">// μ‚¬μ© μμ‹</span>
<span class="kw">let</span> key = <span class="type">SymmetricKey</span>(size: .bits256)
<span class="kw">try</span> <span class="func">saveKey</span>(key, tag: <span class="str">"MyEncryptionKey"</span>)

<span class="comment">// λ‚μ¤‘μ— ν‚¤ λ¶λ¬μ¤κΈ°</span>
<span class="kw">let</span> loadedKey = <span class="kw">try</span> <span class="func">loadKey</span>(tag: <span class="str">"MyEncryptionKey"</span>)</pre></div>

<h2>π κ³µκ°ν‚¤ μ•”νΈν™” (Curve25519)</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">PublicKeyEncryption.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// ν‚¤ μ μƒμ„±</span>
<span class="kw">let</span> alicePrivateKey = <span class="type">Curve25519</span>.<span class="type">KeyAgreement</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> alicePublicKey = alicePrivateKey.publicKey

<span class="kw">let</span> bobPrivateKey = <span class="type">Curve25519</span>.<span class="type">KeyAgreement</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> bobPublicKey = bobPrivateKey.publicKey

<span class="comment">// ECDH ν‚¤ κµν™</span>
<span class="kw">let</span> aliceSharedSecret = <span class="kw">try</span> alicePrivateKey.<span class="func">sharedSecretFromKeyAgreement</span>(with: bobPublicKey)
<span class="kw">let</span> bobSharedSecret = <span class="kw">try</span> bobPrivateKey.<span class="func">sharedSecretFromKeyAgreement</span>(with: alicePublicKey)

<span class="comment">// κ³µμ  λΉ„λ°€μ—μ„ λ€μΉ­ν‚¤ μƒμ„±</span>
<span class="kw">let</span> aliceSymmetricKey = aliceSharedSecret.<span class="func">hkdfDerivedSymmetricKey</span>(
    using: <span class="type">SHA256</span>.<span class="kw">self</span>,
    salt: <span class="type">Data</span>(),
    sharedInfo: <span class="type">Data</span>(<span class="str">"Encryption Key"</span>.utf8),
    outputByteCount: <span class="num">32</span>
)

<span class="kw">let</span> bobSymmetricKey = bobSharedSecret.<span class="func">hkdfDerivedSymmetricKey</span>(
    using: <span class="type">SHA256</span>.<span class="kw">self</span>,
    salt: <span class="type">Data</span>(),
    sharedInfo: <span class="type">Data</span>(<span class="str">"Encryption Key"</span>.utf8),
    outputByteCount: <span class="num">32</span>
)

<span class="comment">// μ΄μ  Aliceμ™€ Bobμ€ κ°™μ€ λ€μΉ­ν‚¤λ¥Ό κ°€μ§</span>
<span class="kw">let</span> message = <span class="str">"λΉ„λ°€ λ©”μ‹μ§€"</span>
<span class="kw">let</span> encrypted = <span class="kw">try</span> <span class="func">encryptData</span>(message, key: aliceSymmetricKey)
<span class="kw">let</span> decrypted = <span class="kw">try</span> <span class="func">decryptData</span>(encrypted, key: bobSymmetricKey)

<span class="func">print</span>(decrypted)  <span class="comment">// "λΉ„λ°€ λ©”μ‹μ§€"</span></pre></div>

<h2>βοΈ λ””μ§€ν„Έ μ„λ… (EdDSA)</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">DigitalSignature.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// μ„λ… ν‚¤ μƒμ„±</span>
<span class="kw">let</span> signingKey = <span class="type">Curve25519</span>.<span class="type">Signing</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> publicKey = signingKey.publicKey

<span class="comment">// λ°μ΄ν„° μ„λ…</span>
<span class="kw">func</span> <span class="func">signData</span>(_ data: <span class="type">Data</span>, with key: <span class="type">Curve25519</span>.<span class="type">Signing</span>.<span class="type">PrivateKey</span>) <span class="kw">throws</span> -> <span class="type">Data</span> {
    <span class="kw">let</span> signature = <span class="kw">try</span> key.<span class="func">signature</span>(for: data)
    <span class="kw">return</span> <span class="type">Data</span>(signature)
}

<span class="comment">// μ„λ… κ²€μ¦</span>
<span class="kw">func</span> <span class="func">verifySignature</span>(
    _ signature: <span class="type">Data</span>,
    for data: <span class="type">Data</span>,
    publicKey: <span class="type">Curve25519</span>.<span class="type">Signing</span>.<span class="type">PublicKey</span>
) -> <span class="type">Bool</span> {
    <span class="kw">do</span> {
        <span class="kw">return try</span> publicKey.<span class="func">isValidSignature</span>(signature, for: data)
    } <span class="kw">catch</span> {
        <span class="kw">return false</span>
    }
}

<span class="comment">// μ‚¬μ© μμ‹</span>
<span class="kw">let</span> document = <span class="type">Data</span>(<span class="str">"μ¤‘μ”ν• λ¬Έμ„"</span>.utf8)

<span class="comment">// μ„λ… μƒμ„±</span>
<span class="kw">let</span> signature = <span class="kw">try</span> <span class="func">signData</span>(document, with: signingKey)

<span class="comment">// μ„λ… κ²€μ¦</span>
<span class="kw">let</span> isValid = <span class="func">verifySignature</span>(signature, for: document, publicKey: publicKey)
<span class="func">print</span>(<span class="str">"μ„λ… μ ν¨: \(isValid)"</span>)  <span class="comment">// true</span>

<span class="comment">// λ¬Έμ„ λ³€μ΅° μ‹</span>
<span class="kw">let</span> tamperedDoc = <span class="type">Data</span>(<span class="str">"λ³€μ΅°λ λ¬Έμ„"</span>.utf8)
<span class="kw">let</span> isValid2 = <span class="func">verifySignature</span>(signature, for: tamperedDoc, publicKey: publicKey)
<span class="func">print</span>(<span class="str">"μ„λ… μ ν¨: \(isValid2)"</span>)  <span class="comment">// false</span></pre></div>

<h2>π“± SwiftUI ν†µν•©</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">EncryptionView.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="kw">struct</span> <span class="type">EncryptionDemoView</span>: <span class="type">View</span> {
    @<span class="type">State</span> <span class="kw">private var</span> plaintext = <span class="str">""</span>
    @<span class="type">State</span> <span class="kw">private var</span> encrypted = <span class="str">""</span>
    @<span class="type">State</span> <span class="kw">private var</span> decrypted = <span class="str">""</span>

    <span class="kw">let</span> <span class="prop">key</span> = <span class="type">SymmetricKey</span>(size: .bits256)

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">VStack</span>(spacing: <span class="num">20</span>) {
            <span class="type">Text</span>(<span class="str">"AES-GCM μ•”νΈν™”"</span>)
                .font(.title)
                .bold()

            <span class="type">TextField</span>(<span class="str">"μ•”νΈν™”ν•  ν…μ¤νΈ"</span>, text: $plaintext)
                .textFieldStyle(.roundedBorder)

            <span class="type">Button</span>(<span class="str">"μ•”νΈν™”"</span>) {
                <span class="func">encrypt</span>()
            }
            .buttonStyle(.borderedProminent)

            <span class="kw">if</span> !encrypted.isEmpty {
                <span class="type">VStack</span>(alignment: .leading, spacing: <span class="num">8</span>) {
                    <span class="type">Text</span>(<span class="str">"μ•”νΈν™”λ λ°μ΄ν„°:"</span>)
                        .font(.headline)
                    <span class="type">Text</span>(encrypted)
                        .font(.system(.caption, design: .monospaced))
                        .foregroundStyle(.secondary)
                        .textSelection(.enabled)
                }
                .padding()
                .background(.gray.opacity(<span class="num">0.1</span>))
                .cornerRadius(<span class="num">8</span>)

                <span class="type">Button</span>(<span class="str">"λ³µνΈν™”"</span>) {
                    <span class="func">decrypt</span>()
                }
                .buttonStyle(.bordered)

                <span class="kw">if</span> !decrypted.isEmpty {
                    <span class="type">Text</span>(<span class="str">"λ³µνΈν™” κ²°κ³Ό: \(decrypted)"</span>)
                        .font(.headline)
                        .foregroundStyle(.green)
                }
            }
        }
        .padding()
    }

    <span class="kw">func</span> <span class="func">encrypt</span>() {
        <span class="kw">guard</span> !plaintext.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="kw">let</span> data = <span class="type">Data</span>(plaintext.utf8)
            <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">seal</span>(data, using: key)
            encrypted = sealedBox.combined!.<span class="func">base64EncodedString</span>()
        } <span class="kw">catch</span> {
            encrypted = <span class="str">"μ•”νΈν™” μ‹¤ν¨: \(error)"</span>
        }
    }

    <span class="kw">func</span> <span class="func">decrypt</span>() {
        <span class="kw">guard let</span> data = <span class="type">Data</span>(base64Encoded: encrypted) <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">do</span> {
            <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="type">SealedBox</span>(combined: data)
            <span class="kw">let</span> decryptedData = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">open</span>(sealedBox, using: key)
            decrypted = <span class="type">String</span>(data: decryptedData, encoding: .utf8) ?? <span class="str">"μ¤λ¥"</span>
        } <span class="kw">catch</span> {
            decrypted = <span class="str">"λ³µνΈν™” μ‹¤ν¨"</span>
        }
    }
}</pre></div>

<h2>π” μ‹¤μ „ μμ : μ•μ „ν• λ…ΈνΈ μ•±</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">SecureNote.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// μ•”νΈν™”λ λ…ΈνΈ λ¨λΈ</span>
<span class="kw">struct</span> <span class="type">SecureNote</span>: <span class="type">Identifiable</span>, <span class="type">Codable</span> {
    <span class="kw">let</span> <span class="prop">id</span>: <span class="type">UUID</span>
    <span class="kw">let</span> <span class="prop">encryptedContent</span>: <span class="type">Data</span>
    <span class="kw">let</span> <span class="prop">createdAt</span>: <span class="type">Date</span>
}

<span class="kw">class</span> <span class="type">SecureNoteManager</span> {
    <span class="kw">private let</span> <span class="prop">key</span>: <span class="type">SymmetricKey</span>

    <span class="kw">init</span>() {
        <span class="comment">// μ•± μ‹μ‘ μ‹ ν‚¤ λ΅λ“ λλ” μƒμ„±</span>
        <span class="kw">if let</span> savedKey = <span class="kw">try</span>? <span class="func">loadKey</span>(tag: <span class="str">"SecureNoteKey"</span>) {
            key = savedKey
        } <span class="kw">else</span> {
            key = <span class="type">SymmetricKey</span>(size: .bits256)
            <span class="kw">try</span>? <span class="func">saveKey</span>(key, tag: <span class="str">"SecureNoteKey"</span>)
        }
    }

    <span class="kw">func</span> <span class="func">createNote</span>(_ content: <span class="type">String</span>) <span class="kw">throws</span> -> <span class="type">SecureNote</span> {
        <span class="kw">let</span> data = <span class="type">Data</span>(content.utf8)
        <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">seal</span>(data, using: key)

        <span class="kw">return</span> <span class="type">SecureNote</span>(
            id: <span class="type">UUID</span>(),
            encryptedContent: sealedBox.combined!,
            createdAt: <span class="type">Date</span>()
        )
    }

    <span class="kw">func</span> <span class="func">decryptNote</span>(_ note: <span class="type">SecureNote</span>) <span class="kw">throws</span> -> <span class="type">String</span> {
        <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="type">SealedBox</span>(combined: note.encryptedContent)
        <span class="kw">let</span> decryptedData = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">open</span>(sealedBox, using: key)
        <span class="kw">return</span> <span class="type">String</span>(data: decryptedData, encoding: .utf8) ?? <span class="str">""</span>
    }
}

<span class="comment">// SwiftUI View</span>
<span class="kw">struct</span> <span class="type">SecureNoteView</span>: <span class="type">View</span> {
    @<span class="type">State</span> <span class="kw">private var</span> notes: [<span class="type">SecureNote</span>] = []
    @<span class="type">State</span> <span class="kw">private var</span> newNoteContent = <span class="str">""</span>
    @<span class="type">State</span> <span class="kw">private var</span> selectedNote: <span class="type">SecureNote</span>?

    <span class="kw">let</span> <span class="prop">manager</span> = <span class="type">SecureNoteManager</span>()

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">NavigationStack</span> {
            <span class="type">List</span> {
                <span class="type">Section</span> {
                    <span class="type">TextField</span>(<span class="str">"μƒ λ…ΈνΈ λ‚΄μ©"</span>, text: $newNoteContent)
                    <span class="type">Button</span>(<span class="str">"μ €μ¥"</span>) {
                        <span class="func">saveNote</span>()
                    }
                    .disabled(newNoteContent.isEmpty)
                }

                <span class="type">Section</span>(<span class="str">"μ•”νΈν™”λ λ…ΈνΈ"</span>) {
                    <span class="type">ForEach</span>(notes) { note <span class="kw">in</span>
                        <span class="type">Button</span>(<span class="str">"λ…ΈνΈ \(note.id.uuidString.prefix(8))..."</span>) {
                            selectedNote = note
                        }
                    }
                }
            }
            .navigationTitle(<span class="str">"μ•μ „ν• λ…ΈνΈ"</span>)
            .sheet(item: $selectedNote) { note <span class="kw">in</span>
                <span class="type">NoteDetailView</span>(note: note, manager: manager)
            }
        }
    }

    <span class="kw">func</span> <span class="func">saveNote</span>() {
        <span class="kw">do</span> {
            <span class="kw">let</span> note = <span class="kw">try</span> manager.<span class="func">createNote</span>(newNoteContent)
            notes.append(note)
            newNoteContent = <span class="str">""</span>
        } <span class="kw">catch</span> {
            <span class="func">print</span>(<span class="str">"μ•”νΈν™” μ‹¤ν¨: \(error)"</span>)
        }
    }
}

<span class="kw">struct</span> <span class="type">NoteDetailView</span>: <span class="type">View</span> {
    <span class="kw">let</span> <span class="prop">note</span>: <span class="type">SecureNote</span>
    <span class="kw">let</span> <span class="prop">manager</span>: <span class="type">SecureNoteManager</span>

    <span class="kw">var</span> <span class="prop">body</span>: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">VStack</span> {
            <span class="kw">if let</span> content = <span class="kw">try</span>? manager.<span class="func">decryptNote</span>(note) {
                <span class="type">Text</span>(content)
                    .padding()
            } <span class="kw">else</span> {
                <span class="type">Text</span>(<span class="str">"λ³µνΈν™” μ‹¤ν¨"</span>)
                    .foregroundStyle(.red)
            }
        }
    }
}</pre></div>

<h2>π”‘ P-256 (NIST ν‘μ¤€ κ³΅μ„ )</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">P256Example.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// P-256 ECDSA μ„λ…</span>
<span class="kw">let</span> privateKey = <span class="type">P256</span>.<span class="type">Signing</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> publicKey = privateKey.publicKey

<span class="kw">let</span> data = <span class="type">Data</span>(<span class="str">"μ¤‘μ”ν• λ°μ΄ν„°"</span>.utf8)

<span class="comment">// μ„λ… μƒμ„±</span>
<span class="kw">let</span> signature = <span class="kw">try</span> privateKey.<span class="func">signature</span>(for: data)

<span class="comment">// μ„λ… κ²€μ¦</span>
<span class="kw">let</span> isValid = publicKey.<span class="func">isValidSignature</span>(signature, for: data)
<span class="func">print</span>(<span class="str">"P-256 μ„λ… μ ν¨: \(isValid)"</span>)

<span class="comment">// P-256 ν‚¤ κµν™</span>
<span class="kw">let</span> aliceKey = <span class="type">P256</span>.<span class="type">KeyAgreement</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> bobKey = <span class="type">P256</span>.<span class="type">KeyAgreement</span>.<span class="type">PrivateKey</span>()

<span class="kw">let</span> sharedSecret = <span class="kw">try</span> aliceKey.<span class="func">sharedSecretFromKeyAgreement</span>(with: bobKey.publicKey)
<span class="kw">let</span> symmetricKey = sharedSecret.<span class="func">hkdfDerivedSymmetricKey</span>(
    using: <span class="type">SHA256</span>.<span class="kw">self</span>,
    salt: <span class="type">Data</span>(),
    sharedInfo: <span class="type">Data</span>(),
    outputByteCount: <span class="num">32</span>
)</pre></div>

<h2>π”’ ChaCha20-Poly1305 μ•”νΈν™”</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">ChaCha20.swift</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// ChaCha20-Poly1305 (AES λ€μ•, λ¨λ°”μΌμ—μ„ λ” λΉ λ¦„)</span>
<span class="kw">func</span> <span class="func">encryptWithChaCha</span>(_ plaintext: <span class="type">String</span>, key: <span class="type">SymmetricKey</span>) <span class="kw">throws</span> -> <span class="type">Data</span> {
    <span class="kw">let</span> data = <span class="type">Data</span>(plaintext.utf8)
    <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">ChaChaPoly</span>.<span class="func">seal</span>(data, using: key)
    <span class="kw">return</span> sealedBox.combined
}

<span class="kw">func</span> <span class="func">decryptWithChaCha</span>(_ encrypted: <span class="type">Data</span>, key: <span class="type">SymmetricKey</span>) <span class="kw">throws</span> -> <span class="type">String</span> {
    <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">ChaChaPoly</span>.<span class="type">SealedBox</span>(combined: encrypted)
    <span class="kw">let</span> decryptedData = <span class="kw">try</span> <span class="type">ChaChaPoly</span>.<span class="func">open</span>(sealedBox, using: key)
    <span class="kw">return</span> <span class="type">String</span>(data: decryptedData, encoding: .utf8)!
}

<span class="comment">// μ‚¬μ© μμ‹</span>
<span class="kw">let</span> key = <span class="type">SymmetricKey</span>(size: .bits256)
<span class="kw">let</span> encrypted = <span class="kw">try</span> <span class="func">encryptWithChaCha</span>(<span class="str">"λΉ„λ°€ λ©”μ‹μ§€"</span>, key: key)
<span class="kw">let</span> decrypted = <span class="kw">try</span> <span class="func">decryptWithChaCha</span>(encrypted, key: key)</pre></div>

<h2>π’΅ HIG κ°€μ΄λ“λΌμΈ</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">λ³΄μ• κ¶μ¥μ‚¬ν•­</span></div>
<pre class="code-body"><span class="comment">β… DO
1. μ•”νΈν™” ν‚¤λ” Keychainμ— μ €μ¥
2. λ€μΉ­ν‚¤λ” 256λΉ„νΈ μ‚¬μ© (.bits256)
3. μ„λ… κ²€μ¦ ν•„μ (λ¬΄κ²°μ„± ν™•μΈ)
4. λ―Όκ°ν• λ°μ΄ν„°λ” λ©”λ¨λ¦¬μ—μ„ μ¦‰μ‹ μ κ±°
5. SHA-256 μ΄μƒ μ‚¬μ© (SHA-1 κΈμ§€)

β DON'T
1. ν•λ“μ½”λ”©λ μ•”νΈν™” ν‚¤
2. UserDefaultsμ— ν‚¤ μ €μ¥
3. μ»¤μ¤ν…€ μ•”νΈν™” μ•κ³ λ¦¬μ¦ κµ¬ν„
4. ν‰λ¬ΈμΌλ΅ λ„¤νΈμ›ν¬ μ „μ†΅
5. λ΅κ·Έμ— λ―Όκ°ν• λ°μ΄ν„° μ¶λ ¥</span></pre></div>

<h2>π”§ μ‹¤λ¬΄ ν™μ© ν</h2>
<div class="code-block"><div class="code-header"><span class="code-filename">μ‹¤μ „ ν¨ν„΄</span></div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CryptoKit</span>

<span class="comment">// 1. HMACμΌλ΅ λ©”μ‹μ§€ μΈμ¦</span>
<span class="kw">func</span> <span class="func">authenticateMessage</span>(_ message: <span class="type">String</span>, key: <span class="type">SymmetricKey</span>) -> <span class="type">Data</span> {
    <span class="kw">let</span> data = <span class="type">Data</span>(message.utf8)
    <span class="kw">let</span> authCode = <span class="type">HMAC</span>&lt;<span class="type">SHA256</span>&gt;.<span class="func">authenticationCode</span>(for: data, using: key)
    <span class="kw">return</span> <span class="type">Data</span>(authCode)
}

<span class="comment">// 2. λΉ„λ°€λ²νΈμ—μ„ ν‚¤ μƒμ„± (PBKDF2 λ€μ‹  Argon2 κ¶μ¥)</span>
<span class="kw">func</span> <span class="func">deriveKey</span>(from password: <span class="type">String</span>, salt: <span class="type">Data</span>) -> <span class="type">SymmetricKey</span> {
    <span class="kw">let</span> passwordData = <span class="type">Data</span>(password.utf8)
    <span class="kw">let</span> hash = <span class="type">SHA256</span>.<span class="func">hash</span>(data: passwordData + salt)
    <span class="kw">return</span> <span class="type">SymmetricKey</span>(data: hash)
}

<span class="comment">// 3. νμΌ μ•”νΈν™”</span>
<span class="kw">func</span> <span class="func">encryptFile</span>(at url: <span class="type">URL</span>, key: <span class="type">SymmetricKey</span>) <span class="kw">throws</span> {
    <span class="kw">let</span> data = <span class="kw">try</span> <span class="type">Data</span>(contentsOf: url)
    <span class="kw">let</span> sealedBox = <span class="kw">try</span> <span class="type">AES</span>.<span class="type">GCM</span>.<span class="func">seal</span>(data, using: key)
    <span class="kw">try</span> sealedBox.combined!.<span class="func">write</span>(to: url.appendingPathExtension(<span class="str">"encrypted"</span>))
}

<span class="comment">// 4. κ³µκ°ν‚¤λ¥Ό Dataλ΅ λ³€ν™ (μ „μ†΅μ©)</span>
<span class="kw">let</span> privateKey = <span class="type">Curve25519</span>.<span class="type">Signing</span>.<span class="type">PrivateKey</span>()
<span class="kw">let</span> publicKeyData = privateKey.publicKey.rawRepresentation

<span class="comment">// Dataμ—μ„ κ³µκ°ν‚¤ λ³µμ›</span>
<span class="kw">let</span> restoredPublicKey = <span class="kw">try</span> <span class="type">Curve25519</span>.<span class="type">Signing</span>.<span class="type">PublicKey</span>(rawRepresentation: publicKeyData)</pre></div>

<p style="background:#34c75910;border:1px solid #34c75940;border-radius:12px;padding:16px 20px;margin:24px 0"><strong style="color:#34c759">π’΅ CryptoKit ν•µμ‹¬</strong><br>
β… Swift λ„¤μ΄ν‹°λΈ μ•”νΈν™” ν”„λ μ„μ›ν¬<br>
β… Secure Enclave ν™μ©<br>
β… AES-GCM, ChaCha20-Poly1305 μ§€μ›<br>
β… Curve25519, P-256 κ³µκ°ν‚¤ μ•”νΈν™”<br>
β… λ””μ§€ν„Έ μ„λ… λ° ν‚¤ κµν™</p>

<h2>π“¦ ν•™μµ μλ£</h2>
<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin:24px 0">
<a href="https://github.com/M1zz/HIGLab" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">π’»</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">GitHub ν”„λ΅μ νΈ</div>
</a>
<a href="https://developer.apple.com/documentation/cryptokit" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">π“–</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">Apple κ³µμ‹ λ¬Έμ„</div>
</a>
<a href="https://developer.apple.com/videos/play/wwdc2019/709/" style="background:#fff;border:1px solid #d2d2d7;border-radius:12px;padding:20px;text-decoration:none;color:inherit;text-align:center">
<div style="font-size:28px">π¥</div>
<div style="font-size:13px;font-weight:600;color:#0071e3;margin-top:8px">WWDC 2019</div>
</a>
</div>

</article>
</body>
</html>
