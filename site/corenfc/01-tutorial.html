<!DOCTYPE html>
<html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ“± Core NFC â€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--code-bg:#1e1e2e;--border:#d2d2d7}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(28px,5vw,40px);font-weight:900;margin-bottom:16px;letter-spacing:-1px}
h2{font-size:24px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.subtitle{font-size:18px;color:var(--text-2);margin-bottom:32px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:12px;color:#6e6e73;font-weight:600}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;color:#cdd6f4;white-space:pre;overflow-x:auto}
.kw{color:#cba6f7}.type{color:#89b4fa}.str{color:#a6e3a1}.comment{color:#6c7086}
.badge{display:inline-block;padding:4px 12px;border-radius:16px;font-size:13px;font-weight:600;margin:0 4px 8px 0}
.badge.ios{background:#0071e3;color:#fff}.badge.new{background:#34c759;color:#fff}
ul{margin:16px 0 16px 24px}li{margin:8px 0}
.info-box{background:#f5f5f7;border-left:4px solid var(--accent);padding:16px;margin:24px 0;border-radius:8px}
</style></head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="01-tutorial.en.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">ğŸŒ EN</a></div></div>
<article>
<h1>ğŸ“± Core NFC</h1>
<!-- higlab-metadata -->
<div style="display:flex;gap:16px;align-items:center;margin:12px 0 24px;padding:12px 16px;background:var(--tag-bg,#f5f5f7);border-radius:10px;font-size:13px;color:var(--text-2,#6e6e73);flex-wrap:wrap;">
  <span>â­ ë‚œì´ë„: â­â­â­</span>
  <span>â±ï¸ ì˜ˆìƒ ì‹œê°„: 2h</span>
  <span>ğŸ“‚ System & Network</span>
</div>
<p class="subtitle">NFC íƒœê·¸ ì½ê¸°/ì“°ê¸° ë° NDEF ë©”ì‹œì§€ ì²˜ë¦¬ í”„ë ˆì„ì›Œí¬</p>

<div><span class="badge ios">iOS 11+</span><span class="badge new">NDEF ì½ê¸°/ì“°ê¸°</span></div>

<h2>âœ¨ Core NFCë€?</h2>
<p>Core NFCëŠ” iPhoneì˜ NFC ì¹©ì„ ì‚¬ìš©í•˜ì—¬ NFC íƒœê·¸ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆëŠ” í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. NDEF(NFC Data Exchange Format) ë©”ì‹œì§€ë¥¼ ì½ì–´ URL, í…ìŠ¤íŠ¸, ì—°ë½ì²˜ ì •ë³´ ë“±ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ íƒœê·¸ì— ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Apple Payë¥¼ ì œì™¸í•œ ëª¨ë“  NFC í™œìš© ì‚¬ë¡€ì— ì‚¬ìš©ë˜ë©°, iPhone 7 ì´ìƒì—ì„œ ì§€ì›ë©ë‹ˆë‹¤.</p>

<div class="info-box">
<strong>ğŸ’¡ í•µì‹¬ ê¸°ëŠ¥:</strong> NDEF íƒœê·¸ ì½ê¸° Â· íƒœê·¸ ì“°ê¸°(iOS 13+) Â· URL/í…ìŠ¤íŠ¸ íŒŒì‹± Â· ë‹¤ì¤‘ ë ˆì½”ë“œ ì§€ì› Â· ë°±ê·¸ë¼ìš´ë“œ íƒœê·¸ ì½ê¸° Â· ISO 7816/ISO 15693 ì§€ì›
</div>

<h2>ğŸ“– 1. NDEF íƒœê·¸ ì½ê¸°</h2>
<p>NFCNDEFReaderSessionì„ ì‚¬ìš©í•˜ì—¬ NFC íƒœê·¸ë¥¼ ìŠ¤ìº”í•˜ê³  NDEF ë©”ì‹œì§€ë¥¼ ì½ìŠµë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">NFCReaderManager.swift â€” NFC íƒœê·¸ ì½ê¸°</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreNFC</span>
<span class="kw">import</span> <span class="type">SwiftUI</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">NFCReaderManager</span>: <span class="type">NSObject</span> {
    <span class="kw">var</span> session: <span class="type">NFCNDEFReaderSession</span>?
    <span class="kw">var</span> detectedMessages: [<span class="type">NFCNDEFMessage</span>] = []
    <span class="kw">var</span> isScanning = <span class="kw">false</span>
    <span class="kw">var</span> lastError: <span class="type">String</span>?

    <span class="comment">// NFC ì§€ì› ì—¬ë¶€ í™•ì¸</span>
    <span class="kw">var</span> isNFCAvailable: <span class="type">Bool</span> {
        <span class="type">NFCNDEFReaderSession</span>.readingAvailable
    }

    <span class="comment">// íƒœê·¸ ì½ê¸° ì‹œì‘</span>
    <span class="kw">func</span> startScanning() {
        <span class="kw">guard</span> isNFCAvailable <span class="kw">else</span> {
            lastError = <span class="str">"ì´ ê¸°ê¸°ëŠ” NFCë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"</span>
            print(<span class="str">"âŒ NFC ë¯¸ì§€ì›"</span>)
            <span class="kw">return</span>
        }

        detectedMessages.removeAll()
        lastError = <span class="kw">nil</span>

        <span class="comment">// NDEF Reader Session ìƒì„±</span>
        session = <span class="type">NFCNDEFReaderSession</span>(
            delegate: <span class="kw">self</span>,
            queue: <span class="kw">nil</span>,
            invalidateAfterFirstRead: <span class="kw">false</span>
        )

        <span class="comment">// ì‚¬ìš©ìì—ê²Œ í‘œì‹œë  ë©”ì‹œì§€</span>
        session?.alertMessage = <span class="str">"NFC íƒœê·¸ë¥¼ iPhone ìƒë‹¨ì— ê°€ê¹Œì´ ëŒ€ì£¼ì„¸ìš”"</span>

        <span class="comment">// ìŠ¤ìº” ì‹œì‘</span>
        session?.begin()
        isScanning = <span class="kw">true</span>

        print(<span class="str">"ğŸ” NFC ìŠ¤ìº” ì‹œì‘"</span>)
    }

    <span class="comment">// ìŠ¤ìº” ì¤‘ì§€</span>
    <span class="kw">func</span> stopScanning() {
        session?.invalidate()
        isScanning = <span class="kw">false</span>
        print(<span class="str">"â¹ï¸ NFC ìŠ¤ìº” ì¤‘ì§€"</span>)
    }

    <span class="comment">// NDEF ë ˆì½”ë“œ íŒŒì‹±</span>
    <span class="kw">func</span> parseNDEFRecords(from message: <span class="type">NFCNDEFMessage</span>) -> [<span class="type">String</span>] {
        <span class="kw">var</span> results: [<span class="type">String</span>] = []

        <span class="kw">for</span> record <span class="kw">in</span> message.records {
            <span class="comment">// Type Name Format</span>
            <span class="kw">let</span> tnf = record.typeNameFormat

            <span class="kw">switch</span> tnf {
            <span class="kw">case</span> .nfcWellKnown:
                <span class="comment">// URI ë ˆì½”ë“œ</span>
                <span class="kw">if</span> <span class="kw">let</span> url = record.wellKnownTypeURIPayload() {
                    results.append(<span class="str">"ğŸ”— URL: \(url.absoluteString)"</span>)
                }
                <span class="comment">// Text ë ˆì½”ë“œ</span>
                <span class="kw">else</span> <span class="kw">if</span> <span class="kw">let</span> text = <span class="type">String</span>(data: record.payload, encoding: .utf8) {
                    results.append(<span class="str">"ğŸ“ Text: \(text)"</span>)
                }

            <span class="kw">case</span> .absoluteURI:
                <span class="kw">if</span> <span class="kw">let</span> text = <span class="type">String</span>(data: record.payload, encoding: .utf8) {
                    results.append(<span class="str">"ğŸŒ URI: \(text)"</span>)
                }

            <span class="kw">case</span> .media:
                <span class="kw">let</span> mimeType = <span class="type">String</span>(data: record.type, encoding: .utf8) ?? <span class="str">"unknown"</span>
                results.append(<span class="str">"ğŸ“„ Media Type: \(mimeType)"</span>)

            <span class="kw">case</span> .empty:
                results.append(<span class="str">"âšªï¸ Empty record"</span>)

            <span class="kw">@unknown</span> <span class="kw">default</span>:
                results.append(<span class="str">"â“ Unknown record type"</span>)
            }

            <span class="comment">// Payload í¬ê¸°</span>
            results.append(<span class="str">"  Size: \(record.payload.count) bytes"</span>)
        }

        <span class="kw">return</span> results
    }
}</pre>
</div>

<h2>ğŸ“¡ 2. NDEF Reader ë¸ë¦¬ê²Œì´íŠ¸</h2>
<p>íƒœê·¸ ë°œê²¬ ë° ë©”ì‹œì§€ ì½ê¸°ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">NFCReaderManager+Delegate.swift â€” Reader ë¸ë¦¬ê²Œì´íŠ¸</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreNFC</span>

<span class="kw">extension</span> <span class="type">NFCReaderManager</span>: <span class="type">NFCNDEFReaderSessionDelegate</span> {
    <span class="comment">// íƒœê·¸ ë°œê²¬</span>
    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didDetectNDEFs messages: [<span class="type">NFCNDEFMessage</span>]) {
        print(<span class="str">"ğŸ“± íƒœê·¸ ë°œê²¬! ë©”ì‹œì§€ ê°œìˆ˜: \(messages.count)"</span>)

        <span class="comment">// ë©”ì‹œì§€ ì €ì¥</span>
        detectedMessages.append(contentsOf: messages)

        <span class="comment">// ê° ë©”ì‹œì§€ ì²˜ë¦¬</span>
        <span class="kw">for</span> (index, message) <span class="kw">in</span> messages.enumerated() {
            print(<span class="str">"  ë©”ì‹œì§€ \(index + 1): \(message.records.count)ê°œ ë ˆì½”ë“œ"</span>)

            <span class="kw">for</span> (recordIndex, record) <span class="kw">in</span> message.records.enumerated() {
                print(<span class="str">"    ë ˆì½”ë“œ \(recordIndex + 1):"</span>)

                <span class="comment">// URL íŒŒì‹±</span>
                <span class="kw">if</span> <span class="kw">let</span> url = record.wellKnownTypeURIPayload() {
                    print(<span class="str">"      ğŸ”— URL: \(url.absoluteString)"</span>)
                }

                <span class="comment">// Text íŒŒì‹±</span>
                <span class="kw">if</span> <span class="kw">let</span> text = parseTextPayload(record.payload) {
                    print(<span class="str">"      ğŸ“ Text: \(text)"</span>)
                }
            }
        }

        <span class="comment">// ì„±ê³µ ë©”ì‹œì§€</span>
        session.alertMessage = <span class="str">"âœ… \(messages.count)ê°œ ë©”ì‹œì§€ë¥¼ ì½ì—ˆìŠµë‹ˆë‹¤"</span>
    }

    <span class="comment">// íƒœê·¸ ë°œê²¬ (ê³ ê¸‰ API)</span>
    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didDetect tags: [<span class="type">NFCNDEFTag</span>]) {
        <span class="kw">guard</span> tags.count == <span class="str">1</span> <span class="kw">else</span> {
            session.alertMessage = <span class="str">"âš ï¸ íƒœê·¸ê°€ ë„ˆë¬´ ë§ìŠµë‹ˆë‹¤. í•˜ë‚˜ë§Œ ê°€ê¹Œì´ ëŒ€ì£¼ì„¸ìš”"</span>
            session.restartPolling()
            <span class="kw">return</span>
        }

        <span class="kw">let</span> tag = tags.first!

        <span class="comment">// íƒœê·¸ ì—°ê²°</span>
        session.connect(to: tag) { error <span class="kw">in</span>
            <span class="kw">if</span> <span class="kw">let</span> error = error {
                session.invalidate(errorMessage: <span class="str">"âŒ íƒœê·¸ ì—°ê²° ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                <span class="kw">return</span>
            }

            print(<span class="str">"âœ… íƒœê·¸ ì—°ê²° ì„±ê³µ"</span>)

            <span class="comment">// NDEF ë©”ì‹œì§€ ì½ê¸°</span>
            tag.queryNDEFStatus { status, capacity, error <span class="kw">in</span>
                <span class="kw">if</span> <span class="kw">let</span> error = error {
                    session.invalidate(errorMessage: <span class="str">"âŒ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                    <span class="kw">return</span>
                }

                print(<span class="str">"ğŸ“Š íƒœê·¸ ìƒíƒœ: \(status.rawValue), ìš©ëŸ‰: \(capacity) bytes"</span>)

                <span class="kw">switch</span> status {
                <span class="kw">case</span> .notSupported:
                    session.invalidate(errorMessage: <span class="str">"âŒ NDEFë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” íƒœê·¸ì…ë‹ˆë‹¤"</span>)

                <span class="kw">case</span> .readOnly:
                    <span class="kw">self</span>.readNDEFMessage(from: tag, session: session)

                <span class="kw">case</span> .readWrite:
                    <span class="kw">self</span>.readNDEFMessage(from: tag, session: session)

                <span class="kw">@unknown</span> <span class="kw">default</span>:
                    session.invalidate(errorMessage: <span class="str">"â“ ì•Œ ìˆ˜ ì—†ëŠ” íƒœê·¸ ìƒíƒœ"</span>)
                }
            }
        }
    }

    <span class="comment">// NDEF ë©”ì‹œì§€ ì½ê¸°</span>
    <span class="kw">private</span> <span class="kw">func</span> readNDEFMessage(from tag: <span class="type">NFCNDEFTag</span>, session: <span class="type">NFCNDEFReaderSession</span>) {
        tag.readNDEF { message, error <span class="kw">in</span>
            <span class="kw">if</span> <span class="kw">let</span> error = error {
                session.invalidate(errorMessage: <span class="str">"âŒ ì½ê¸° ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                <span class="kw">return</span>
            }

            <span class="kw">if</span> <span class="kw">let</span> message = message {
                <span class="kw">self</span>.detectedMessages.append(message)
                session.alertMessage = <span class="str">"âœ… \(message.records.count)ê°œ ë ˆì½”ë“œë¥¼ ì½ì—ˆìŠµë‹ˆë‹¤"</span>
                print(<span class="str">"ğŸ“– NDEF ë©”ì‹œì§€ ì½ê¸° ì„±ê³µ"</span>)
            }

            session.invalidate()
        }
    }

    <span class="comment">// ì„¸ì…˜ ë¬´íš¨í™”</span>
    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didInvalidateWithError error: <span class="type">Error</span>) {
        isScanning = <span class="kw">false</span>

        <span class="kw">if</span> <span class="kw">let</span> nfcError = error <span class="kw">as</span>? <span class="type">NFCReaderError</span> {
            <span class="kw">switch</span> nfcError.code {
            <span class="kw">case</span> .readerSessionInvalidationErrorUserCanceled:
                print(<span class="str">"â¹ï¸ ì‚¬ìš©ìê°€ ìŠ¤ìº”ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤"</span>)
            <span class="kw">case</span> .readerSessionInvalidationErrorSessionTimeout:
                print(<span class="str">"â±ï¸ ì„¸ì…˜ ì‹œê°„ ì´ˆê³¼"</span>)
                lastError = <span class="str">"ìŠ¤ìº” ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤"</span>
            <span class="kw">case</span> .readerSessionInvalidationErrorFirstNDEFTagRead:
                print(<span class="str">"âœ… ì²« ë²ˆì§¸ íƒœê·¸ ì½ê¸° ì™„ë£Œ"</span>)
            <span class="kw">default</span>:
                print(<span class="str">"âŒ NFC ì—ëŸ¬: \(nfcError.localizedDescription)"</span>)
                lastError = nfcError.localizedDescription
            }
        } <span class="kw">else</span> {
            print(<span class="str">"âŒ ì—ëŸ¬: \(error.localizedDescription)"</span>)
            lastError = error.localizedDescription
        }
    }

    <span class="comment">// Text Payload íŒŒì‹±</span>
    <span class="kw">private</span> <span class="kw">func</span> parseTextPayload(<span class="kw">_</span> payload: <span class="type">Data</span>) -> <span class="type">String</span>? {
        <span class="kw">guard</span> payload.count > <span class="str">1</span> <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// Status byte: bit 7 = UTF-16 ì—¬ë¶€, bit 0-5 = ì–¸ì–´ ì½”ë“œ ê¸¸ì´</span>
        <span class="kw">let</span> statusByte = payload[<span class="str">0</span>]
        <span class="kw">let</span> isUTF16 = (statusByte & <span class="str">0x80</span>) != <span class="str">0</span>
        <span class="kw">let</span> langCodeLength = <span class="type">Int</span>(statusByte & <span class="str">0x3F</span>)

        <span class="kw">guard</span> payload.count > langCodeLength + <span class="str">1</span> <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// í…ìŠ¤íŠ¸ ì¶”ì¶œ</span>
        <span class="kw">let</span> textData = payload.subdata(in: (<span class="str">1</span> + langCodeLength)..<<span class="type">payload</span>.count)
        <span class="kw">let</span> encoding: <span class="type">String</span>.<span class="type">Encoding</span> = isUTF16 ? .utf16 : .utf8

        <span class="kw">return</span> <span class="type">String</span>(data: textData, encoding: encoding)
    }
}</pre>
</div>

<h2>âœï¸ 3. NFC íƒœê·¸ ì“°ê¸°</h2>
<p>NDEF ë©”ì‹œì§€ë¥¼ íƒœê·¸ì— ì”ë‹ˆë‹¤ (iOS 13+).</p>

<div class="code-block">
<div class="code-header">NFCWriterManager.swift â€” NFC íƒœê·¸ ì“°ê¸°</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreNFC</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">NFCWriterManager</span>: <span class="type">NSObject</span> {
    <span class="kw">var</span> session: <span class="type">NFCNDEFReaderSession</span>?
    <span class="kw">var</span> messageToWrite: <span class="type">NFCNDEFMessage</span>?
    <span class="kw">var</span> writeSuccess = <span class="kw">false</span>

    <span class="comment">// URLì„ íƒœê·¸ì— ì“°ê¸°</span>
    <span class="kw">func</span> writeURL(<span class="kw">_</span> url: <span class="type">URL</span>) {
        <span class="kw">guard</span> <span class="type">NFCNDEFReaderSession</span>.readingAvailable <span class="kw">else</span> {
            print(<span class="str">"âŒ NFC ë¯¸ì§€ì›"</span>)
            <span class="kw">return</span>
        }

        <span class="comment">// NDEF Payload ìƒì„±</span>
        <span class="kw">guard</span> <span class="kw">let</span> payload = <span class="type">NFCNDEFPayload</span>.wellKnownTypeURIPayload(url: url) <span class="kw">else</span> {
            print(<span class="str">"âŒ Payload ìƒì„± ì‹¤íŒ¨"</span>)
            <span class="kw">return</span>
        }

        messageToWrite = <span class="type">NFCNDEFMessage</span>(records: [payload])

        <span class="comment">// ì„¸ì…˜ ì‹œì‘</span>
        session = <span class="type">NFCNDEFReaderSession</span>(delegate: <span class="kw">self</span>, queue: <span class="kw">nil</span>, invalidateAfterFirstRead: <span class="kw">false</span>)
        session?.alertMessage = <span class="str">"ì“°ê¸°ë¥¼ ì›í•˜ëŠ” NFC íƒœê·¸ë¥¼ ê°€ê¹Œì´ ëŒ€ì£¼ì„¸ìš”"</span>
        session?.begin()

        print(<span class="str">"âœï¸ URL ì“°ê¸° ì‹œì‘: \(url.absoluteString)"</span>)
    }

    <span class="comment">// í…ìŠ¤íŠ¸ë¥¼ íƒœê·¸ì— ì“°ê¸°</span>
    <span class="kw">func</span> writeText(<span class="kw">_</span> text: <span class="type">String</span>) {
        <span class="kw">guard</span> <span class="type">NFCNDEFReaderSession</span>.readingAvailable <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="comment">// Text Payload ìƒì„±</span>
        <span class="kw">guard</span> <span class="kw">let</span> payload = createTextPayload(text: text, languageCode: <span class="str">"en"</span>) <span class="kw">else</span> {
            print(<span class="str">"âŒ Text Payload ìƒì„± ì‹¤íŒ¨"</span>)
            <span class="kw">return</span>
        }

        messageToWrite = <span class="type">NFCNDEFMessage</span>(records: [payload])

        session = <span class="type">NFCNDEFReaderSession</span>(delegate: <span class="kw">self</span>, queue: <span class="kw">nil</span>, invalidateAfterFirstRead: <span class="kw">false</span>)
        session?.alertMessage = <span class="str">"ì“°ê¸°ë¥¼ ì›í•˜ëŠ” NFC íƒœê·¸ë¥¼ ê°€ê¹Œì´ ëŒ€ì£¼ì„¸ìš”"</span>
        session?.begin()

        print(<span class="str">"âœï¸ í…ìŠ¤íŠ¸ ì“°ê¸° ì‹œì‘: \(text)"</span>)
    }

    <span class="comment">// ì—¬ëŸ¬ ë ˆì½”ë“œë¥¼ íƒœê·¸ì— ì“°ê¸°</span>
    <span class="kw">func</span> writeMultipleRecords(url: <span class="type">URL</span>, text: <span class="type">String</span>) {
        <span class="kw">guard</span> <span class="type">NFCNDEFReaderSession</span>.readingAvailable <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">var</span> records: [<span class="type">NFCNDEFPayload</span>] = []

        <span class="comment">// URL Payload</span>
        <span class="kw">if</span> <span class="kw">let</span> urlPayload = <span class="type">NFCNDEFPayload</span>.wellKnownTypeURIPayload(url: url) {
            records.append(urlPayload)
        }

        <span class="comment">// Text Payload</span>
        <span class="kw">if</span> <span class="kw">let</span> textPayload = createTextPayload(text: text, languageCode: <span class="str">"en"</span>) {
            records.append(textPayload)
        }

        messageToWrite = <span class="type">NFCNDEFMessage</span>(records: records)

        session = <span class="type">NFCNDEFReaderSession</span>(delegate: <span class="kw">self</span>, queue: <span class="kw">nil</span>, invalidateAfterFirstRead: <span class="kw">false</span>)
        session?.alertMessage = <span class="str">"ì“°ê¸°ë¥¼ ì›í•˜ëŠ” NFC íƒœê·¸ë¥¼ ê°€ê¹Œì´ ëŒ€ì£¼ì„¸ìš”"</span>
        session?.begin()

        print(<span class="str">"âœï¸ ë‹¤ì¤‘ ë ˆì½”ë“œ ì“°ê¸° ì‹œì‘"</span>)
    }

    <span class="comment">// Text Payload ìƒì„±</span>
    <span class="kw">private</span> <span class="kw">func</span> createTextPayload(text: <span class="type">String</span>, languageCode: <span class="type">String</span>) -> <span class="type">NFCNDEFPayload</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> textData = text.data(using: .utf8) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }
        <span class="kw">guard</span> <span class="kw">let</span> langData = languageCode.data(using: .utf8) <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }

        <span class="comment">// Status byte: UTF-8, ì–¸ì–´ ì½”ë“œ ê¸¸ì´</span>
        <span class="kw">var</span> payload = <span class="type">Data</span>()
        payload.append(<span class="type">UInt8</span>(langData.count))
        payload.append(langData)
        payload.append(textData)

        <span class="kw">return</span> <span class="type">NFCNDEFPayload</span>(
            format: .nfcWellKnown,
            type: <span class="str">"T"</span>.data(using: .utf8)!,
            identifier: <span class="type">Data</span>(),
            payload: payload
        )
    }
}

<span class="kw">extension</span> <span class="type">NFCWriterManager</span>: <span class="type">NFCNDEFReaderSessionDelegate</span> {
    <span class="comment">// íƒœê·¸ ë°œê²¬ (ì“°ê¸°ìš©)</span>
    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didDetect tags: [<span class="type">NFCNDEFTag</span>]) {
        <span class="kw">guard</span> tags.count == <span class="str">1</span>, <span class="kw">let</span> tag = tags.first <span class="kw">else</span> {
            session.alertMessage = <span class="str">"âš ï¸ íƒœê·¸ê°€ ë„ˆë¬´ ë§ìŠµë‹ˆë‹¤"</span>
            session.restartPolling()
            <span class="kw">return</span>
        }

        session.connect(to: tag) { error <span class="kw">in</span>
            <span class="kw">if</span> <span class="kw">let</span> error = error {
                session.invalidate(errorMessage: <span class="str">"âŒ ì—°ê²° ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                <span class="kw">return</span>
            }

            <span class="comment">// íƒœê·¸ ìƒíƒœ í™•ì¸</span>
            tag.queryNDEFStatus { status, capacity, error <span class="kw">in</span>
                <span class="kw">if</span> <span class="kw">let</span> error = error {
                    session.invalidate(errorMessage: <span class="str">"âŒ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                    <span class="kw">return</span>
                }

                <span class="kw">guard</span> status == .readWrite <span class="kw">else</span> {
                    session.invalidate(errorMessage: <span class="str">"âŒ ì½ê¸° ì „ìš© íƒœê·¸ì…ë‹ˆë‹¤"</span>)
                    <span class="kw">return</span>
                }

                <span class="comment">// ë©”ì‹œì§€ ì“°ê¸°</span>
                <span class="kw">guard</span> <span class="kw">let</span> message = <span class="kw">self</span>.messageToWrite <span class="kw">else</span> {
                    session.invalidate(errorMessage: <span class="str">"âŒ ì“¸ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤"</span>)
                    <span class="kw">return</span>
                }

                tag.writeNDEF(message) { error <span class="kw">in</span>
                    <span class="kw">if</span> <span class="kw">let</span> error = error {
                        session.invalidate(errorMessage: <span class="str">"âŒ ì“°ê¸° ì‹¤íŒ¨: \(error.localizedDescription)"</span>)
                    } <span class="kw">else</span> {
                        session.alertMessage = <span class="str">"âœ… ì“°ê¸° ì„±ê³µ!"</span>
                        <span class="kw">self</span>.writeSuccess = <span class="kw">true</span>
                        print(<span class="str">"âœ… NFC íƒœê·¸ ì“°ê¸° ì™„ë£Œ"</span>)
                        session.invalidate()
                    }
                }
            }
        }
    }

    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didDetectNDEFs messages: [<span class="type">NFCNDEFMessage</span>]) {
        <span class="comment">// ì“°ê¸° ëª¨ë“œì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ</span>
    }

    <span class="kw">func</span> readerSession(<span class="kw">_</span> session: <span class="type">NFCNDEFReaderSession</span>, didInvalidateWithError error: <span class="type">Error</span>) {
        <span class="kw">if</span> <span class="kw">let</span> nfcError = error <span class="kw">as</span>? <span class="type">NFCReaderError</span>,
           nfcError.code != .readerSessionInvalidationErrorUserCanceled {
            print(<span class="str">"âŒ ì„¸ì…˜ ì¢…ë£Œ: \(error.localizedDescription)"</span>)
        }
    }
}</pre>
</div>

<h2>ğŸ“± 4. SwiftUI í†µí•©</h2>
<p>NFC ë¦¬ë”/ë¼ì´í„° UIë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">NFCReaderView.swift â€” NFC UI</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>

<span class="kw">struct</span> <span class="type">NFCReaderView</span>: <span class="type">View</span> {
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> readerManager = <span class="type">NFCReaderManager</span>()
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> writerManager = <span class="type">NFCWriterManager</span>()
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> urlText = <span class="str">"https://developer.apple.com"</span>
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> writeText = <span class="str">"Hello NFC!"</span>

    <span class="kw">var</span> body: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">NavigationStack</span> {
            <span class="type">Form</span> {
                <span class="comment">// ì½ê¸° ì„¹ì…˜</span>
                <span class="type">Section</span>(<span class="str">"íƒœê·¸ ì½ê¸°"</span>) {
                    <span class="type">Button</span> {
                        readerManager.startScanning()
                    } label: {
                        <span class="type">Label</span>(<span class="str">"NFC íƒœê·¸ ìŠ¤ìº”"</span>, systemImage: <span class="str">"wave.3.right"</span>)
                    }
                    .disabled(!readerManager.isNFCAvailable || readerManager.isScanning)

                    <span class="kw">if</span> readerManager.isScanning {
                        <span class="type">HStack</span> {
                            <span class="type">ProgressView</span>()
                            <span class="type">Text</span>(<span class="str">"ìŠ¤ìº” ì¤‘..."</span>)
                                .foregroundStyle(.secondary)
                        }
                    }
                }

                <span class="comment">// ì½ì€ ë©”ì‹œì§€</span>
                <span class="kw">if</span> !readerManager.detectedMessages.isEmpty {
                    <span class="type">Section</span>(<span class="str">"ìŠ¤ìº” ê²°ê³¼"</span>) {
                        <span class="type">ForEach</span>(readerManager.detectedMessages.indices, id: \.self) { index <span class="kw">in</span>
                            <span class="kw">let</span> message = readerManager.detectedMessages[index]
                            <span class="type">VStack</span>(alignment: .leading, spacing: <span class="str">8</span>) {
                                <span class="type">Text</span>(<span class="str">"ë©”ì‹œì§€ \(index + 1)"</span>)
                                    .font(.headline)

                                <span class="type">ForEach</span>(readerManager.parseNDEFRecords(from: message), id: \.self) { record <span class="kw">in</span>
                                    <span class="type">Text</span>(record)
                                        .font(.caption)
                                        .foregroundStyle(.secondary)
                                }
                            }
                        }
                    }
                }

                <span class="comment">// ì“°ê¸° ì„¹ì…˜</span>
                <span class="type">Section</span>(<span class="str">"íƒœê·¸ ì“°ê¸°"</span>) {
                    <span class="type">TextField</span>(<span class="str">"URL"</span>, text: $urlText)
                        .keyboardType(.URL)
                        .autocapitalization(.none)

                    <span class="type">Button</span> {
                        <span class="kw">if</span> <span class="kw">let</span> url = <span class="type">URL</span>(string: urlText) {
                            writerManager.writeURL(url)
                        }
                    } label: {
                        <span class="type">Label</span>(<span class="str">"URL ì“°ê¸°"</span>, systemImage: <span class="str">"link"</span>)
                    }
                    .disabled(!readerManager.isNFCAvailable)

                    <span class="type">TextField</span>(<span class="str">"í…ìŠ¤íŠ¸"</span>, text: $writeText)

                    <span class="type">Button</span> {
                        writerManager.writeText(writeText)
                    } label: {
                        <span class="type">Label</span>(<span class="str">"í…ìŠ¤íŠ¸ ì“°ê¸°"</span>, systemImage: <span class="str">"text.cursor"</span>)
                    }
                    .disabled(!readerManager.isNFCAvailable)
                }

                <span class="comment">// ìƒíƒœ</span>
                <span class="type">Section</span> {
                    <span class="type">Text</span>(<span class="str">"NFC ì§€ì›: \(readerManager.isNFCAvailable ? "âœ…" : "âŒ")"</span>)
                        .foregroundStyle(.secondary)

                    <span class="kw">if</span> <span class="kw">let</span> error = readerManager.lastError {
                        <span class="type">Text</span>(<span class="str">"ì—ëŸ¬: \(error)"</span>)
                            .foregroundStyle(.red)
                            .font(.caption)
                    }
                }
            }
            .navigationTitle(<span class="str">"NFC ë¦¬ë”/ë¼ì´í„°"</span>)
        }
    }
}</pre>
</div>

<h2>ğŸ’¡ HIG ê°€ì´ë“œë¼ì¸</h2>

<ul>
<li><strong>ê¶Œí•œ ì„¤ì •:</strong> Info.plistì— NFCReaderUsageDescription ì¶”ê°€ í•„ìˆ˜</li>
<li><strong>Entitlements:</strong> Near Field Communication Tag Reading ê¶Œí•œ í™œì„±í™”</li>
<li><strong>ì‚¬ìš©ì ì•ˆë‚´:</strong> alertMessageë¡œ ëª…í™•í•œ ì§€ì‹œì‚¬í•­ ì œê³µ</li>
<li><strong>íƒ€ì„ì•„ì›ƒ:</strong> 60ì´ˆ ìŠ¤ìº” ì œí•œ ì‹œê°„ ê³ ë ¤</li>
<li><strong>ë°±ê·¸ë¼ìš´ë“œ ì½ê¸°:</strong> ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì— ìˆì–´ë„ íŠ¹ì • NDEF íƒœê·¸ ì½ê¸° ê°€ëŠ¥</li>
</ul>

<h2>ğŸ¯ ì‹¤ì „ í™œìš©</h2>

<ul>
<li><strong>ìŠ¤ë§ˆíŠ¸ í¬ìŠ¤í„°:</strong> URL, ì—°ë½ì²˜ ì •ë³´ê°€ ë‹´ê¸´ í¬ìŠ¤í„°</li>
<li><strong>ì œí’ˆ ì¸ì¦:</strong> NFC íƒœê·¸ë¡œ ì •í’ˆ ì¸ì¦</li>
<li><strong>ì¶œì… ê´€ë¦¬:</strong> NFC íƒœê·¸ ê¸°ë°˜ ì¶œì…ì¦</li>
<li><strong>ìì‚° ì¶”ì :</strong> ì¥ë¹„/ì¬ê³  ê´€ë¦¬</li>
<li><strong>ë°•ë¬¼ê´€ ê°€ì´ë“œ:</strong> ì „ì‹œë¬¼ ì •ë³´ ì œê³µ</li>
</ul>

<h2>ğŸ“š ë” ì•Œì•„ë³´ê¸°</h2>

<ul>
<li><a href="https://developer.apple.com/documentation/corenfc">Core NFC ê³µì‹ ë¬¸ì„œ</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2019/715/">WWDC: Core NFC ì„¸ì…˜</a></li>
<li><a href="https://developer.apple.com/design/human-interface-guidelines/nfc">HIG: NFC</a></li>
</ul>

<div class="info-box">
<strong>âš¡ï¸ ì„±ëŠ¥ íŒ:</strong> NFC ìŠ¤ìº”ì€ 60ì´ˆ í›„ ìë™ ì¢…ë£Œë©ë‹ˆë‹¤. <code>invalidateAfterFirstRead</code>ë¥¼ falseë¡œ ì„¤ì •í•˜ë©´ ì—¬ëŸ¬ íƒœê·¸ë¥¼ ì—°ì†ìœ¼ë¡œ ì½ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì“°ê¸° ì‘ì—… ì „ì—ëŠ” ë°˜ë“œì‹œ íƒœê·¸ì˜ ìš©ëŸ‰ê³¼ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.
</div>

<div style="margin-top:48px;padding:24px;background:linear-gradient(135deg,#f5f5f7,#e8e8ed);border-radius:16px;">
  <h2 style="font-size:20px;margin-bottom:12px;">ğŸ“ Apple ê³µì‹ ìë£Œ</h2>
  <div style="display:flex;flex-wrap:wrap;gap:12px;">
    <a href="https://developer.apple.com/documentation/corenfc" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ“˜ ê³µì‹ ë¬¸ì„œ</a>
    <a href="https://developer.apple.com/documentation/corenfc/building-an-nfc-tag-reader-app" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ’» ìƒ˜í”Œ ì½”ë“œ</a>
    <a href="https://developer.apple.com/videos/all-videos/?q=Core+NFC" target="_blank" style="display:inline-flex;align-items:center;gap:6px;padding:10px 16px;background:white;border-radius:10px;text-decoration:none;color:var(--accent);font-weight:600;font-size:14px;border:1px solid var(--border);transition:all .2s;">ğŸ¬ WWDC ì„¸ì…˜</a>
  </div>
</div>
</article>
</body></html>
