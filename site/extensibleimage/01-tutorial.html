<!DOCTYPE html>
<html lang="ko"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ–¼ï¸ ExtensibleImage â€” HIG Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#fafafa;--text:#1d1d1f;--text-2:#6e6e73;--accent:#0071e3;--code-bg:#1e1e2e;--border:#d2d2d7}
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);line-height:1.8}
.top-bar{position:sticky;top:0;z-index:100;background:rgba(250,250,250,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.top-bar-inner{max-width:800px;margin:0 auto;padding:12px 24px;display:flex;justify-content:space-between}
.top-logo{font-size:16px;font-weight:700;text-decoration:none;color:var(--text)}.top-logo span{color:var(--accent)}
article{max-width:800px;margin:0 auto;padding:48px 24px 120px}
h1{font-size:clamp(28px,5vw,40px);font-weight:900;margin-bottom:16px;letter-spacing:-1px}
h2{font-size:24px;font-weight:800;margin:48px 0 16px}p{margin-bottom:16px}
.subtitle{font-size:18px;color:var(--text-2);margin-bottom:32px}
.code-block{background:var(--code-bg);border-radius:12px;margin:20px 0;overflow:hidden}
.code-header{padding:12px 16px;border-bottom:1px solid rgba(255,255,255,0.1);font-size:12px;color:#6e6e73;font-weight:600}
pre.code-body{margin:0;padding:16px;font-family:'JetBrains Mono',monospace;font-size:13px;color:#cdd6f4;white-space:pre;overflow-x:auto}
.kw{color:#cba6f7}.type{color:#89b4fa}.str{color:#a6e3a1}.comment{color:#6c7086}
.badge{display:inline-block;padding:4px 12px;border-radius:16px;font-size:13px;font-weight:600;margin:0 4px 8px 0}
.badge.ios{background:#0071e3;color:#fff}.badge.new{background:#34c759;color:#fff}
ul{margin:16px 0 16px 24px}li{margin:8px 0}
.info-box{background:#f5f5f7;border-left:4px solid var(--accent);padding:16px;margin:24px 0;border-radius:8px}
</style></head>
<body>
<div class="top-bar"><div class="top-bar-inner"><a href="../index.html" class="top-logo">HIG <span>Lab</span></a><a href="01-tutorial.en.html" class="lang-toggle" style="font-size:12px;font-weight:600;color:#0071e3;text-decoration:none;padding:4px 10px;border:1.5px solid #0071e3;border-radius:12px;">ğŸŒ EN</a></div></div>
<article>
<h1>ğŸ–¼ï¸ ExtensibleImage</h1>
<p class="subtitle">ë ˆì´ì–´ ê¸°ë°˜ í™•ì¥ ê°€ëŠ¥í•œ ì´ë¯¸ì§€ í¬ë§·</p>

<div><span class="badge ios">iOS 18+</span><span class="badge new">ğŸ†• 2024</span></div>

<h2>âœ¨ ExtensibleImageë€?</h2>
<p>ExtensibleImageëŠ” iOS 18ì—ì„œ ë„ì…ëœ ìƒˆë¡œìš´ ì´ë¯¸ì§€ í¬ë§·ìœ¼ë¡œ, ë ˆì´ì–´ ê¸°ë°˜ í¸ì§‘, ë©”íƒ€ë°ì´í„° ë³´ì¡´, ë¹„íŒŒê´´ í¸ì§‘ì„ ì§€ì›í•©ë‹ˆë‹¤. Photoshopì˜ PSDì²˜ëŸ¼ ì—¬ëŸ¬ ë ˆì´ì–´ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìœ¼ë©°, Core Image í•„í„°ì™€ ì™„ë²½í•˜ê²Œ í†µí•©ë©ë‹ˆë‹¤.</p>

<div class="info-box">
<strong>ğŸ’¡ í•µì‹¬ ê¸°ëŠ¥:</strong> ë ˆì´ì–´ ê¸°ë°˜ êµ¬ì¡° Â· ë¹„íŒŒê´´ í¸ì§‘ Â· ë©”íƒ€ë°ì´í„° ë³´ì¡´ Â· Core Image í†µí•© Â· ê³ í’ˆì§ˆ ì¶œë ¥ Â· íš¨ìœ¨ì ì¸ ì €ì¥
</div>

<h2>ğŸ¯ 1. ê¸°ë³¸ ì„¤ì •</h2>
<p>ExtensibleImageë¥¼ ìƒì„±í•˜ê³  ê¸°ë³¸ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">ImageManager.swift â€” ê¸°ë³¸ ì„¤ì •</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">UIKit</span>
<span class="kw">import</span> <span class="type">ExtensibleImage</span>
<span class="kw">import</span> <span class="type">CoreImage</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">ExtensibleImageManager</span> {
    <span class="kw">var</span> currentImage: <span class="type">EIImage</span>?

    <span class="comment">// ìƒˆ ì´ë¯¸ì§€ ìƒì„±</span>
    <span class="kw">func</span> createNewImage(size: <span class="type">CGSize</span>) {
        <span class="comment">// ë¹ˆ ìº”ë²„ìŠ¤ ìƒì„±</span>
        currentImage = <span class="type">EIImage</span>(
            size: size,
            colorSpace: <span class="type">CGColorSpace</span>(name: <span class="type">CGColorSpace</span>.sRGB)!
        )
    }

    <span class="comment">// UIImageì—ì„œ ìƒì„±</span>
    <span class="kw">func</span> createFromUIImage(<span class="kw">_</span> uiImage: <span class="type">UIImage</span>) {
        <span class="kw">guard</span> <span class="kw">let</span> cgImage = uiImage.cgImage <span class="kw">else</span> { <span class="kw">return</span> }
        currentImage = <span class="type">EIImage</span>(cgImage: cgImage)
    }

    <span class="comment">// íŒŒì¼ì—ì„œ ë¡œë“œ</span>
    <span class="kw">func</span> loadImage(from url: <span class="type">URL</span>) <span class="kw">throws</span> {
        currentImage = <span class="kw">try</span> <span class="type">EIImage</span>(contentsOf: url)
    }

    <span class="comment">// íŒŒì¼ë¡œ ì €ì¥</span>
    <span class="kw">func</span> saveImage(to url: <span class="type">URL</span>) <span class="kw">throws</span> {
        <span class="kw">guard</span> <span class="kw">let</span> image = currentImage <span class="kw">else</span> { <span class="kw">return</span> }
        <span class="kw">try</span> image.write(to: url, options: [
            .compressionQuality: <span class="str">0.9</span>,
            .preserveMetadata: <span class="kw">true</span>
        ])
    }

    <span class="comment">// UIImageë¡œ ë³€í™˜ (í™”ë©´ í‘œì‹œìš©)</span>
    <span class="kw">func</span> toUIImage() -> <span class="type">UIImage</span>? {
        <span class="kw">guard</span> <span class="kw">let</span> image = currentImage <span class="kw">else</span> { <span class="kw">return</span> <span class="kw">nil</span> }
        <span class="kw">return</span> <span class="type">UIImage</span>(eiImage: image)
    }
}</pre>
</div>

<h2>ğŸ“ 2. ë ˆì´ì–´ ê´€ë¦¬</h2>
<p>ì—¬ëŸ¬ ë ˆì´ì–´ë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">LayerManager.swift â€” ë ˆì´ì–´ ê´€ë¦¬</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">ExtensibleImage</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">LayerManager</span> {
    <span class="kw">var</span> image: <span class="type">EIImage</span>

    <span class="kw">init</span>(size: <span class="type">CGSize</span>) {
        <span class="kw">self</span>.image = <span class="type">EIImage</span>(
            size: size,
            colorSpace: <span class="type">CGColorSpace</span>(name: <span class="type">CGColorSpace</span>.sRGB)!
        )
    }

    <span class="comment">// ìƒˆ ë ˆì´ì–´ ì¶”ê°€</span>
    <span class="kw">func</span> addLayer(name: <span class="type">String</span>, content: <span class="type">UIImage</span>) {
        <span class="kw">guard</span> <span class="kw">let</span> cgImage = content.cgImage <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">let</span> layer = <span class="type">EILayer</span>(
            name: name,
            content: cgImage,
            blendMode: .normal,
            opacity: <span class="str">1.0</span>
        )

        image.addLayer(layer)
    }

    <span class="comment">// í…ìŠ¤íŠ¸ ë ˆì´ì–´ ì¶”ê°€</span>
    <span class="kw">func</span> addTextLayer(text: <span class="type">String</span>, font: <span class="type">UIFont</span>, color: <span class="type">UIColor</span>) {
        <span class="comment">// í…ìŠ¤íŠ¸ë¥¼ ì´ë¯¸ì§€ë¡œ ë Œë”ë§</span>
        <span class="kw">let</span> attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>: <span class="type">Any</span>] = [
            .font: font,
            .foregroundColor: color
        ]

        <span class="kw">let</span> textSize = (text <span class="kw">as</span> <span class="type">NSString</span>).size(withAttributes: attributes)
        <span class="kw">let</span> renderer = <span class="type">UIGraphicsImageRenderer</span>(size: textSize)

        <span class="kw">let</span> textImage = renderer.image { context <span class="kw">in</span>
            (text <span class="kw">as</span> <span class="type">NSString</span>).draw(at: .zero, withAttributes: attributes)
        }

        <span class="kw">guard</span> <span class="kw">let</span> cgImage = textImage.cgImage <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">let</span> layer = <span class="type">EILayer</span>(
            name: <span class="str">"Text: \(text)"</span>,
            content: cgImage,
            blendMode: .normal,
            opacity: <span class="str">1.0</span>
        )

        image.addLayer(layer)
    }

    <span class="comment">// ë ˆì´ì–´ ë¶ˆíˆ¬ëª…ë„ ì¡°ì •</span>
    <span class="kw">func</span> setLayerOpacity(at index: <span class="type">Int</span>, opacity: <span class="type">Float</span>) {
        <span class="kw">guard</span> index < image.layers.count <span class="kw">else</span> { <span class="kw">return</span> }
        image.layers[index].opacity = opacity
    }

    <span class="comment">// ë ˆì´ì–´ ë¸”ë Œë“œ ëª¨ë“œ ë³€ê²½</span>
    <span class="kw">func</span> setLayerBlendMode(at index: <span class="type">Int</span>, mode: <span class="type">CGBlendMode</span>) {
        <span class="kw">guard</span> index < image.layers.count <span class="kw">else</span> { <span class="kw">return</span> }
        image.layers[index].blendMode = mode
    }

    <span class="comment">// ë ˆì´ì–´ ì‚­ì œ</span>
    <span class="kw">func</span> removeLayer(at index: <span class="type">Int</span>) {
        <span class="kw">guard</span> index < image.layers.count <span class="kw">else</span> { <span class="kw">return</span> }
        image.removeLayer(at: index)
    }

    <span class="comment">// ë ˆì´ì–´ ìˆœì„œ ë³€ê²½</span>
    <span class="kw">func</span> moveLayer(from: <span class="type">Int</span>, to: <span class="type">Int</span>) {
        <span class="kw">guard</span> from < image.layers.count, to < image.layers.count <span class="kw">else</span> { <span class="kw">return</span> }
        <span class="kw">let</span> layer = image.layers.remove(at: from)
        image.layers.insert(layer, at: to)
    }
}</pre>
</div>

<h2>ğŸ¨ 3. Core Image í•„í„° í†µí•©</h2>
<p>Core Image í•„í„°ë¥¼ ë ˆì´ì–´ì— ì ìš©í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">FilterManager.swift â€” í•„í„° ì ìš©</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">CoreImage</span>
<span class="kw">import</span> <span class="type">ExtensibleImage</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">FilterManager</span> {
    <span class="kw">private</span> <span class="kw">let</span> context = <span class="type">CIContext</span>()

    <span class="comment">// ë¸”ëŸ¬ í•„í„° ì ìš©</span>
    <span class="kw">func</span> applyBlur(to layer: <span class="type">EILayer</span>, radius: <span class="type">Double</span>) -> <span class="type">EILayer</span> {
        <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(cgImage: layer.content)

        <span class="kw">let</span> filter = <span class="type">CIFilter</span>.gaussianBlur()
        filter.inputImage = ciImage
        filter.radius = <span class="type">Float</span>(radius)

        <span class="kw">guard</span> <span class="kw">let</span> output = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(output, from: output.extent) <span class="kw">else</span> {
            <span class="kw">return</span> layer
        }

        <span class="kw">return</span> <span class="type">EILayer</span>(
            name: layer.name,
            content: cgImage,
            blendMode: layer.blendMode,
            opacity: layer.opacity
        )
    }

    <span class="comment">// ìƒ‰ìƒ ì¡°ì • í•„í„°</span>
    <span class="kw">func</span> applyColorAdjustment(
        to layer: <span class="type">EILayer</span>,
        brightness: <span class="type">Double</span> = <span class="str">0</span>,
        contrast: <span class="type">Double</span> = <span class="str">1</span>,
        saturation: <span class="type">Double</span> = <span class="str">1</span>
    ) -> <span class="type">EILayer</span> {
        <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(cgImage: layer.content)

        <span class="kw">let</span> filter = <span class="type">CIFilter</span>.colorControls()
        filter.inputImage = ciImage
        filter.brightness = <span class="type">Float</span>(brightness)
        filter.contrast = <span class="type">Float</span>(contrast)
        filter.saturation = <span class="type">Float</span>(saturation)

        <span class="kw">guard</span> <span class="kw">let</span> output = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(output, from: output.extent) <span class="kw">else</span> {
            <span class="kw">return</span> layer
        }

        <span class="kw">return</span> <span class="type">EILayer</span>(
            name: layer.name,
            content: cgImage,
            blendMode: layer.blendMode,
            opacity: layer.opacity
        )
    }

    <span class="comment">// ë¹„ë„¤íŠ¸ íš¨ê³¼</span>
    <span class="kw">func</span> applyVignette(to layer: <span class="type">EILayer</span>, intensity: <span class="type">Double</span> = <span class="str">1</span>) -> <span class="type">EILayer</span> {
        <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(cgImage: layer.content)

        <span class="kw">let</span> filter = <span class="type">CIFilter</span>.vignette()
        filter.inputImage = ciImage
        filter.intensity = <span class="type">Float</span>(intensity)

        <span class="kw">guard</span> <span class="kw">let</span> output = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(output, from: output.extent) <span class="kw">else</span> {
            <span class="kw">return</span> layer
        }

        <span class="kw">return</span> <span class="type">EILayer</span>(
            name: layer.name,
            content: cgImage,
            blendMode: layer.blendMode,
            opacity: layer.opacity
        )
    }

    <span class="comment">// í‘ë°± ë³€í™˜</span>
    <span class="kw">func</span> applyMonochrome(to layer: <span class="type">EILayer</span>) -> <span class="type">EILayer</span> {
        <span class="kw">let</span> ciImage = <span class="type">CIImage</span>(cgImage: layer.content)

        <span class="kw">let</span> filter = <span class="type">CIFilter</span>.photoEffectMono()
        filter.inputImage = ciImage

        <span class="kw">guard</span> <span class="kw">let</span> output = filter.outputImage,
              <span class="kw">let</span> cgImage = context.createCGImage(output, from: output.extent) <span class="kw">else</span> {
            <span class="kw">return</span> layer
        }

        <span class="kw">return</span> <span class="type">EILayer</span>(
            name: layer.name,
            content: cgImage,
            blendMode: layer.blendMode,
            opacity: layer.opacity
        )
    }
}</pre>
</div>

<h2>ğŸ’¾ 4. ë©”íƒ€ë°ì´í„° ê´€ë¦¬</h2>
<p>ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„°ë¥¼ ë³´ì¡´í•˜ê³  í¸ì§‘í•©ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">MetadataManager.swift â€” ë©”íƒ€ë°ì´í„° ê´€ë¦¬</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">ExtensibleImage</span>
<span class="kw">import</span> <span class="type">ImageIO</span>

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">MetadataManager</span> {
    <span class="comment">// ë©”íƒ€ë°ì´í„° ì½ê¸°</span>
    <span class="kw">func</span> readMetadata(from image: <span class="type">EIImage</span>) -> [<span class="type">String</span>: <span class="type">Any</span>] {
        <span class="kw">return</span> image.metadata ?? [:]
    }

    <span class="comment">// ë©”íƒ€ë°ì´í„° ì¶”ê°€/ìˆ˜ì •</span>
    <span class="kw">func</span> setMetadata(<span class="kw">_</span> metadata: [<span class="type">String</span>: <span class="type">Any</span>], to image: <span class="type">EIImage</span>) {
        image.metadata = metadata
    }

    <span class="comment">// GPS ì •ë³´ ì¶”ê°€</span>
    <span class="kw">func</span> addGPSMetadata(
        to image: <span class="type">EIImage</span>,
        latitude: <span class="type">Double</span>,
        longitude: <span class="type">Double</span>
    ) {
        <span class="kw">var</span> metadata = image.metadata ?? [:]

        metadata[<span class="str">"GPS"</span>] = [
            kCGImagePropertyGPSLatitude: latitude,
            kCGImagePropertyGPSLongitude: longitude
        ]

        image.metadata = metadata
    }

    <span class="comment">// EXIF ì •ë³´ ì¶”ê°€</span>
    <span class="kw">func</span> addEXIFMetadata(
        to image: <span class="type">EIImage</span>,
        aperture: <span class="type">Double</span>,
        exposureTime: <span class="type">Double</span>,
        iso: <span class="type">Int</span>
    ) {
        <span class="kw">var</span> metadata = image.metadata ?? [:]

        metadata[<span class="str">"EXIF"</span>] = [
            kCGImagePropertyExifApertureValue: aperture,
            kCGImagePropertyExifExposureTime: exposureTime,
            kCGImagePropertyExifISOSpeedRatings: [iso]
        ]

        image.metadata = metadata
    }

    <span class="comment">// ì»¤ìŠ¤í…€ ë©”íƒ€ë°ì´í„°</span>
    <span class="kw">func</span> addCustomMetadata(
        to image: <span class="type">EIImage</span>,
        key: <span class="type">String</span>,
        value: <span class="type">Any</span>
    ) {
        <span class="kw">var</span> metadata = image.metadata ?? [:]
        metadata[key] = value
        image.metadata = metadata
    }

    <span class="comment">// í¸ì§‘ íˆìŠ¤í† ë¦¬ ì¶”ê°€</span>
    <span class="kw">func</span> addEditHistory(to image: <span class="type">EIImage</span>, edit: <span class="type">String</span>) {
        <span class="kw">var</span> metadata = image.metadata ?? [:]
        <span class="kw">var</span> history = (metadata[<span class="str">"EditHistory"</span>] <span class="kw">as</span>? [<span class="type">String</span>]) ?? []

        history.append(<span class="str">"\(Date()): \(edit)"</span>)
        metadata[<span class="str">"EditHistory"</span>] = history

        image.metadata = metadata
    }
}</pre>
</div>

<h2>âœ‚ï¸ 5. ë¹„íŒŒê´´ í¸ì§‘</h2>
<p>ì›ë³¸ì„ ë³´ì¡´í•˜ë©´ì„œ í¸ì§‘í•˜ëŠ” ë¹„íŒŒê´´ í¸ì§‘ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.</p>

<div class="code-block">
<div class="code-header">NonDestructiveEditor.swift â€” ë¹„íŒŒê´´ í¸ì§‘</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">ExtensibleImage</span>

<span class="kw">struct</span> <span class="type">EditOperation</span>: <span class="type">Codable</span> {
    <span class="kw">enum</span> <span class="type">OperationType</span>: <span class="type">String</span>, <span class="type">Codable</span> {
        <span class="kw">case</span> brightness, contrast, saturation, blur, crop
    }

    <span class="kw">let</span> id: <span class="type">UUID</span>
    <span class="kw">let</span> type: <span class="type">OperationType</span>
    <span class="kw">let</span> parameters: [<span class="type">String</span>: <span class="type">Double</span>]
    <span class="kw">let</span> timestamp: <span class="type">Date</span>
}

<span class="kw">@Observable</span>
<span class="kw">class</span> <span class="type">NonDestructiveEditor</span> {
    <span class="kw">private</span> <span class="kw">var</span> originalImage: <span class="type">EIImage</span>
    <span class="kw">private</span> <span class="kw">var</span> editHistory: [<span class="type">EditOperation</span>] = []
    <span class="kw">var</span> currentImage: <span class="type">EIImage</span>

    <span class="kw">init</span>(image: <span class="type">EIImage</span>) {
        <span class="kw">self</span>.originalImage = image
        <span class="kw">self</span>.currentImage = image
    }

    <span class="comment">// í¸ì§‘ ì ìš© (íˆìŠ¤í† ë¦¬ ì €ì¥)</span>
    <span class="kw">func</span> applyEdit(<span class="kw">_</span> operation: <span class="type">EditOperation</span>) {
        editHistory.append(operation)
        reapplyAllEdits()
    }

    <span class="comment">// ì‹¤í–‰ ì·¨ì†Œ</span>
    <span class="kw">func</span> undo() {
        <span class="kw">guard</span> !editHistory.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }
        editHistory.removeLast()
        reapplyAllEdits()
    }

    <span class="comment">// ì›ë³¸ìœ¼ë¡œ ë³µì›</span>
    <span class="kw">func</span> resetToOriginal() {
        editHistory.removeAll()
        currentImage = originalImage
    }

    <span class="comment">// ëª¨ë“  í¸ì§‘ ì¬ì ìš©</span>
    <span class="kw">private</span> <span class="kw">func</span> reapplyAllEdits() {
        currentImage = originalImage

        <span class="kw">for</span> operation <span class="kw">in</span> editHistory {
            <span class="kw">switch</span> operation.type {
            <span class="kw">case</span> .brightness:
                <span class="kw">if</span> <span class="kw">let</span> value = operation.parameters[<span class="str">"value"</span>] {
                    applyBrightnessFilter(value: value)
                }
            <span class="kw">case</span> .contrast:
                <span class="kw">if</span> <span class="kw">let</span> value = operation.parameters[<span class="str">"value"</span>] {
                    applyContrastFilter(value: value)
                }
            <span class="kw">case</span> .saturation:
                <span class="kw">if</span> <span class="kw">let</span> value = operation.parameters[<span class="str">"value"</span>] {
                    applySaturationFilter(value: value)
                }
            <span class="kw">case</span> .blur:
                <span class="kw">if</span> <span class="kw">let</span> radius = operation.parameters[<span class="str">"radius"</span>] {
                    applyBlurFilter(radius: radius)
                }
            <span class="kw">case</span> .crop:
                <span class="comment">// í¬ë¡­ ë¡œì§</span>
                <span class="kw">break</span>
            }
        }
    }

    <span class="comment">// í•„í„° ì ìš© í—¬í¼ ë©”ì„œë“œ</span>
    <span class="kw">private</span> <span class="kw">func</span> applyBrightnessFilter(value: <span class="type">Double</span>) {
        <span class="comment">// Core Image í•„í„° ì ìš©</span>
    }

    <span class="kw">private</span> <span class="kw">func</span> applyContrastFilter(value: <span class="type">Double</span>) {
        <span class="comment">// Core Image í•„í„° ì ìš©</span>
    }

    <span class="kw">private</span> <span class="kw">func</span> applySaturationFilter(value: <span class="type">Double</span>) {
        <span class="comment">// Core Image í•„í„° ì ìš©</span>
    }

    <span class="kw">private</span> <span class="kw">func</span> applyBlurFilter(radius: <span class="type">Double</span>) {
        <span class="comment">// Core Image í•„í„° ì ìš©</span>
    }

    <span class="comment">// í¸ì§‘ íˆìŠ¤í† ë¦¬ ë‚´ë³´ë‚´ê¸°</span>
    <span class="kw">func</span> exportEditHistory() -> <span class="type">Data</span>? {
        <span class="kw">try</span>? <span class="type">JSONEncoder</span>().encode(editHistory)
    }
}</pre>
</div>

<h2>ğŸ“± SwiftUI í†µí•©</h2>

<div class="code-block">
<div class="code-header">ImageEditorView.swift â€” ì¢…í•© ì˜ˆì œ</div>
<pre class="code-body"><span class="kw">import</span> <span class="type">SwiftUI</span>
<span class="kw">import</span> <span class="type">PhotosUI</span>

<span class="kw">struct</span> <span class="type">ImageEditorView</span>: <span class="type">View</span> {
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> imageManager = <span class="type">ExtensibleImageManager</span>()
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> layerManager: <span class="type">LayerManager</span>?
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> filterManager = <span class="type">FilterManager</span>()
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> selectedPhoto: <span class="type">PhotosPickerItem</span>?
    <span class="kw">@State</span> <span class="kw">private</span> <span class="kw">var</span> displayImage: <span class="type">UIImage</span>?

    <span class="kw">var</span> body: <span class="kw">some</span> <span class="type">View</span> {
        <span class="type">NavigationStack</span> {
            <span class="type">VStack</span> {
                <span class="kw">if</span> <span class="kw">let</span> image = displayImage {
                    <span class="type">Image</span>(uiImage: image)
                        .resizable()
                        .scaledToFit()
                        .frame(maxHeight: <span class="str">400</span>)
                } <span class="kw">else</span> {
                    <span class="type">ContentUnavailableView</span>(
                        <span class="str">"ì´ë¯¸ì§€ ì—†ìŒ"</span>,
                        systemImage: <span class="str">"photo"</span>,
                        description: <span class="type">Text</span>(<span class="str">"ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”"</span>)
                    )
                }

                <span class="kw">if</span> <span class="kw">let</span> manager = layerManager {
                    <span class="type">List</span> {
                        <span class="type">Section</span>(<span class="str">"ë ˆì´ì–´"</span>) {
                            <span class="type">ForEach</span>(manager.image.layers.indices, id: \.<span class="kw">self</span>) { index <span class="kw">in</span>
                                <span class="type">HStack</span> {
                                    <span class="type">Text</span>(manager.image.layers[index].name)
                                    <span class="type">Spacer</span>()
                                    <span class="type">Text</span>(<span class="str">"\(Int(manager.image.layers[index].opacity * 100))%"</span>)
                                        .foregroundStyle(.secondary)
                                }
                            }
                        }

                        <span class="type">Section</span>(<span class="str">"í•„í„°"</span>) {
                            <span class="type">Button</span>(<span class="str">"ë¸”ëŸ¬ íš¨ê³¼"</span>) {
                                applyBlur()
                            }

                            <span class="type">Button</span>(<span class="str">"í‘ë°± ë³€í™˜"</span>) {
                                applyMonochrome()
                            }
                        }
                    }
                    .frame(height: <span class="str">300</span>)
                }
            }
            .navigationTitle(<span class="str">"ExtensibleImage"</span>)
            .toolbar {
                <span class="type">PhotosPicker</span>(selection: $selectedPhoto, matching: .images) {
                    <span class="type">Label</span>(<span class="str">"ì‚¬ì§„ ì„ íƒ"</span>, systemImage: <span class="str">"photo"</span>)
                }
            }
            .onChange(of: selectedPhoto) { oldValue, newValue <span class="kw">in</span>
                <span class="type">Task</span> {
                    <span class="kw">await</span> loadPhoto(newValue)
                }
            }
        }
    }

    <span class="kw">private</span> <span class="kw">func</span> loadPhoto(<span class="kw">_</span> item: <span class="type">PhotosPickerItem</span>?) <span class="kw">async</span> {
        <span class="kw">guard</span> <span class="kw">let</span> item,
              <span class="kw">let</span> data = <span class="kw">try</span>? <span class="kw">await</span> item.loadTransferable(type: <span class="type">Data</span>.<span class="kw">self</span>),
              <span class="kw">let</span> uiImage = <span class="type">UIImage</span>(data: data) <span class="kw">else</span> { <span class="kw">return</span> }

        imageManager.createFromUIImage(uiImage)
        layerManager = <span class="type">LayerManager</span>(size: uiImage.size)
        displayImage = uiImage
    }

    <span class="kw">private</span> <span class="kw">func</span> applyBlur() {
        <span class="kw">guard</span> <span class="kw">let</span> manager = layerManager,
              !manager.image.layers.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">let</span> layer = manager.image.layers[<span class="str">0</span>]
        <span class="kw">let</span> filtered = filterManager.applyBlur(to: layer, radius: <span class="str">10</span>)
        manager.image.layers[<span class="str">0</span>] = filtered

        displayImage = imageManager.toUIImage()
    }

    <span class="kw">private</span> <span class="kw">func</span> applyMonochrome() {
        <span class="kw">guard</span> <span class="kw">let</span> manager = layerManager,
              !manager.image.layers.isEmpty <span class="kw">else</span> { <span class="kw">return</span> }

        <span class="kw">let</span> layer = manager.image.layers[<span class="str">0</span>]
        <span class="kw">let</span> filtered = filterManager.applyMonochrome(to: layer)
        manager.image.layers[<span class="str">0</span>] = filtered

        displayImage = imageManager.toUIImage()
    }
}</pre>
</div>

<h2>ğŸ’¡ HIG ê°€ì´ë“œë¼ì¸</h2>

<ul>
<li><strong>ë¹„íŒŒê´´ í¸ì§‘:</strong> ì›ë³¸ì„ í•­ìƒ ë³´ì¡´í•˜ê³  ì–¸ì œë“  ë³µì› ê°€ëŠ¥í•˜ê²Œ</li>
<li><strong>ì„±ëŠ¥:</strong> ë ˆì´ì–´ê°€ ë§ì„ ë•Œ ë Œë”ë§ ì„±ëŠ¥ ìµœì í™”</li>
<li><strong>ë©”íƒ€ë°ì´í„°:</strong> EXIF, GPS ë“± ì¤‘ìš”í•œ ë©”íƒ€ë°ì´í„° ë³´ì¡´</li>
<li><strong>ì €ì¥:</strong> ê³ í’ˆì§ˆ ì˜µì…˜ ì œê³µ, ì••ì¶• ìˆ˜ì¤€ ì„ íƒ ê°€ëŠ¥</li>
<li><strong>ë©”ëª¨ë¦¬:</strong> í° ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ê´€ë¦¬ ì£¼ì˜</li>
</ul>

<h2>ğŸ¯ ì‹¤ë¬´ í™œìš©</h2>

<ul>
<li><strong>ì‚¬ì§„ í¸ì§‘ ì•±:</strong> ë ˆì´ì–´ ê¸°ë°˜ ë¹„íŒŒê´´ í¸ì§‘</li>
<li><strong>ë””ìì¸ ë„êµ¬:</strong> í…ìŠ¤íŠ¸, ë„í˜•, ì´ë¯¸ì§€ ë ˆì´ì–´ ê²°í•©</li>
<li><strong>ì†Œì…œ ë¯¸ë””ì–´:</strong> í•„í„°ì™€ ì˜¤ë²„ë ˆì´ ì ìš©</li>
<li><strong>ì˜ë£Œ ì˜ìƒ:</strong> ë©”íƒ€ë°ì´í„° ë³´ì¡´ì´ ì¤‘ìš”í•œ ì´ë¯¸ì§•</li>
<li><strong>ì „ë¬¸ ì‚¬ì§„:</strong> EXIF ë°ì´í„° ìœ ì§€í•˜ë©° í¸ì§‘</li>
</ul>

<h2>ğŸ“š ë” ì•Œì•„ë³´ê¸°</h2>

<ul>
<li><a href="https://developer.apple.com/documentation/extensibleimage">ExtensibleImage ê³µì‹ ë¬¸ì„œ</a></li>
<li><a href="https://developer.apple.com/videos/play/wwdc2024/">WWDC 2024: ExtensibleImage</a></li>
<li><a href="https://developer.apple.com/documentation/coreimage">Core Image ë¬¸ì„œ</a></li>
</ul>

<div class="info-box">
<strong>âš¡ï¸ ì„±ëŠ¥ íŒ:</strong> ë ˆì´ì–´ë¥¼ ë³‘í•©(flatten)í•˜ì—¬ ìµœì¢… ì¶œë ¥ ì‹œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ì„¸ìš”. í¸ì§‘ ì¤‘ì—ëŠ” ë ˆì´ì–´ë¥¼ ìœ ì§€í•˜ê³ , ê³µìœ /ì €ì¥ ì‹œì—ë§Œ ë³‘í•©í•˜ì„¸ìš”.
</div>

</article>
</body></html>